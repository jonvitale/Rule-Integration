
<!-- saved from url=(0044)http://galapagos.telscenter.org/save-to-html -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css"></style>
<style type='text/css'>
  body {
    font-family: Helvetica, Arial, sans-serif;
    padding-left: 20px;
  }
</style>
</head>
<body>
    <table>
    <tr>
    <td>
    <label>speed&nbsp;<input id="speed-slider" type="range" min="0" max="8" step=".01" style="width: 400px" onchange="tortoise_onclick('speed_slider',this);" value="4.5"></label>
    <label style="border-style:solid;border-color:#444;padding:5px;border-width:thin">
        years: <span id="tick-counter">0</span>
        </label>
    <br/><br/>
    <input id="setup-button" type="button" onclick="tortoise_onclick('doSetup',this);" value="Setup">
    <input id="go-button" type="button" onclick="tortoise_onclick('toggleGo',this);" value="Go">
    <input id="watch-ray-button" type="button" onclick="tortoise_onclick('watchRay',this);" value="Watch Sunray">
    <input id="watch-uv-button" type="button" onclick="tortoise_onclick('watchUv',this);" value="Watch UV Ray">
    <br/>
    <div id="input-slider-div">
    <span id="input-slider-label">.</span><input id="input-slider" type="range" min="0" max="100" step="1" style="width: 200px" onchange="tortoise_onclick('input_slider',this);" value="50">
    </div>
</td>
<td>
  <div id="messageBox" style="border-style:solid;padding:10px;">
    <p>
    </p>
  </div>
</td>
</tr>
<tr>
    <td>
    <div class="view-container" style="width: 600px;"><div class="view-layers" style="width: 100%; position: relative;"><canvas width="541" height="342" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 2;"></canvas><canvas width="1082" height="684" style="width: 100%; z-index: 0;"></canvas><canvas width="1623" height="1026" style="width: 100%; position: absolute; top: 0px; left: 0px; z-index: 1;"></canvas></div></div>
    </td>
  <td style="vertical-align: top;">
      <div class='graph' id='chart'></div><br/>
      <div class='graph' id='chart2'></div>
  </td>
  </tr>
</table>
<script>/*
 Highcharts JS v4.1.8 (2015-08-20)

 Standalone Highcharts Framework

 License: MIT License
*/
var HighchartsAdapter=function(){function p(c){function b(b,a,d){b.removeEventListener(a,d,!1)}function d(b,a,d){d=b.HCProxiedMethods[d.toString()];b.detachEvent("on"+a,d)}function a(a,c){var f=a.HCEvents,i,g,k,j;if(a.removeEventListener)i=b;else if(a.attachEvent)i=d;else return;c?(g={},g[c]=!0):g=f;for(j in g)if(f[j])for(k=f[j].length;k--;)i(a,j,f[j][k])}c.HCExtended||Highcharts.extend(c,{HCExtended:!0,HCEvents:{},bind:function(b,a){var d=this,c=this.HCEvents,g;if(d.addEventListener)d.addEventListener(b,
a,!1);else if(d.attachEvent){g=function(b){b.target=b.srcElement||window;a.call(d,b)};if(!d.HCProxiedMethods)d.HCProxiedMethods={};d.HCProxiedMethods[a.toString()]=g;d.attachEvent("on"+b,g)}c[b]===s&&(c[b]=[]);c[b].push(a)},unbind:function(c,h){var f,i;c?(f=this.HCEvents[c]||[],h?(i=HighchartsAdapter.inArray(h,f),i>-1&&(f.splice(i,1),this.HCEvents[c]=f),this.removeEventListener?b(this,c,h):this.attachEvent&&d(this,c,h)):(a(this,c),this.HCEvents[c]=[])):(a(this),this.HCEvents={})},trigger:function(b,
a){var d=this.HCEvents[b]||[],c=d.length,g,k,j;k=function(){a.defaultPrevented=!0};for(g=0;g<c;g++){j=d[g];if(a.stopped)break;a.preventDefault=k;a.target=this;if(!a.type)a.type=b;j.call(this,a)===!1&&a.preventDefault()}}});return c}var s,l=document,q=[],m=[],r,n={},o;Math.easeInOutSine=function(c,b,d,a){return-d/2*(Math.cos(Math.PI*c/a)-1)+b};return{init:function(c){if(!l.defaultView)this._getStyle=function(b,d){var a;return b.style[d]?b.style[d]:(d==="opacity"&&(d="filter"),a=b.currentStyle[d.replace(/\-(\w)/g,
function(b,a){return a.toUpperCase()})],d==="filter"&&(a=a.replace(/alpha\(opacity=([0-9]+)\)/,function(b,a){return a/100})),a===""?1:a)},this.adapterRun=function(b,d){var a={width:"clientWidth",height:"clientHeight"}[d];if(a)return b.style.zoom=1,b[a]-2*parseInt(HighchartsAdapter._getStyle(b,"padding"),10)};if(!Array.prototype.forEach)this.each=function(b,d){for(var a=0,c=b.length;a<c;a++)if(d.call(b[a],b[a],a,b)===!1)return a};if(!Array.prototype.indexOf)this.inArray=function(b,d){var a,c=0;if(d)for(a=
d.length;c<a;c++)if(d[c]===b)return c;return-1};if(!Array.prototype.filter)this.grep=function(b,d){for(var a=[],c=0,h=b.length;c<h;c++)d(b[c],c)&&a.push(b[c]);return a};o=function(b,c,a){this.options=c;this.elem=b;this.prop=a};o.prototype={update:function(){var b;b=this.paths;var d=this.elem,a=d.element;if(n[this.prop])n[this.prop](this);else b&&a?d.attr("d",c.step(b[0],b[1],this.now,this.toD)):d.attr?a&&d.attr(this.prop,this.now):(b={},b[this.prop]=this.now+this.unit,Highcharts.css(d,b));this.options.step&&
this.options.step.call(this.elem,this.now,this)},custom:function(b,c,a){var e=this,h=function(a){return e.step(a)},f;this.startTime=+new Date;this.start=b;this.end=c;this.unit=a;this.now=this.start;this.pos=this.state=0;h.elem=this.elem;h()&&m.push(h)===1&&(r=setInterval(function(){for(f=0;f<m.length;f++)m[f]()||m.splice(f--,1);m.length||clearInterval(r)},13))},step:function(b){var c=+new Date,a;a=this.options;var e=this.elem,h;if(e.stopAnimation||e.attr&&!e.element)a=!1;else if(b||c>=a.duration+
this.startTime){this.now=this.end;this.pos=this.state=1;this.update();b=this.options.curAnim[this.prop]=!0;for(h in a.curAnim)a.curAnim[h]!==!0&&(b=!1);b&&a.complete&&a.complete.call(e);a=!1}else e=c-this.startTime,this.state=e/a.duration,this.pos=a.easing(e,0,1,a.duration),this.now=this.start+(this.end-this.start)*this.pos,this.update(),a=!0;return a}};this.animate=function(b,d,a){var e,h="",f,i,g;b.stopAnimation=!1;if(typeof a!=="object"||a===null)e=arguments,a={duration:e[2],easing:e[3],complete:e[4]};
if(typeof a.duration!=="number")a.duration=400;a.easing=Math[a.easing]||Math.easeInOutSine;a.curAnim=Highcharts.extend({},d);for(g in d)i=new o(b,a,g),f=null,g==="d"?(i.paths=c.init(b,b.d,d.d),i.toD=d.d,e=0,f=1):b.attr?e=b.attr(g):(e=parseFloat(HighchartsAdapter._getStyle(b,g))||0,g!=="opacity"&&(h="px")),f||(f=d[g]),f.match&&f.match("px")&&(f=f.replace(/px/g,"")),i.custom(e,f,h)}},_getStyle:function(c,b){return window.getComputedStyle(c,void 0).getPropertyValue(b)},addAnimSetter:function(c,b){n[c]=
b},getScript:function(c,b){var d=l.getElementsByTagName("head")[0],a=l.createElement("script");a.type="text/javascript";a.src=c;a.onload=b;d.appendChild(a)},inArray:function(c,b){return b.indexOf?b.indexOf(c):q.indexOf.call(b,c)},adapterRun:function(c,b){return parseInt(HighchartsAdapter._getStyle(c,b),10)},grep:function(c,b){return q.filter.call(c,b)},map:function(c,b){for(var d=[],a=0,e=c.length;a<e;a++)d[a]=b.call(c[a],c[a],a,c);return d},offset:function(c){var b=document.documentElement,c=c.getBoundingClientRect();
return{top:c.top+(window.pageYOffset||b.scrollTop)-(b.clientTop||0),left:c.left+(window.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}},addEvent:function(c,b,d){p(c).bind(b,d)},removeEvent:function(c,b,d){p(c).unbind(b,d)},fireEvent:function(c,b,d,a){var e;l.createEvent&&(c.dispatchEvent||c.fireEvent)?(e=l.createEvent("Events"),e.initEvent(b,!0,!0),e.target=c,Highcharts.extend(e,d),c.dispatchEvent?c.dispatchEvent(e):c.fireEvent(b,e)):c.HCExtended===!0&&(d=d||{},c.trigger(b,d));d&&d.defaultPrevented&&
(a=null);a&&a(d)},washMouseEvent:function(c){return c},stop:function(c){c.stopAnimation=!0},each:function(c,b){return Array.prototype.forEach.call(c,b)}}}();
</script>
    <script>/*
 Highcharts JS v4.1.8 (2015-08-20)

 (c) 2009-2014 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(){function A(){var a,b=arguments,c,d={},e=function(a,b){var c,d;typeof a!=="object"&&(a={});for(d in b)b.hasOwnProperty(d)&&(c=b[d],a[d]=c&&typeof c==="object"&&Object.prototype.toString.call(c)!=="[object Array]"&&d!=="renderTo"&&typeof c.nodeType!=="number"?e(a[d]||{},c):b[d]);return a};b[0]===!0&&(d=b[1],b=Array.prototype.slice.call(b,2));c=b.length;for(a=0;a<c;a++)d=e(d,b[a]);return d}function F(a,b){return parseInt(a,b||10)}function Aa(a){return typeof a==="string"}function da(a){return a&&
typeof a==="object"}function Fa(a){return Object.prototype.toString.call(a)==="[object Array]"}function qa(a){return typeof a==="number"}function Ba(a){return W.log(a)/W.LN10}function ia(a){return W.pow(10,a)}function ja(a,b){for(var c=a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function s(a){return a!==v&&a!==null}function J(a,b,c){var d,e;if(Aa(b))s(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(s(b)&&da(b))for(d in b)a.setAttribute(d,b[d]);return e}function ra(a){return Fa(a)?
a:[a]}function L(a,b){if(xa&&!ca&&b&&b.opacity!==v)b.filter="alpha(opacity="+b.opacity*100+")";r(a.style,b)}function $(a,b,c,d,e){a=C.createElement(a);b&&r(a,b);e&&L(a,{padding:0,border:O,margin:0});c&&L(a,c);d&&d.appendChild(a);return a}function ka(a,b){var c=function(){return v};c.prototype=new a;r(c.prototype,b);return c}function Ga(a,b){return Array((b||2)+1-String(a).length).join(0)+a}function Va(a){return(bb&&bb(a)||mb||0)*6E4}function Ha(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==
-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=S.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e!==null&&(e=B.numberFormat(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:""))):e=Ma(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function nb(a){return W.pow(10,V(W.log(a)/W.LN10))}function ob(a,b,c,d,e){var f,g=a,c=p(c,1);f=a/c;b||(b=[1,2,2.5,5,10],d===!1&&(c===
1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(g=b[d],e&&g*c>=a||!e&&f<=(b[d]+(b[d+1]||b[d]))/2)break;g*=c;return g}function pb(a,b){var c=a.length,d,e;for(e=0;e<c;e++)a[e].ss_i=e;a.sort(function(a,c){d=b(a,c);return d===0?a.ss_i-c.ss_i:d});for(e=0;e<c;e++)delete a[e].ss_i}function Na(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function Ca(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Oa(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),
delete a[c]}function Pa(a){cb||(cb=$(Ia));a&&cb.appendChild(a);cb.innerHTML=""}function la(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw c;K.console&&console.log(c)}function ea(a,b){return parseFloat(a.toPrecision(b||14))}function Qa(a,b){b.renderer.globalAnimation=p(a,b.animation)}function Cb(){var a=S.global,b=a.useUTC,c=b?"getUTC":"get",d=b?"setUTC":"set";ya=a.Date||window.Date;mb=b&&a.timezoneOffset;bb=b&&a.getTimezoneOffset;db=function(a,c,d,h,i,j){var k;b?(k=
ya.UTC.apply(0,arguments),k+=Va(k)):k=(new ya(a,c,p(d,1),p(h,0),p(i,0),p(j,0))).getTime();return k};qb=c+"Minutes";rb=c+"Hours";sb=c+"Day";Wa=c+"Date";Xa=c+"Month";Ya=c+"FullYear";Db=d+"Milliseconds";Eb=d+"Seconds";Fb=d+"Minutes";Gb=d+"Hours";tb=d+"Date";ub=d+"Month";vb=d+"FullYear"}function P(){}function Ra(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Hb(a,b,c,d,e){var f=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=
null;this.points={};this.stack=e;this.alignOptions={align:b.align||(f?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(f?"middle":c?"bottom":"top"),y:p(b.y,f?4:c?14:-6),x:p(b.x,f?c?-6:6:0)};this.textAlign=b.textAlign||(f?c?"right":"left":"center")}var v,C=document,K=window,W=Math,w=W.round,V=W.floor,sa=W.ceil,t=W.max,z=W.min,N=W.abs,X=W.cos,aa=W.sin,ma=W.PI,ga=ma*2/360,za=navigator.userAgent,Ib=K.opera,xa=/(msie|trident)/i.test(za)&&!Ib,eb=C.documentMode===8,fb=/AppleWebKit/.test(za),Ja=
/Firefox/.test(za),Jb=/(Mobile|Android|Windows Phone)/.test(za),Da="http://www.w3.org/2000/svg",ca=!!C.createElementNS&&!!C.createElementNS(Da,"svg").createSVGRect,Nb=Ja&&parseInt(za.split("Firefox/")[1],10)<4,fa=!ca&&!xa&&!!C.createElement("canvas").getContext,Za,$a,Kb={},wb=0,cb,S,Ma,xb,E,ta=function(){return v},Y=[],ab=0,Ia="div",O="none",Ob=/^[0-9]+$/,gb=["plotTop","marginRight","marginBottom","plotLeft"],Pb="stroke-width",ya,db,mb,bb,qb,rb,sb,Wa,Xa,Ya,Db,Eb,Fb,Gb,tb,ub,vb,M={},B;B=K.Highcharts=
K.Highcharts?la(16,!0):{};B.seriesTypes=M;var r=B.extend=function(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a},p=B.pick=function(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],c!==v&&c!==null)return c},Sa=B.wrap=function(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}};Ma=function(a,b,c){if(!s(b)||isNaN(b))return S.lang.invalidDate||"";var a=p(a,"%Y-%m-%d %H:%M:%S"),d=new ya(b-Va(b)),e,f=d[rb](),g=d[sb](),h=d[Wa](),
i=d[Xa](),j=d[Ya](),k=S.lang,m=k.weekdays,d=r({a:m[g].substr(0,3),A:m[g],d:Ga(h),e:h,w:g,b:k.shortMonths[i],B:k.months[i],m:Ga(i+1),y:j.toString().substr(2,2),Y:j,H:Ga(f),k:f,I:Ga(f%12||12),l:f%12||12,M:Ga(d[qb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Ga(d.getSeconds()),L:Ga(w(b%1E3),3)},B.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};E={millisecond:1,second:1E3,minute:6E4,hour:36E5,day:864E5,
week:6048E5,month:24192E5,year:314496E5};B.numberFormat=function(a,b,c,d){var e=S.lang,a=+a||0,f=b===-1?z((a.toString().split(".")[1]||"").length,20):isNaN(b=N(b))?2:b,b=c===void 0?e.decimalPoint:c,d=d===void 0?e.thousandsSep:d,e=a<0?"-":"",c=String(F(a=N(a).toFixed(f))),g=c.length>3?c.length%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+N(a-c).toFixed(f).slice(2):"")};xb={init:function(a,b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),
c=[].concat(c),h,i,j=function(a){for(g=a.length;g--;)a[g]==="M"&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));a.isArea&&(h=b.splice(b.length-6,6),i=c.splice(c.length-6,6));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=[].concat(c).splice(0,f).concat(c);a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=[].concat(b).splice(b.length-f,f),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),b=b.concat(d);h&&(b=b.concat(h),c=c.concat(i));return[b,c]},step:function(a,b,c,d){var e=[],f=a.length;if(c===1)e=
d;else if(f===b.length&&c<1)for(;f--;)d=parseFloat(a[f]),e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d;else e=b;return e}};(function(a){K.HighchartsAdapter=K.HighchartsAdapter||a&&{init:function(b){var c=a.fx;a.extend(a.easing,{easeOutQuad:function(a,b,c,g,h){return-g*(b/=h)*(b-2)+c}});a.each(["cur","_default","width","height","opacity"],function(b,e){var f=c.step,g;e==="cur"?f=c.prototype:e==="_default"&&a.Tween&&(f=a.Tween.propHooks[e],e="set");(g=f[e])&&(f[e]=function(a){var c,a=b?a:this;if(a.prop!==
"align")return c=a.elem,c.attr?c.attr(a.prop,e==="cur"?v:a.now):g.apply(this,arguments)})});Sa(a.cssHooks.opacity,"get",function(a,b,c){return b.attr?b.opacity||0:a.call(this,b,c)});this.addAnimSetter("d",function(a){var c=a.elem,f;if(!a.started)f=b.init(c,c.d,c.toD),a.start=f[0],a.end=f[1],a.started=!0;c.attr("d",b.step(a.start,a.end,a.pos,c.toD))});this.each=Array.prototype.forEach?function(a,b){return Array.prototype.forEach.call(a,b)}:function(a,b){var c,g=a.length;for(c=0;c<g;c++)if(b.call(a[c],
a[c],c,a)===!1)return c};a.fn.highcharts=function(){var a="Chart",b=arguments,c,g;if(this[0]){Aa(b[0])&&(a=b[0],b=Array.prototype.slice.call(b,1));c=b[0];if(c!==v)c.chart=c.chart||{},c.chart.renderTo=this[0],new B[a](c,b[1]),g=this;c===v&&(g=Y[J(this[0],"data-highcharts-chart")])}return g}},addAnimSetter:function(b,c){a.Tween?a.Tween.propHooks[b]={set:c}:a.fx.step[b]=c},getScript:a.getScript,inArray:a.inArray,adapterRun:function(b,c){return a(b)[c]()},grep:a.grep,map:function(a,c){for(var d=[],e=
0,f=a.length;e<f;e++)d[e]=c.call(a[e],a[e],e,a);return d},offset:function(b){return a(b).offset()},addEvent:function(b,c,d){a(b).bind(c,d)},removeEvent:function(b,c,d){var e=C.removeEventListener?"removeEventListener":"detachEvent";C[e]&&b&&!b[e]&&(b[e]=function(){});a(b).unbind(c,d)},fireEvent:function(b,c,d,e){var f=a.Event(c),g="detached"+c,h;!xa&&d&&(delete d.layerX,delete d.layerY,delete d.returnValue);r(f,d);b[c]&&(b[g]=b[c],b[c]=null);a.each(["preventDefault","stopPropagation"],function(a,
b){var c=f[b];f[b]=function(){try{c.call(f)}catch(a){b==="preventDefault"&&(h=!0)}}});a(b).trigger(f);b[g]&&(b[c]=b[g],b[g]=null);e&&!f.isDefaultPrevented()&&!h&&e(f)},washMouseEvent:function(a){var c=a.originalEvent||a;if(c.pageX===v)c.pageX=a.pageX,c.pageY=a.pageY;return c},animate:function(b,c,d){var e=a(b);if(!b.style)b.style={};if(c.d)b.toD=c.d,c.d=1;e.stop();c.opacity!==v&&b.attr&&(c.opacity+="px");b.hasAnim=1;e.animate(c,d)},stop:function(b){b.hasAnim&&a(b).stop()}}})(K.jQuery);var U=K.HighchartsAdapter,
D=U||{};U&&U.init.call(U,xb);var hb=D.adapterRun,Qb=D.getScript,Ka=D.inArray,o=B.each=D.each,ib=D.grep,Rb=D.offset,Ta=D.map,H=D.addEvent,Z=D.removeEvent,I=D.fireEvent,Sb=D.washMouseEvent,jb=D.animate,kb=D.stop;S={colors:"#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#f45b5b,#91e8e1".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),
shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/4.1.8/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/4.1.8/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,
defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,
lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":B.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:0.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1E3}},
labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},
loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ca,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',
pointFormat:'<span style="color:{point.color}">\u25cf</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:Jb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var ba=S.plotOptions,U=ba.line;Cb();var Tb=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,
Ub=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,Vb=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,na=function(a){var b=[],c,d;(function(a){a&&a.stops?d=Ta(a.stops,function(a){return na(a[1])}):(c=Tb.exec(a))?b=[F(c[1]),F(c[2]),F(c[3]),parseFloat(c[4],10)]:(c=Ub.exec(a))?b=[F(c[1],16),F(c[2],16),F(c[3],16),1]:(c=Vb.exec(a))&&(b=[F(c[1]),F(c[2]),F(c[3]),1])})(a);return{get:function(c){var f;d?(f=A(a),f.stops=[].concat(f.stops),o(d,function(a,b){f.stops[b]=[f.stops[b][0],a.get(c)]})):
f=b&&!isNaN(b[0])?c==="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":c==="a"?b[3]:"rgba("+b.join(",")+")":a;return f},brighten:function(a){if(d)o(d,function(b){b.brighten(a)});else if(qa(a)&&a!==0){var c;for(c=0;c<3;c++)b[c]+=F(a*255),b[c]<0&&(b[c]=0),b[c]>255&&(b[c]=255)}return this},rgba:b,setOpacity:function(a){b[3]=a;return this},raw:a}};P.prototype={opacity:1,textProps:"fontSize,fontWeight,fontFamily,fontStyle,color,lineHeight,width,textDecoration,textOverflow,textShadow".split(","),init:function(a,
b){this.element=b==="span"?$(b):C.createElementNS(Da,b);this.renderer=a},animate:function(a,b,c){b=p(b,this.renderer.globalAnimation,!0);kb(this);if(b){b=A(b,{});if(c)b.complete=c;jb(this,a,b)}else this.attr(a,null,c);return this},colorGradient:function(a,b,c){var d=this.renderer,e,f,g,h,i,j,k,m,l,n,q=[];a.linearGradient?f="linearGradient":a.radialGradient&&(f="radialGradient");if(f){g=a[f];h=d.gradients;j=a.stops;l=c.radialReference;Fa(g)&&(a[f]=g={x1:g[0],y1:g[1],x2:g[2],y2:g[3],gradientUnits:"userSpaceOnUse"});
f==="radialGradient"&&l&&!s(g.gradientUnits)&&(g=A(g,{cx:l[0]-l[2]/2+g.cx*l[2],cy:l[1]-l[2]/2+g.cy*l[2],r:g.r*l[2],gradientUnits:"userSpaceOnUse"}));for(n in g)n!=="id"&&q.push(n,g[n]);for(n in j)q.push(j[n]);q=q.join(",");h[q]?a=h[q].attr("id"):(g.id=a="highcharts-"+wb++,h[q]=i=d.createElement(f).attr(g).add(d.defs),i.stops=[],o(j,function(a){a[1].indexOf("rgba")===0?(e=na(a[1]),k=e.get("rgb"),m=e.get("a")):(k=a[1],m=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":k,"stop-opacity":m}).add(i);
i.stops.push(a)}));c.setAttribute(b,"url("+d.url+"#"+a+")")}},applyTextShadow:function(a){var b=this.element,c,d=a.indexOf("contrast")!==-1,e={},f=this.renderer.forExport||b.style.textShadow!==v&&!xa;if(d)e.textShadow=a=a.replace(/contrast/g,this.renderer.getContrast(b.style.fill));if(fb)e.textRendering="geometricPrecision";f?L(b,e):(this.fakeTS=!0,this.ySetter=this.xSetter,c=[].slice.call(b.getElementsByTagName("tspan")),o(a.split(/\s?,\s?/g),function(a){var d=b.firstChild,e,f,a=a.split(" ");e=a[a.length-
1];(f=a[a.length-2])&&o(c,function(a,c){var g;c===0&&(a.setAttribute("x",b.getAttribute("x")),c=b.getAttribute("y"),a.setAttribute("y",c||0),c===null&&b.setAttribute("y",0));g=a.cloneNode(1);J(g,{"class":"highcharts-text-shadow",fill:e,stroke:e,"stroke-opacity":1/t(F(f),3),"stroke-width":f,"stroke-linejoin":"round"});b.insertBefore(g,d)})}))},attr:function(a,b,c){var d,e=this.element,f,g=this,h;typeof a==="string"&&b!==v&&(d=a,a={},a[d]=b);if(typeof a==="string")g=(this[a+"Getter"]||this._defaultGetter).call(this,
a,e);else{for(d in a){b=a[d];h=!1;this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(d)&&(f||(this.symbolAttr(a),f=!0),h=!0);if(this.rotation&&(d==="x"||d==="y"))this.doTransform=!0;h||(this[d+"Setter"]||this._defaultSetter).call(this,b,d,e);this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(d)&&this.updateShadows(d,b)}if(this.doTransform)this.updateTransform(),this.doTransform=!1}c&&c();return g},updateShadows:function(a,b){for(var c=this.shadows,
d=c.length;d--;)c[d].setAttribute(a,a==="height"?t(b-(c[d].cutHeight||0),0):a==="d"?this.d:b)},addClass:function(a){var b=this.element,c=J(b,"class")||"";c.indexOf(a)===-1&&J(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;o("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=p(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":O)},
crisp:function(a){var b,c={},d,e=a.strokeWidth||this.strokeWidth||0;d=w(e)%2/2;a.x=V(a.x||this.x||0)+d;a.y=V(a.y||this.y||0)+d;a.width=V((a.width||this.width||0)-2*d);a.height=V((a.height||this.height||0)-2*d);a.strokeWidth=e;for(b in a)this[b]!==a[b]&&(this[b]=c[b]=a[b]);return c},css:function(a){var b=this.styles,c={},d=this.element,e,f,g="";e=!b;if(a&&a.color)a.fill=a.color;if(b)for(f in a)a[f]!==b[f]&&(c[f]=a[f],e=!0);if(e){e=this.textWidth=a&&a.width&&d.nodeName.toLowerCase()==="text"&&F(a.width)||
this.textWidth;b&&(a=r(b,c));this.styles=a;e&&(fa||!ca&&this.renderer.forExport)&&delete a.width;if(xa&&!ca)L(this.element,a);else{b=function(a,b){return"-"+b.toLowerCase()};for(f in a)g+=f.replace(/([A-Z])/g,b)+":"+a[f]+";";J(d,"style",g)}e&&this.added&&this.renderer.buildText(this)}return this},on:function(a,b){var c=this,d=c.element;$a&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=ya.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(za.indexOf("Android")===-1||ya.now()-
(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){this.element.radialReference=a;return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,d=this.scaleY,e=this.inverted,f=this.rotation,g=this.element;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+
","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(g.getAttribute("x")||0)+" "+(g.getAttribute("y")||0)+")");(s(c)||s(d))&&a.push("scale("+p(c,1)+" "+p(d,1)+")");a.length&&g.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||Aa(c))this.alignTo=d=c||"renderer",ja(f,this),f.push(this),
c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=p(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=w(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=w(g);this[this.placed?"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(a){var b,c=this.renderer,d,e=this.rotation,
f=this.element,g=this.styles,h=e*ga;d=this.textStr;var i,j=f.style,k,m;d!==v&&(m=["",e||0,g&&g.fontSize,f.style.width].join(","),m=d===""||Ob.test(d)?"num:"+d.toString().length+m:d+m);m&&!a&&(b=c.cache[m]);if(!b){if(f.namespaceURI===Da||c.forExport){try{k=this.fakeTS&&function(a){o(f.querySelectorAll(".highcharts-text-shadow"),function(b){b.style.display=a})},Ja&&j.textShadow?(i=j.textShadow,j.textShadow=""):k&&k(O),b=f.getBBox?r({},f.getBBox()):{width:f.offsetWidth,height:f.offsetHeight},i?j.textShadow=
i:k&&k("")}catch(l){}if(!b||b.width<0)b={width:0,height:0}}else b=this.htmlGetBBox();if(c.isSVG){a=b.width;d=b.height;if(xa&&g&&g.fontSize==="11px"&&d.toPrecision(3)==="16.9")b.height=d=14;if(e)b.width=N(d*aa(h))+N(a*X(h)),b.height=N(d*X(h))+N(a*aa(h))}m&&(c.cache[m]=b)}return b},show:function(a){return this.attr({visibility:a?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.attr({y:-9999})}})},
add:function(a){var b=this.renderer,c=this.element,d;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);this.added=!0;if(!a||a.handleZ||this.zIndex)d=this.zIndexSetter();d||(a?a.element:b.box).appendChild(c);if(this.onAdd)this.onAdd();return this},safeRemoveChild:function(a){var b=a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=
b.onmouseover=b.onmousemove=b.point=null;kb(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&o(c,function(b){a.safeRemoveChild(b)});d&&d.div&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,d=b;a.alignTo&&ja(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=p(a.width,3);
j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+p(a.offsetX,1)+", "+p(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;J(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:O});if(c)J(f,"height",t(J(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this},xGetter:function(a){this.element.nodeName==="circle"&&(a={x:"cx",y:"cy"}[a]||a);return this._defaultGetter(a)},
_defaultGetter:function(a){a=p(this[a],this.element?this.element.getAttribute(a):null,0);/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a));return a},dSetter:function(a,b,c){a&&a.join&&(a=a.join(" "));/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");c.setAttribute(b,a);this[b]=a},dashstyleSetter:function(a){var b;if(a=a&&a.toLowerCase()){a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash",
"4,3,").replace(/,$/,"").split(",");for(b=a.length;b--;)a[b]=F(a[b])*this["stroke-width"];a=a.join(",").replace("NaN","none");this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},opacitySetter:function(a,b,c){this[b]=a;c.setAttribute(b,a)},titleSetter:function(a){var b=this.element.getElementsByTagName("title")[0];b||(b=C.createElementNS(Da,"title"),this.element.appendChild(b));b.appendChild(C.createTextNode(String(p(a),
"").replace(/<[^>]*>/g,"")))},textSetter:function(a){if(a!==this.textStr)delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this)},fillSetter:function(a,b,c){typeof a==="string"?c.setAttribute(b,a):a&&this.colorGradient(a,b,c)},visibilitySetter:function(a,b,c){a==="inherit"?c.removeAttribute(b):c.setAttribute(b,a)},zIndexSetter:function(a,b){var c=this.renderer,d=this.parentGroup,c=(d||c).element||c.box,e,f,g=this.element,h;e=this.added;var i;s(a)&&(g.setAttribute(b,a),a=+a,this[b]===
a&&(e=!1),this[b]=a);if(e){if((a=this.zIndex)&&d)d.handleZ=!0;d=c.childNodes;for(i=0;i<d.length&&!h;i++)if(e=d[i],f=J(e,"zIndex"),e!==g&&(F(f)>a||!s(a)&&s(f)))c.insertBefore(g,e),h=!0;h||c.appendChild(g)}return h},_defaultSetter:function(a,b,c){c.setAttribute(b,a)}};P.prototype.yGetter=P.prototype.xGetter;P.prototype.translateXSetter=P.prototype.translateYSetter=P.prototype.rotationSetter=P.prototype.verticalAlignSetter=P.prototype.scaleXSetter=P.prototype.scaleYSetter=function(a,b){this[b]=a;this.doTransform=
!0};P.prototype["stroke-widthSetter"]=P.prototype.strokeSetter=function(a,b,c){this[b]=a;if(this.stroke&&this["stroke-width"])this.strokeWidth=this["stroke-width"],P.prototype.fillSetter.call(this,this.stroke,"stroke",c),c.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0;else if(b==="stroke-width"&&a===0&&this.hasStroke)c.removeAttribute("stroke"),this.hasStroke=!1};var ua=function(){this.init.apply(this,arguments)};ua.prototype={Element:P,init:function(a,b,c,d,e){var f=location,
g,d=this.createElement("svg").attr({version:"1.1"}).css(this.getStyle(d));g=d.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&J(g,"xmlns",Da);this.isSVG=!0;this.box=g;this.boxWrapper=d;this.alignedObjects=[];this.url=(Ja||fb)&&C.getElementsByTagName("base").length?f.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(C.createTextNode("Created with Highcharts 4.1.8"));this.defs=this.createElement("defs").add();
this.forExport=e;this.gradients={};this.cache={};this.setSize(b,c,!1);var h;if(Ja&&a.getBoundingClientRect)this.subPixelFix=b=function(){L(a,{left:0,top:0});h=a.getBoundingClientRect();L(a,{left:sa(h.left)-h.left+"px",top:sa(h.top)-h.top+"px"})},b(),H(K,"resize",b)},getStyle:function(a){return this.style=r({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;
this.box=null;this.boxWrapper=this.boxWrapper.destroy();Oa(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&Z(K,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;b.init(this,a);return b},draw:function(){},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=p(a.textStr,"").toString(),f=e.indexOf("<")!==-1,g=b.childNodes,h,i,j=J(b,"x"),k=a.styles,m=a.textWidth,l=k&&k.lineHeight,n=k&&k.textShadow,
q=k&&k.textOverflow==="ellipsis",x=g.length,T=m&&!a.added&&this.box,Q=function(a){return l?F(l):c.fontMetrics(/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:k&&k.fontSize||c.style.fontSize||12,a).h},u=function(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">")};x--;)b.removeChild(g[x]);!f&&!n&&!q&&e.indexOf(" ")===-1?b.appendChild(C.createTextNode(u(e))):(h=/<.*style="([^"]+)".*>/,i=/<.*href="(http[^"]+)".*>/,T&&T.appendChild(b),e=f?e.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,
'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[e],e[e.length-1]===""&&e.pop(),o(e,function(e,f){var g,l=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");g=e.split("|||");o(g,function(e){if(e!==""||g.length===1){var n={},x=C.createElementNS(Da,"tspan"),p;h.test(e)&&(p=e.match(h)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),J(x,"style",p));i.test(e)&&!d&&(J(x,"onclick",'location.href="'+e.match(i)[1]+'"'),
L(x,{cursor:"pointer"}));e=u(e.replace(/<(.|\n)*?>/g,"")||" ");if(e!==" "){x.appendChild(C.createTextNode(e));if(l)n.dx=0;else if(f&&j!==null)n.x=j;J(x,n);b.appendChild(x);!l&&f&&(!ca&&d&&L(x,{display:"block"}),J(x,"dy",Q(x)));if(m){for(var n=e.replace(/([^\^])-/g,"$1- ").split(" "),o=g.length>1||f||n.length>1&&k.whiteSpace!=="nowrap",T,y,s,t=[],v=Q(x),w=1,r=a.rotation,z=e,A=z.length;(o||q)&&(n.length||t.length);)a.rotation=0,T=a.getBBox(!0),s=T.width,!ca&&c.forExport&&(s=c.measureSpanWidth(x.firstChild.data,
a.styles)),T=s>m,y===void 0&&(y=T),q&&y?(A/=2,z===""||!T&&A<0.5?n=[]:(T&&(y=!0),z=e.substring(0,z.length+(T?-1:1)*sa(A)),n=[z+(m>3?"\u2026":"")],x.removeChild(x.firstChild))):!T||n.length===1?(n=t,t=[],n.length&&(w++,x=C.createElementNS(Da,"tspan"),J(x,{dy:v,x:j}),p&&J(x,"style",p),b.appendChild(x)),s>m&&(m=s)):(x.removeChild(x.firstChild),t.unshift(n.pop())),n.length&&x.appendChild(C.createTextNode(n.join(" ").replace(/- /g,"-")));y&&a.attr("title",a.textStr);a.rotation=r}l++}}})}),T&&T.removeChild(b),
n&&a.applyTextShadow&&a.applyTextShadow(n))},getContrast:function(a){a=na(a).rgba;return a[0]+a[1]+a[2]>384?"#000000":"#FFFFFF"},button:function(a,b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,m,l,n,q,x,p,a={x1:0,y1:0,x2:0,y2:1},e=A({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);n=e.style;delete e.style;f=A(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);
q=f.style;delete f.style;g=A(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);x=g.style;delete g.style;h=A(e,{style:{color:"#CCC"}},h);p=h.style;delete h.style;H(j.element,xa?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(q)});H(j.element,xa?"mouseout":"mouseleave",function(){k!==3&&(m=[e,f,g][k],l=[n,q,x][k],j.attr(m).css(l))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(x):a===3&&j.attr(h).css(p):j.attr(e).css(n)};return j.on("click",function(a){k!==
3&&d.call(j,a)}).attr(e).css(r({cursor:"default"},n))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=w(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=w(a[2])+b%2/2);return a},path:function(a){var b={fill:O};Fa(a)?b.d=a:da(a)&&r(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=da(a)?a:{x:a,y:b,r:c};b=this.createElement("circle");b.xSetter=function(a){this.element.setAttribute("cx",a)};b.ySetter=function(a){this.element.setAttribute("cy",a)};return b.attr(a)},arc:function(a,b,c,d,e,
f){if(da(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){var e=da(a)?a.r:e,g=this.createElement("rect"),a=da(a)?a:a===v?{}:{x:a,y:b,width:t(c,0),height:t(d,0)};if(f!==v)a.strokeWidth=f,a=g.crisp(a);if(e)a.r=e;g.rSetter=function(a){J(this.element,{rx:a,ry:a})};return g.attr(a)},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[p(c,
!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return s(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:O};arguments.length>1&&r(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g,h=this.symbols[a],h=h&&h(w(b),
w(c),d,e,f),i=/^url\((.*?)\)$/,j,k;if(h)g=this.path(h),r(g,{symbolName:a,x:b,y:c,width:d,height:e}),f&&r(g,f);else if(i.test(a))k=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(w((d-b[0])/2),w((e-b[1])/2)))},j=a.match(i)[1],a=Kb[j]||f&&f.width&&f.height&&[f.width,f.height],g=this.image(j).attr({x:b,y:c}),g.isImg=!0,a?k(g,a):(g.attr({width:0,height:0}),$("img",{onload:function(){k(g,Kb[j]=[this.width,this.height])},src:j}));return g},symbols:{circle:function(a,
b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=X(f),j=aa(f),
k=X(g),g=aa(g),e=e.end-f<ma?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]},callout:function(a,b,c,d,e){var f=z(e&&e.r||0,c,d),g=f+6,h=e&&e.anchorX,e=e&&e.anchorY,i;i=["M",a+f,b,"L",a+c-f,b,"C",a+c,b,a+c,b,a+c,b+f,"L",a+c,b+d-f,"C",a+c,b+d,a+c,b+d,a+c-f,b+d,"L",a+f,b+d,"C",a,b+d,a,b+d,a,b+d-f,"L",a,b+f,"C",a,b,a,b,a+f,b];h&&h>c&&e>b+g&&e<b+d-g?i.splice(13,3,"L",a+c,e-6,a+c+6,e,a+c,e+6,a+c,b+d-f):h&&h<0&&e>b+g&&e<b+d-g?i.splice(33,3,"L",
a,e+6,a-6,e,a,e-6,a,b+f):e&&e>d&&h>a+g&&h<a+c-g?i.splice(23,3,"L",h+6,b+d,h,b+d+6,h-6,b+d,a+f,b+d):e&&e<0&&h>a+g&&h<a+c-g&&i.splice(3,3,"L",h-6,b,h,b-6,h+6,b,c-f,b);return i}},clipRect:function(a,b,c,d){var e="highcharts-"+wb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;a.count=0;return a},text:function(a,b,c,d){var e=fa||!ca&&this.forExport,f={};if(d&&!this.forExport)return this.html(a,b,c);f.x=Math.round(b||0);if(c)f.y=Math.round(c);
if(a||a===0)f.text=a;a=this.createElement("text").attr(f);e&&a.css({position:"absolute"});if(!d)a.xSetter=function(a,b,c){var d=c.getElementsByTagName("tspan"),e,f=c.getAttribute(b),l;for(l=0;l<d.length;l++)e=d[l],e.getAttribute(b)===f&&e.setAttribute(b,a);c.setAttribute(b,a)};return a},fontMetrics:function(a,b){var c,d,a=a||this.style.fontSize;b&&K.getComputedStyle&&(b=b.element||b,a=(c=K.getComputedStyle(b,""))&&c.fontSize);a=/px/.test(a)?F(a):/em/.test(a)?parseFloat(a)*12:12;c=a<24?a+3:w(a*1.2);
d=w(c*0.8);return{h:c,b:d,f:a}},rotCorr:function(a,b,c){var d=a;b&&c&&(d=t(d*X(b*ga),4));return{x:-a/3*aa(b*ga),y:d}},label:function(a,b,c,d,e,f,g,h,i){function j(){var a,b;a=q.element.style;p=(t===void 0||yb===void 0||n.styles.textAlign)&&s(q.textStr)&&q.getBBox();n.width=(t||p.width||0)+2*u+y;n.height=(yb||p.height||0)+2*u;B=u+l.fontMetrics(a&&a.fontSize,q).b;if(D){if(!x)a=w(-Q*u)+C,b=(h?-B:0)+C,n.box=x=d?l.symbol(d,a,b,n.width,n.height,G):l.rect(a,b,n.width,n.height,0,G[Pb]),x.isImg||x.attr("fill",
O),x.add(n);x.isImg||x.attr(r({width:w(n.width),height:w(n.height)},G));G=null}}function k(){var a=n.styles,a=a&&a.textAlign,b=y+u*(1-Q),c;c=h?0:B;if(s(t)&&p&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(t-p.width);if(b!==q.x||c!==q.y)q.attr("x",b),c!==v&&q.attr("y",c);q.x=b;q.y=c}function m(a,b){x?x.attr(a,b):G[a]=b}var l=this,n=l.g(i),q=l.text("",0,0,g).attr({zIndex:1}),x,p,Q=0,u=3,y=0,t,yb,zb,z,C=0,G={},B,D;n.onAdd=function(){q.add(n);n.attr({text:a||a===0?a:"",x:b,y:c});x&&s(e)&&n.attr({anchorX:e,
anchorY:f})};n.widthSetter=function(a){t=a};n.heightSetter=function(a){yb=a};n.paddingSetter=function(a){if(s(a)&&a!==u)u=n.padding=a,k()};n.paddingLeftSetter=function(a){s(a)&&a!==y&&(y=a,k())};n.alignSetter=function(a){Q={left:0,center:0.5,right:1}[a]};n.textSetter=function(a){a!==v&&q.textSetter(a);j();k()};n["stroke-widthSetter"]=function(a,b){a&&(D=!0);C=a%2/2;m(b,a)};n.strokeSetter=n.fillSetter=n.rSetter=function(a,b){b==="fill"&&a&&(D=!0);m(b,a)};n.anchorXSetter=function(a,b){e=a;m(b,w(a)-
C-zb)};n.anchorYSetter=function(a,b){f=a;m(b,a-z)};n.xSetter=function(a){n.x=a;Q&&(a-=Q*((t||p.width)+u));zb=w(a);n.attr("translateX",zb)};n.ySetter=function(a){z=n.y=w(a);n.attr("translateY",z)};var F=n.css;return r(n,{css:function(a){if(a){var b={},a=A(a);o(n.textProps,function(c){a[c]!==v&&(b[c]=a[c],delete a[c])});q.css(b)}return F.call(n,a)},getBBox:function(){return{width:p.width+2*u,height:p.height+2*u,x:p.x-u,y:p.y-u}},shadow:function(a){x&&x.shadow(a);return n},destroy:function(){Z(n.element,
"mouseenter");Z(n.element,"mouseleave");q&&(q=q.destroy());x&&(x=x.destroy());P.prototype.destroy.call(n);n=l=j=k=m=null}})}};Za=ua;r(P.prototype,{htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();if(a&&a.textOverflow==="ellipsis")a.whiteSpace="nowrap",a.overflow="hidden";this.styles=r(this.styles,a);L(this.element,a);return this},htmlGetBBox:function(){var a=this.element;if(a.nodeName==="text")a.style.position="absolute";
return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=this.shadows,j=this.styles;L(b,{marginLeft:c,marginTop:d});i&&o(i,function(a){L(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&o(b.childNodes,function(c){a.invertChild(c,b)});if(b.tagName==="SPAN"){var k=this.rotation,
m,l=F(this.textWidth),n=[k,g,b.innerHTML,this.textWidth,this.textAlign].join(",");if(n!==this.cTT){m=a.fontMetrics(b.style.fontSize).b;s(k)&&this.setSpanRotation(k,h,m);i=p(this.elemWidth,b.offsetWidth);if(i>l&&/[ \-]/.test(b.textContent||b.innerText))L(b,{width:l+"px",display:"block",whiteSpace:j&&j.whiteSpace||"normal"}),i=l;this.getSpanCorrection(i,m,h,k,g)}L(b,{left:e+(this.xCorr||0)+"px",top:f+(this.yCorr||0)+"px"});if(fb)m=b.offsetHeight;this.cTT=n}}else this.alignOnAdd=!0},setSpanRotation:function(a,
b,c){var d={},e=xa?"-ms-transform":fb?"-webkit-transform":Ja?"MozTransform":Ib?"-o-transform":"";d[e]=d.transform="rotate("+a+"deg)";d[e+(Ja?"Origin":"-origin")]=d.transformOrigin=b*100+"% "+c+"px";L(this.element,d)},getSpanCorrection:function(a,b,c){this.xCorr=-a*c;this.yCorr=-b}});r(ua.prototype,{html:function(a,b,c){var d=this.createElement("span"),e=d.element,f=d.renderer;d.textSetter=function(a){a!==e.innerHTML&&delete this.bBox;e.innerHTML=this.textStr=a;d.htmlUpdateTransform()};d.xSetter=d.ySetter=
d.alignSetter=d.rotationSetter=function(a,b){b==="align"&&(b="textAlign");d[b]=a;d.htmlUpdateTransform()};d.attr({text:a,x:w(b),y:w(c)}).css({position:"absolute",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize});e.style.whiteSpace="nowrap";d.css=d.htmlCss;if(f.isSVG)d.add=function(a){var b,c=f.box.parentNode,j=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)j.push(a),a=a.parentGroup;o(j.reverse(),function(a){var d,e=J(a.element,"class");e&&(e={className:e});b=a.div=a.div||$(Ia,e,{position:"absolute",
left:(a.translateX||0)+"px",top:(a.translateY||0)+"px"},b||c);d=b.style;r(a,{translateXSetter:function(b,c){d.left=b+"px";a[c]=b;a.doTransform=!0},translateYSetter:function(b,c){d.top=b+"px";a[c]=b;a.doTransform=!0}});Sa(a,"visibilitySetter",function(a,b,c,e){a.call(this,b,c,e);d[c]=b})})}}else b=c;b.appendChild(e);d.added=!0;d.alignOnAdd&&d.htmlUpdateTransform();return d};return d}});if(!ca&&!fa){D={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===
Ia;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=$(c);this.renderer=a},add:function(a){var b=this.renderer,c=this.element,d=b.box,d=a?a.element||a:d;a&&a.inverted&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();if(this.onAdd)this.onAdd();return this},updateTransform:P.prototype.htmlUpdateTransform,
setSpanRotation:function(){var a=this.rotation,b=X(a*ga),c=aa(a*ga);L(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",b,", M12=",-c,", M21=",c,", M22=",b,", sizingMethod='auto expand')"].join(""):O})},getSpanCorrection:function(a,b,c,d,e){var f=d?X(d*ga):1,g=d?aa(d*ga):0,h=p(this.elemHeight,this.element.offsetHeight),i;this.xCorr=f<0&&-a;this.yCorr=g<0&&-h;i=f*g<0;this.xCorr+=g*b*(i?1-c:c);this.yCorr-=f*b*(d?i?c:1-c:1);e&&e!=="left"&&(this.xCorr-=a*c*(f<0?-1:1),d&&(this.yCorr-=
h*c*(g<0?-1:1)),L(this.element,{textAlign:e}))},pathToVML:function(a){for(var b=a.length,c=[];b--;)if(qa(a[b]))c[b]=w(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))c[b+5]===c[b+7]&&(c[b+7]+=a[b+7]>a[b+5]?1:-1),c[b+6]===c[b+8]&&(c[b+8]+=a[b+8]>a[b+6]?1:-1);return c.join(" ")||"x"},clip:function(a){var b=this,c;a?(c=a.members,ja(c,b),c.push(b),b.destroyClip=function(){ja(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:eb?"inherit":"rect(auto)"});
return b.css(a)},css:P.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Pa(a)},destroy:function(){this.destroyClip&&this.destroyClip();return P.prototype.destroy.apply(this)},on:function(a,b){this.element["on"+a]=function(){var a=K.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=F(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,
m,l,n,q;k&&typeof k.value!=="string"&&(k="x");l=k;if(a){n=p(a.width,3);q=(a.opacity||0.15)/n;for(e=1;e<=3;e++){m=n*2+1-2*e;c&&(l=this.cutOffPath(k.value,m+0.5));j=['<shape isShadow="true" strokeweight="',m,'" filled="false" path="',l,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=$(g.prepVML(j),null,{left:F(i.left)+p(a.offsetX,1),top:F(i.top)+p(a.offsetY,1)});if(c)h.cutOff=m+1;j=['<stroke color="',a.color||"black",'" opacity="',q*e,'"/>'];$(g.prepVML(j),null,null,h);b?b.element.appendChild(h):
f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this},updateShadows:ta,setAttr:function(a,b){eb?this.element[a]=b:this.element.setAttribute(a,b)},classSetter:function(a){this.element.className=a},dashstyleSetter:function(a,b,c){(c.getElementsByTagName("stroke")[0]||$(this.renderer.prepVML(["<stroke/>"]),null,null,c))[b]=a||"solid";this[b]=a},dSetter:function(a,b,c){var d=this.shadows,a=a||[];this.d=a.join&&a.join(" ");c.path=a=this.pathToVML(a);if(d)for(c=d.length;c--;)d[c].path=d[c].cutOff?
this.cutOffPath(a,d[c].cutOff):a;this.setAttr(b,a)},fillSetter:function(a,b,c){var d=c.nodeName;if(d==="SPAN")c.style.color=a;else if(d!=="IMG")c.filled=a!==O,this.setAttr("fillcolor",this.renderer.color(a,c,b,this))},opacitySetter:ta,rotationSetter:function(a,b,c){c=c.style;this[b]=c[b]=a;c.left=-w(aa(a*ga)+1)+"px";c.top=w(X(a*ga))+"px"},strokeSetter:function(a,b,c){this.setAttr("strokecolor",this.renderer.color(a,c,b))},"stroke-widthSetter":function(a,b,c){c.stroked=!!a;this[b]=a;qa(a)&&(a+="px");
this.setAttr("strokeweight",a)},titleSetter:function(a,b){this.setAttr(b,a)},visibilitySetter:function(a,b,c){a==="inherit"&&(a="visible");this.shadows&&o(this.shadows,function(c){c.style[b]=a});c.nodeName==="DIV"&&(a=a==="hidden"?"-999em":0,eb||(c.style[b]=a?"visible":"hidden"),b="top");c.style[b]=a},xSetter:function(a,b,c){this[b]=a;b==="x"?b="left":b==="y"&&(b="top");this.updateClipping?(this[b]=a,this.updateClipping()):c.style[b]=a},zIndexSetter:function(a,b,c){c.style[b]=a}};B.VMLElement=D=ka(P,
D);D.prototype.ySetter=D.prototype.widthSetter=D.prototype.heightSetter=D.prototype.xSetter;var La={Element:D,isIE8:za.indexOf("MSIE 8.0")>-1,init:function(a,b,c,d){var e;this.alignedObjects=[];d=this.createElement(Ia).css(r(this.getStyle(d),{position:"relative"}));e=d.element;a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.cache={};this.setSize(b,c,!1);if(!C.namespaces.hcv){C.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{C.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){C.styleSheets[0].cssText+=
"hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=da(a);return r(e,{members:[],count:0,left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+w(a?e:d)+"px,"+
w(a?f:b)+"px,"+w(a?b:f)+"px,"+w(a?d:e)+"px)"};!a&&eb&&c==="DIV"&&r(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){o(e.members,function(a){a.element&&a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j=O;a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,m,l=a.linearGradient||a.radialGradient,n,q,x,p,Q,u="",a=a.stops,y,t=[],s=function(){h=['<fill colors="'+t.join(",")+'" opacity="',x,'" o:opacity2="',q,'" type="',i,'" ',u,
'focus="100%" method="any" />'];$(e.prepVML(h),null,null,b)};n=a[0];y=a[a.length-1];n[0]>0&&a.unshift([0,n[1]]);y[0]<1&&a.push([1,y[1]]);o(a,function(a,b){g.test(a[1])?(f=na(a[1]),k=f.get("rgb"),m=f.get("a")):(k=a[1],m=1);t.push(a[0]*100+"% "+k);b?(x=m,p=k):(q=m,Q=k)});if(c==="fill")if(i==="gradient")c=l.x1||l[0]||0,a=l.y1||l[1]||0,n=l.x2||l[2]||0,l=l.y2||l[3]||0,u='angle="'+(90-W.atan((l-a)/(n-c))*180/ma)+'"',s();else{var j=l.r,v=j*2,w=j*2,r=l.cx,z=l.cy,A=b.radialReference,C,j=function(){A&&(C=d.getBBox(),
r+=(A[0]-C.x)/C.width-0.5,z+=(A[1]-C.y)/C.height-0.5,v*=A[2]/C.width,w*=A[2]/C.height);u='src="'+S.global.VMLRadialGradientURL+'" size="'+v+","+w+'" origin="0.5,0.5" position="'+r+","+z+'" color2="'+Q+'" ';s()};d.added?j():d.onAdd=j;j=p}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=na(a),h=["<",c,' opacity="',f.get("a"),'"/>'],$(this.prepVML(h),null,null,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,
a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:ua.prototype.html,path:function(a){var b={coordsize:"10 10"};Fa(a)?b.d=a:da(a)&&r(b,a);return this.createElement("shape").attr(b)},circle:function(a,b,c){var d=this.symbol("circle");if(da(a))c=a.r,
b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Ia).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},createElement:function(a){return a==="rect"?this.symbol(a):ua.prototype.createElement.call(this,a)},invertChild:function(a,b){var c=this,d=b.style,e=a.tagName==="IMG"&&a.style;L(a,{flip:"x",
left:F(d.width)-(e?F(e.top):1),top:F(d.height)-(e?F(e.left):1),rotation:-90});o(a.childNodes,function(b){c.invertChild(b,a)})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=X(f),i=aa(f),j=X(g),k=aa(g);if(g-f===0)return["x"];f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",
a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){return ua.prototype.symbols[!s(e)||!e.r?"square":"callout"].call(0,a,b,c,d,e)}}};B.VMLRenderer=D=function(){this.init.apply(this,arguments)};D.prototype=A(ua.prototype,La);Za=D}ua.prototype.measureSpanWidth=function(a,b){var c=C.createElement("span"),d;d=C.createTextNode(a);c.appendChild(d);L(c,b);this.box.appendChild(c);d=c.offsetWidth;Pa(c);return d};var Lb;if(fa)B.CanVGRenderer=D=function(){Da="http://www.w3.org/1999/xhtml"},D.prototype.symbols=
{},Lb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){b.length===0&&Qb(d,a);b.push(c)}}}(),Za=D;Ra.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.categories,e=a.names,f=this.pos,g=b.labels,h=a.tickPositions,i=f===h[0],j=f===h[h.length-1],e=d?p(d[f],e[f],f):f,d=this.label,h=h.info,k;a.isDatetimeAxis&&h&&(k=b.dateTimeLabelFormats[h.higherRanks[f]||h.unitName]);this.isFirst=i;this.isLast=j;b=a.labelFormatter.call({axis:a,
chart:c,isFirst:i,isLast:j,dateTimeLabelFormat:k,value:a.isLog?ea(ia(e)):e});s(d)?d&&d.attr({text:b}):(this.labelLength=(this.label=d=s(b)&&g.enabled?c.renderer.text(b,0,0,g.useHTML).css(A(g.style)).add(a.labelGroup):null)&&d.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var b=this.axis,c=a.x,d=b.chart.chartWidth,e=b.chart.spacing,f=p(b.labelLeft,z(b.pos,e[3])),e=p(b.labelRight,t(b.pos+
b.len,d-e[1])),g=this.label,h=this.rotation,i={left:0,center:0.5,right:1}[b.labelAlign],j=g.getBBox().width,k=b.slotWidth,m=1,l,n={};if(h)h<0&&c-i*j<f?l=w(c/X(h*ga)-f):h>0&&c+i*j>e&&(l=w((d-c)/X(h*ga)));else if(d=c+(1-i)*j,c-i*j<f?k=a.x+k*(1-i)-f:d>e&&(k=e-a.x+k*i,m=-1),k=z(b.slotWidth,k),k<b.slotWidth&&b.labelAlign==="center"&&(a.x+=m*(b.slotWidth-k-i*(b.slotWidth-z(j,k)))),j>k||b.autoRotation&&g.styles.width)l=k;if(l){n.width=l;if(!b.options.labels.style.textOverflow)n.textOverflow="ellipsis";g.css(n)}},
getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,m=i.staggerLines,l=i.tickRotCorr||{x:0,y:0},c=p(e.y,l.y+(i.side===2?8:-(c.getBBox().height/2))),a=a+e.x+l.x-
(f&&d?f*j*(k?-1:1):0),b=b+c-(f&&!d?f*j*(k?1:-1):0);m&&(b+=g/(h||1)%m*(i.labelOffset/m));return{x:a,y:w(b)}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,m=this.gridLine,l=h?h+"Grid":"grid",n=h?h+"Tick":"tick",q=e[l+"LineWidth"],x=e[l+"LineColor"],o=e[l+"LineDashStyle"],Q=e[n+"Length"],l=p(e[n+"Width"],!h&&d.isXAxis?1:0),u=e[n+
"Color"],y=e[n+"Position"],n=this.mark,t=k.step,s=!0,w=d.tickmarkOffset,r=this.getPosition(g,j,w,b),z=r.x,r=r.y,C=g&&z===d.pos+d.len||!g&&r===d.pos?-1:1,c=p(c,1);this.isActive=!0;if(q){j=d.getPlotLinePath(j+w,q*C,b,!0);if(m===v){m={stroke:x,"stroke-width":q};if(o)m.dashstyle=o;if(!h)m.zIndex=1;if(b)m.opacity=0;this.gridLine=m=q?f.path(j).attr(m).add(d.gridGroup):null}if(!b&&m&&j)m[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(l&&Q)y==="inside"&&(Q=-Q),d.opposite&&(Q=-Q),h=this.getMarkPath(z,r,
Q,l*C,g,f),n?n.animate({d:h,opacity:c}):this.mark=f.path(h).attr({stroke:u,"stroke-width":l,opacity:c}).add(d.axisGroup);if(i&&!isNaN(z))i.xy=r=this.getLabelPosition(z,r,i,g,k,w,a,t),this.isFirst&&!this.isLast&&!p(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!p(e.showLastLabel,1)?s=!1:g&&!d.isRadial&&!k.step&&!k.rotation&&!b&&c!==0&&this.handleOverflow(r),t&&a%t&&(s=!1),s&&!isNaN(r.y)?(r.opacity=c,i[this.isNew?"attr":"animate"](r),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Oa(this,this.axis)}};
B.PlotLineOrBand=function(a,b){this.axis=a;if(b)this.options=b,this.id=b.id};B.PlotLineOrBand.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=a.options,e=d.label,f=a.label,g=d.width,h=d.to,i=d.from,j=s(i)&&s(h),k=d.value,m=d.dashStyle,l=a.svgElem,n=[],q,x=d.color,p=d.zIndex,o=d.events,u={},y=b.chart.renderer;b.isLog&&(i=Ba(i),h=Ba(h),k=Ba(k));if(g){if(n=b.getPlotLinePath(k,g),u={stroke:x,"stroke-width":g},m)u.dashstyle=m}else if(j){n=b.getPlotBandPath(i,h,d);if(x)u.fill=x;if(d.borderWidth)u.stroke=
d.borderColor,u["stroke-width"]=d.borderWidth}else return;if(s(p))u.zIndex=p;if(l)if(n)l.animate({d:n},null,l.onGetPath);else{if(l.hide(),l.onGetPath=function(){l.show()},f)a.label=f=f.destroy()}else if(n&&n.length&&(a.svgElem=l=y.path(n).attr(u).add(),o))for(q in d=function(b){l.on(b,function(c){o[b].apply(a,[c])})},o)d(q);if(e&&s(e.text)&&n&&n.length&&b.width>0&&b.height>0){e=A({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},e);if(!f){u={align:e.textAlign||
e.align,rotation:e.rotation};if(s(p))u.zIndex=p;a.label=f=y.text(e.text,0,0,e.useHTML).attr(u).css(e.style).add()}b=[n[1],n[4],j?n[6]:n[1]];j=[n[2],n[5],j?n[7]:n[2]];n=Na(b);c=Na(j);f.align(e,!1,{x:n,y:c,width:Ca(b)-n,height:Ca(j)-c});f.show()}else f&&f.hide();return a},destroy:function(){ja(this.axis.plotLinesAndBands,this);delete this.axis;Oa(this)}};var ha=B.Axis=function(){this.init.apply(this,arguments)};ha.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",
minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#D8D8D8",labels:{enabled:!0,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0,y:15},lineColor:"#C0D0E0",lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,
tickPosition:"outside",title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return B.numberFormat(this.total,-1)},style:A(ba.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15,
y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0,y:null},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0,y:-15},title:{rotation:0}},init:function(a,b){var c=b.isX;this.chart=a;this.horiz=a.inverted?!c:c;this.coll=(this.isXAxis=c)?"xAxis":"yAxis";this.opposite=b.opposite;this.side=b.side||(this.horiz?this.opposite?0:2:this.opposite?1:3);this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;
this.userOptions=b;this.minPixelPadding=0;this.reversed=d.reversed;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=this.names||[];this.isLog=e==="logarithmic";this.isDatetimeAxis=e==="datetime";this.isLinked=s(d.linkedTo);this.ticks={};this.labelEdge=[];this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks=
{};this.stacksTouched=0;this.min=this.max=null;this.crosshair=p(d.crosshair,ra(a.options.tooltip.crosshairs)[c?0:1],!1);var f,d=this.options.events;Ka(this,a.axes)===-1&&(c&&!this.isColorAxis?a.axes.splice(a.xAxis.length,0,this):a.axes.push(this),a[this.coll].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===v)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)H(this,f,d[f]);if(this.isLog)this.val2lin=Ba,this.lin2val=ia},setOptions:function(a){this.options=
A(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],A(S[this.coll],a))},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=S.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=Ha(h,this);else if(c)g=b;else if(d)g=Ma(d,b);else if(f&&a>=1E3)for(;f--&&g===v;)c=Math.pow(1E3,
f+1),a>=c&&b*10%c===0&&e[f]!==null&&(g=B.numberFormat(b/c,-1)+e[f]);g===v&&(g=N(b)>=1E4?B.numberFormat(b,-1):B.numberFormat(b,-1,v,""));return g},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=a.ignoreMinPadding=a.ignoreMaxPadding=null;a.buildStacks&&a.buildStacks();o(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d;d=c.options.threshold;var e;a.hasVisibleSeries=!0;a.isLog&&d<=0&&(d=null);if(a.isXAxis){if(d=c.xData,d.length)a.dataMin=
z(p(a.dataMin,d[0]),Na(d)),a.dataMax=t(p(a.dataMax,d[0]),Ca(d))}else{c.getExtremes();e=c.dataMax;c=c.dataMin;if(s(c)&&s(e))a.dataMin=z(p(a.dataMin,c),c),a.dataMax=t(p(a.dataMax,e),e);if(s(d))if(a.dataMin>=d)a.dataMin=d,a.ignoreMinPadding=!0;else if(a.dataMax<d)a.dataMax=d,a.ignoreMaxPadding=!0}}})},translate:function(a,b,c,d,e,f){var g=this.linkedParent||this,h=1,i=0,j=d?g.oldTransA:g.transA,d=d?g.oldMin:g.min,k=g.minPixelPadding,e=(g.doPostTranslate||g.isLog&&e)&&g.lin2val;if(!j)j=g.transA;if(c)h*=
-1,i=g.len;g.reversed&&(h*=-1,i-=h*(g.sector||g.len));b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=g.lin2val(a))):(e&&(a=g.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(qa(f)?j*f*g.pointRange:0));return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d,e){var f=this.chart,g=this.left,h=this.top,i,j,k=c&&f.oldChartHeight||f.chartHeight,m=c&&f.oldChartWidth||
f.chartWidth,l;i=this.transB;var n=function(a,b,c){if(a<b||a>c)d?a=z(t(b,a),c):l=!0;return a},e=p(e,this.translate(a,null,null,c)),a=c=w(e+i);i=j=w(k-e-i);isNaN(e)?l=!0:this.horiz?(i=h,j=k-this.bottom,a=c=n(a,g,g+this.width)):(a=g,c=m-this.right,i=j=n(i,h,h+this.height));return l&&!d?null:f.renderer.crispLine(["M",a,i,"L",c,j],b||1)},getLinearTickPositions:function(a,b,c){var d,e=ea(V(b/a)*a),f=ea(sa(c/a)*a),g=[];if(b===c&&qa(b))return[b];for(b=e;b<=f;){g.push(b);b=ea(b+a);if(b===d)break;d=b}return g},
getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e,f=this.pointRangePadding||0;e=this.min-f;var f=this.max+f,g=f-e;if(g&&g/c<this.len/3)if(this.isLog){f=b.length;for(e=1;e<f;e++)d=d.concat(this.getLogTickPositions(c,b[e-1],b[e],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(this.getTimeTicks(this.normalizeTimeTickInterval(c),e,f,a.startOfWeek));else for(b=e+(b[0]-e)%c;b<=f;b+=c)d.push(b);d.length!==0&&this.trimTicks(d,
a.startOnTick,a.endOnTick);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j;if(this.isXAxis&&this.minRange===v&&!this.isLog)s(a.min)||s(a.max)?this.minRange=null:(o(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===v||h<f)f=h}),this.minRange=z(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){var k=this.minRange;d=(k-c+b)/2;d=[b-d,p(a.min,b-d)];if(e)d[2]=this.dataMin;
b=Ca(d);c=[b+k,p(a.max,b+k)];if(e)c[2]=this.dataMax;c=Na(c);c-b<k&&(d[0]=c-k,d[1]=p(a.min,c-k),b=Ca(d))}this.min=b;this.max=c},setAxisTranslation:function(a){var b=this,c=b.max-b.min,d=b.axisPointRange||0,e,f=0,g=0,h=b.linkedParent,i=!!b.categories,j=b.transA,k=b.isXAxis;if(k||i||d)if(h?(f=h.minPointOffset,g=h.pointRangePadding):o(b.series,function(a){var h=i?1:k?a.pointRange:b.axisPointRange||0,j=a.options.pointPlacement,q=a.closestPointRange;h>c&&(h=0);d=t(d,h);b.single||(f=t(f,Aa(j)?0:h/2),g=t(g,
j==="on"?0:h));!a.noSharedTooltip&&s(q)&&(e=s(e)?z(e,q):q)}),h=b.ordinalSlope&&e?b.ordinalSlope/e:1,b.minPointOffset=f*=h,b.pointRangePadding=g*=h,b.pointRange=z(d,c),k)b.closestPointRange=e;if(a)b.oldTransA=j;b.translationSlope=b.transA=j=b.len/(c+g||1);b.transB=b.horiz?b.left:b.bottom;b.minPixelPadding=j*f},minFromRange:function(){return this.max-this.range},setTickInterval:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.isDatetimeAxis,g=b.isXAxis,h=b.isLinked,i=d.maxPadding,j=d.minPadding,
k=d.tickInterval,m=d.tickPixelInterval,l=b.categories;!f&&!l&&!h&&this.getTickAmount();h?(b.linkedParent=c[b.coll][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=p(c.min,c.dataMin),b.max=p(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&la(11,1)):(b.min=p(b.userMin,d.min,b.dataMin),b.max=p(b.userMax,d.max,b.dataMax));if(e)!a&&z(b.min,p(b.dataMin,b.min))<=0&&la(10,1),b.min=ea(Ba(b.min),15),b.max=ea(Ba(b.max),15);if(b.range&&s(b.max))b.userMin=b.min=t(b.min,b.minFromRange()),b.userMax=b.max,
b.range=null;b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!l&&!b.axisPointRange&&!b.usePercentage&&!h&&s(b.min)&&s(b.max)&&(c=b.max-b.min)){if(!s(d.min)&&!s(b.userMin)&&j&&(b.dataMin<0||!b.ignoreMinPadding))b.min-=c*j;if(!s(d.max)&&!s(b.userMax)&&i&&(b.dataMax>0||!b.ignoreMaxPadding))b.max+=c*i}if(qa(d.floor))b.min=t(b.min,d.floor);if(qa(d.ceiling))b.max=z(b.max,d.ceiling);b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:h&&!k&&m===b.linkedParent.options.tickPixelInterval?
k=b.linkedParent.tickInterval:p(k,this.tickAmount?(b.max-b.min)/t(this.tickAmount-1,1):void 0,l?1:(b.max-b.min)*m/t(b.len,m));g&&!a&&o(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange)b.tickInterval=t(b.pointRange,b.tickInterval);a=p(d.minTickInterval,b.isDatetimeAxis&&b.closestPointRange);if(!k&&
b.tickInterval<a)b.tickInterval=a;if(!f&&!e&&!k)b.tickInterval=ob(b.tickInterval,null,nb(b.tickInterval),p(d.allowDecimals,!(b.tickInterval>0.5&&b.tickInterval<5&&b.max>1E3&&b.max<9999)),!!this.tickAmount);if(!this.tickAmount&&this.len)b.tickInterval=b.unsquish();this.setTickPositions()},setTickPositions:function(){var a=this.options,b,c=a.tickPositions,d=a.tickPositioner,e=a.startOnTick,f=a.endOnTick,g;this.tickmarkOffset=this.categories&&a.tickmarkPlacement==="between"&&this.tickInterval===1?0.5:
0;this.minorTickInterval=a.minorTickInterval==="auto"&&this.tickInterval?this.tickInterval/5:a.minorTickInterval;this.tickPositions=b=c&&c.slice();if(!b&&(b=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),b.length>this.len&&(b=[b[0],b.pop()]),
this.tickPositions=b,d&&(d=d.apply(this,[this.min,this.max]))))this.tickPositions=b=d;if(!this.isLinked)this.trimTicks(b,e,f),this.min===this.max&&s(this.min)&&!this.tickAmount&&(g=!0,this.min-=0.5,this.max+=0.5),this.single=g,!c&&!d&&this.adjustTickAmount()},trimTicks:function(a,b,c){var d=a[0],e=a[a.length-1],f=this.minPointOffset||0;b?this.min=d:this.min-f>d&&a.shift();c?this.max=e:this.max+f<e&&a.pop();a.length===0&&s(d)&&a.push((e+d)/2)},getTickAmount:function(){var a={},b,c=this.options,d=c.tickAmount,
e=c.tickPixelInterval;!s(c.tickInterval)&&this.len<e&&!this.isRadial&&!this.isLog&&c.startOnTick&&c.endOnTick&&(d=2);!d&&this.chart.options.chart.alignTicks!==!1&&c.alignTicks!==!1&&(o(this.chart[this.coll],function(c){var d=c.options,e=c.horiz,d=[e?d.left:d.top,e?d.width:d.height,d.pane].join(",");a[d]?c.series.length&&(b=!0):a[d]=1}),b&&(d=sa(this.len/e)+1));if(d<4)this.finalTickAmt=d,d=5;this.tickAmount=d},adjustTickAmount:function(){var a=this.tickInterval,b=this.tickPositions,c=this.tickAmount,
d=this.finalTickAmt,e=b&&b.length;if(e<c){for(;b.length<c;)b.push(ea(b[b.length-1]+a));this.transA*=(e-1)/(c-1);this.max=b[b.length-1]}else e>c&&(this.tickInterval*=2,this.setTickPositions());if(s(d)){for(a=c=b.length;a--;)(d===3&&a%2===1||d<=2&&a>0&&a<c-1)&&b.splice(a,1);this.finalTickAmt=v}},setScale:function(){var a,b;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();b=this.len!==this.oldAxisLength;o(this.series,function(b){if(b.isDirtyData||b.isDirty||b.xAxis.isDirty)a=
!0});if(b||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax){if(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,!this.isDirty)this.isDirty=b||this.min!==this.oldMin||this.max!==this.oldMax}else this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=p(c,!0);o(f.series,function(a){delete a.kdTree});
e=r(e,{min:a,max:b});I(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;c&&g.redraw(d)})},zoom:function(a,b){var c=this.dataMin,d=this.dataMax,e=this.options,f=z(c,p(e.min,c)),e=t(d,p(e.max,d));this.allowZoomOutside||(s(c)&&a<=f&&(a=f),s(d)&&b>=e&&(b=e));this.displayBtn=a!==v||b!==v;this.setExtremes(a,b,!1,v,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=this.horiz,e=p(b.width,a.plotWidth-c+(b.offsetRight||0)),f=p(b.height,
a.plotHeight),g=p(b.top,a.plotTop),b=p(b.left,a.plotLeft+c),c=/%$/;c.test(f)&&(f=parseFloat(f)/100*a.plotHeight);c.test(g)&&(g=parseFloat(g)/100*a.plotHeight+a.plotTop);this.left=b;this.top=g;this.width=e;this.height=f;this.bottom=a.chartHeight-f-g;this.right=a.chartWidth-e-b;this.len=t(d?e:f,0);this.pos=d?b:g},getExtremes:function(){var a=this.isLog;return{min:a?ea(ia(this.min)):this.min,max:a?ea(ia(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},
getThreshold:function(a){var b=this.isLog,c=b?ia(this.min):this.min,b=b?ia(this.max):this.max;a===null?a=b<0?b:c:c>a?a=c:b<a&&(a=b);return this.translate(a,0,1,0,1)},autoLabelAlign:function(a){a=(p(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},unsquish:function(){var a=this.ticks,b=this.options.labels,c=this.horiz,d=this.tickInterval,e=d,f=this.len/(((this.categories?1:0)+this.max-this.min)/d),g,h=b.rotation,i=this.chart.renderer.fontMetrics(b.style.fontSize,
a[0]&&a[0].label),j,k=Number.MAX_VALUE,m,l=function(a){a/=f||1;a=a>1?sa(a):1;return a*d};c?(m=s(h)?[h]:f<p(b.autoRotationLimit,80)&&!b.staggerLines&&!b.step&&b.autoRotation)&&o(m,function(a){var b;if(a===h||a&&a>=-90&&a<=90)j=l(N(i.h/aa(ga*a))),b=j+N(a/360),b<k&&(k=b,g=a,e=j)}):b.step||(e=l(i.h));this.autoRotation=m;this.labelRotation=g;return e},renderUnsquish:function(){var a=this.chart,b=a.renderer,c=this.tickPositions,d=this.ticks,e=this.options.labels,f=this.horiz,g=a.margin,h=this.categories?
c.length:c.length-1,i=this.slotWidth=f&&!e.step&&!e.rotation&&(this.staggerLines||1)*a.plotWidth/h||!f&&(g[3]&&g[3]-a.spacing[3]||a.chartWidth*0.33),j=t(1,w(i-2*(e.padding||5))),k={},g=b.fontMetrics(e.style.fontSize,d[0]&&d[0].label),h=e.style.textOverflow,m,l=0;if(!Aa(e.rotation))k.rotation=e.rotation||0;if(this.autoRotation)o(c,function(a){if((a=d[a])&&a.labelLength>l)l=a.labelLength}),l>j&&l>g.h?k.rotation=this.labelRotation:this.labelRotation=0;else if(i&&(m={width:j+"px"},!h)){m.textOverflow=
"clip";for(i=c.length;!f&&i--;)if(j=c[i],j=d[j].label)if(j.styles.textOverflow==="ellipsis"&&j.css({textOverflow:"clip"}),j.getBBox().height>this.len/c.length-(g.h-g.f))j.specCss={textOverflow:"ellipsis"}}if(k.rotation&&(m={width:(l>a.chartHeight*0.5?a.chartHeight*0.33:a.chartHeight)+"px"},!h))m.textOverflow="ellipsis";this.labelAlign=k.align=e.align||this.autoLabelAlign(this.labelRotation);o(c,function(a){var b=(a=d[a])&&a.label;if(b)m&&b.css(A(m,b.specCss)),delete b.specCss,b.attr(k),a.rotation=
k.rotation});this.tickRotCorr=b.rotCorr(g.b,this.labelRotation||0,this.side===2)},hasData:function(){return this.hasVisibleSeries||s(this.min)&&s(this.max)&&!!this.tickPositions},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k,m=0,l,n=0,q=d.title,x=d.labels,T=0,Q=b.axisOffset,b=b.clipOffset,u=[-1,1,1,-1][h],y;j=a.hasData();a.showAxis=k=j||p(d.showEmpty,!0);a.staggerLines=a.horiz&&x.staggerLines;if(!a.axisGroup)a.gridGroup=
c.g("grid").attr({zIndex:d.gridZIndex||1}).add(),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(),a.labelGroup=c.g("axis-labels").attr({zIndex:x.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels").add();if(j||a.isLinked){if(o(e,function(b){f[b]?f[b].addLabel():f[b]=new Ra(a,b)}),a.renderUnsquish(),o(e,function(b){if(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign)T=t(f[b].getLabelSize(),T)}),a.staggerLines)T*=a.staggerLines,a.labelOffset=T}else for(y in f)f[y].destroy(),
delete f[y];if(q&&q.text&&q.enabled!==!1){if(!a.axisTitle)a.axisTitle=c.text(q.text,0,0,q.useHTML).attr({zIndex:7,rotation:q.rotation||0,align:q.textAlign||{low:"left",middle:"center",high:"right"}[q.align]}).addClass("highcharts-"+this.coll.toLowerCase()+"-title").css(q.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(k)m=a.axisTitle.getBBox()[g?"height":"width"],l=q.offset,n=s(l)?0:p(q.margin,g?5:10);a.axisTitle[k?"show":"hide"]()}a.offset=u*p(d.offset,Q[h]);a.tickRotCorr=a.tickRotCorr||{x:0,y:0};
c=h===2?a.tickRotCorr.y:0;g=T+n+(T&&u*(g?p(x.y,a.tickRotCorr.y+8):x.x)-c);a.axisTitleMargin=p(l,g);Q[h]=t(Q[h],a.axisTitleMargin+m+u*a.offset,g);d=d.offset?0:V(d.lineWidth/2)*2;b[i]=t(b[i],d)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=
this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=e.x||0,j=e.y||0,k=F(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?k:0);return{x:a?d+i:b+(g?this.width:0)+h+i,y:a?b+j-(g?this.height:0)+h:d+j}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.isLinked,g=a.tickPositions,h=a.axisTitle,i=a.ticks,j=a.minorTicks,k=
a.alternateBands,m=d.stackLabels,l=d.alternateGridColor,n=a.tickmarkOffset,q=d.lineWidth,x,p=b.hasRendered&&s(a.oldMin)&&!isNaN(a.oldMin),Q=a.showAxis,u=c.globalAnimation,y,t;a.labelEdge.length=0;a.overlap=!1;o([i,j,k],function(a){for(var b in a)a[b].isActive=!1});if(a.hasData()||f){a.minorTickInterval&&!a.categories&&o(a.getMinorTickPositions(),function(b){j[b]||(j[b]=new Ra(a,b,"minor"));p&&j[b].isNew&&j[b].render(null,!0);j[b].render(null,!1,1)});if(g.length&&(o(g,function(b,c){if(!f||b>=a.min&&
b<=a.max)i[b]||(i[b]=new Ra(a,b)),p&&i[b].isNew&&i[b].render(c,!0,0.1),i[b].render(c)}),n&&(a.min===0||a.single)))i[-1]||(i[-1]=new Ra(a,-1,null,!0)),i[-1].render(-1);l&&o(g,function(b,c){if(c%2===0&&b<a.max)k[b]||(k[b]=new B.PlotLineOrBand(a)),y=b+n,t=g[c+1]!==v?g[c+1]+n:a.max,k[b].options={from:e?ia(y):y,to:e?ia(t):t,color:l},k[b].render(),k[b].isActive=!0});if(!a._addedPlotLB)o((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0}o([i,j,k],function(a){var c,
d,e=[],f=u?u.duration||500:0,g=function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])};for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);a===k||!b.hasRendered||!f?g():f&&setTimeout(g,f)});if(q)x=a.getLinePath(q),a.axisLine?a.axisLine.animate({d:x}):a.axisLine=c.path(x).attr({stroke:d.lineColor,"stroke-width":q,zIndex:7}).add(a.axisGroup),a.axisLine[Q?"show":"hide"]();if(h&&Q)h[h.isNew?"attr":"animate"](a.getTitlePosition()),h.isNew=
!1;m&&m.enabled&&a.renderStackTotals();a.isDirty=!1},redraw:function(){this.render();o(this.plotLinesAndBands,function(a){a.render()});o(this.series,function(a){a.isDirty=!0})},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||Z(b);for(d in c)Oa(c[d]),c[d]=null;o([b.ticks,b.minorTicks,b.alternateBands],function(a){Oa(a)});for(a=e.length;a--;)e[a].destroy();o("stackTotalGroup,axisLine,axisTitle,axisGroup,cross,gridGroup,labelGroup".split(","),function(a){b[a]&&(b[a]=b[a].destroy())});
this.cross&&this.cross.destroy()},drawCrosshair:function(a,b){var c,d=this.crosshair,e=d.animation;if(!this.crosshair||(s(b)||!p(this.crosshair.snap,!0))===!1||b&&b.series&&b.series[this.coll]!==this)this.hideCrosshair();else if(p(d.snap,!0)?s(b)&&(c=this.isXAxis?b.plotX:this.len-b.plotY):c=this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos,c=this.isRadial?this.getPlotLinePath(this.isXAxis?b.x:p(b.stackY,b.y))||null:this.getPlotLinePath(null,null,null,null,c)||null,c===null)this.hideCrosshair();
else if(this.cross)this.cross.attr({visibility:"visible"})[e?"animate":"attr"]({d:c},e);else{e=this.categories&&!this.isRadial;e={"stroke-width":d.width||(e?this.transA:1),stroke:d.color||(e?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:d.zIndex||2};if(d.dashStyle)e.dashstyle=d.dashStyle;this.cross=this.chart.renderer.path(c).attr(e).add()}},hideCrosshair:function(){this.cross&&this.cross.hide()}};r(ha.prototype,{getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b,null,null,!0),d=this.getPlotLinePath(a,
null,null,!0);d&&c&&d.toString()!==c.toString()?d.push(c[4],c[5],c[1],c[2]):d=null;return d},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new B.PlotLineOrBand(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),this.plotLinesAndBands.push(c));return c},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,
e=b.length;e--;)b[e].id===a&&b[e].destroy();o([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&ja(b,b[e])})}});ha.prototype.getTimeTicks=function(a,b,c,d){var e=[],f={},g=S.global.useUTC,h,i=new ya(b-Va(b)),j=a.unitRange,k=a.count;if(s(b)){i[Db](j>=E.second?0:k*V(i.getMilliseconds()/k));if(j>=E.second)i[Eb](j>=E.minute?0:k*V(i.getSeconds()/k));if(j>=E.minute)i[Fb](j>=E.hour?0:k*V(i[qb]()/k));if(j>=E.hour)i[Gb](j>=E.day?0:k*V(i[rb]()/k));
if(j>=E.day)i[tb](j>=E.month?1:k*V(i[Wa]()/k));j>=E.month&&(i[ub](j>=E.year?0:k*V(i[Xa]()/k)),h=i[Ya]());j>=E.year&&(h-=h%k,i[vb](h));if(j===E.week)i[tb](i[Wa]()-i[sb]()+p(d,1));b=1;if(mb||bb)i=i.getTime(),i=new ya(i+Va(i));h=i[Ya]();for(var d=i.getTime(),m=i[Xa](),l=i[Wa](),n=(E.day+(g?Va(i):i.getTimezoneOffset()*6E4))%E.day;d<c;)e.push(d),j===E.year?d=db(h+b*k,0):j===E.month?d=db(h,m+b*k):!g&&(j===E.day||j===E.week)?d=db(h,m,l+b*k*(j===E.day?1:7)):d+=j*k,b++;e.push(d);o(ib(e,function(a){return j<=
E.hour&&a%E.day===n}),function(a){f[a]="day"})}e.info=r(a,{higherRanks:f,totalRange:j*k});return e};ha.prototype.normalizeTimeTickInterval=function(a,b){var c=b||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],d=c[c.length-1],e=E[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=E[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+E[c[g+1][0]])/2)break;e===E.year&&
a<5*e&&(f=[1,2,5]);c=ob(a/e,f,d[0]==="year"?t(nb(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}};ha.prototype.getLogTickPositions=function(a,b,c,d){var e=this.options,f=this.len,g=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=w(a),g=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=V(b),h,i,j,k,m,e=a>0.3?[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!m;f++){i=e.length;for(h=0;h<i&&!m;h++)j=Ba(ia(f)*e[h]),j>b&&(!d||k<=c)&&k!==v&&g.push(k),k>c&&(m=!0),k=j}else if(b=ia(b),
c=ia(c),a=e[d?"minorTickInterval":"tickInterval"],a=p(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=ob(a,null,nb(a)),g=Ta(this.getLinearTickPositions(a,b,c),Ba),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return g};var Mb=B.Tooltip=function(){this.init.apply(this,arguments)};Mb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=F(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,
y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape||"callout",null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-9999});fa||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden&&
(N(a-f.x)>1||N(b-f.y)>1),h=e.followPointer||e.len>1;r(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:h?v:g?(2*f.anchorX+c)/3:c,anchorY:h?v:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g)clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d)},32)},hide:function(a){var b=this;clearTimeout(this.hideTimer);if(!this.isHidden)this.hideTimer=setTimeout(function(){b.label.fadeOut();b.isHidden=!0},p(a,this.options.hideDelay,500))},getAnchor:function(a,b){var c,d=this.chart,
e=d.inverted,f=d.plotTop,g=d.plotLeft,h=0,i=0,j,k,a=ra(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===v&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(o(a,function(a){j=a.series.yAxis;k=a.series.xAxis;h+=a.plotX+(!e&&k?k.left-g:0);i+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&j?j.top-f:0)}),h/=a.length,i/=a.length,c=[e?d.plotWidth-i:h,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-h:i]);return Ta(c,w)},getPosition:function(a,b,c){var d=this.chart,e=this.distance,
f={},g=c.h||0,h,i=["y",d.chartHeight,b,c.plotY+d.plotTop,d.plotTop,d.plotTop+d.plotHeight],j=["x",d.chartWidth,a,c.plotX+d.plotLeft,d.plotLeft,d.plotLeft+d.plotWidth],k=p(c.ttBelow,d.inverted&&!c.negative||!d.inverted&&c.negative),m=function(a,b,c,d,h,i){var j=c<d-e,l=d+e+c<b,m=d-e-c;d+=e;if(k&&l)f[a]=d;else if(!k&&j)f[a]=m;else if(j)f[a]=z(i-c,m-g<0?m:m-g);else if(l)f[a]=t(h,d+g+c>b?d:d+g);else return!1},l=function(a,b,c,d){if(d<e||d>b-e)return!1;else f[a]=d<c/2?1:d>b-c/2?b-c-2:d-c/2},n=function(a){var b=
i;i=j;j=b;h=a},q=function(){m.apply(0,i)!==!1?l.apply(0,j)===!1&&!h&&(n(!0),q()):h?f.x=f.y=0:(n(!0),q())};(d.inverted||this.len>1)&&n();q();return f},defaultFormatter:function(a){var b=this.points||ra(this),c;c=[a.tooltipFooterHeaderFormatter(b[0])];c=c.concat(a.bodyFormatter(b));c.push(a.tooltipFooterHeaderFormatter(b[0],!0));return c.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},j,k=[];j=e.formatter||this.defaultFormatter;var i=c.hoverPoints,m,l=this.shared;
clearTimeout(this.hideTimer);this.followPointer=ra(a)[0].series.tooltipOptions.followPointer;h=this.getAnchor(a,b);f=h[0];g=h[1];l&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&o(i,function(a){a.setState()}),o(a,function(a){a.setState("hover");k.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=k,this.len=k.length,a=a[0]):i=a.getLabelConfig();j=j.call(i,this);i=a.series;this.distance=p(i.tooltipOptions.distance,16);j===!1?this.hide():(this.isHidden&&(kb(d),d.attr("opacity",
1).show()),d.attr({text:j}),m=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:m}),this.updatePosition({plotX:f,plotY:g,negative:a.negative,ttBelow:a.ttBelow,h:h[2]||0}),this.isHidden=!1);I(c,"tooltipRefresh",{text:j,x:f+c.plotLeft,y:g+c.plotTop,borderColor:m})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(w(c.x),w(c.y||0),a.plotX+b.plotLeft,a.plotY+b.plotTop)},getXDateFormat:function(a,b,c){var d,
b=b.dateTimeLabelFormats,e=c&&c.closestPointRange,f,g={millisecond:15,second:12,minute:9,hour:6,day:3},h,i="millisecond";if(e){h=Ma("%m-%d %H:%M:%S.%L",a.x);for(f in E){if(e===E.week&&+Ma("%w",a.x)===c.options.startOfWeek&&h.substr(6)==="00:00:00.000"){f="week";break}else if(E[f]>e){f=i;break}else if(g[f]&&h.substr(g[f])!=="01-01 00:00:00.000".substr(g[f]))break;f!=="week"&&(i=f)}f&&(d=b[f])}else d=b.day;return d||b.year},tooltipFooterHeaderFormatter:function(a,b){var c=b?"footer":"header",d=a.series,
e=d.tooltipOptions,f=e.xDateFormat,g=d.xAxis,h=g&&g.options.type==="datetime"&&qa(a.key),c=e[c+"Format"];h&&!f&&(f=this.getXDateFormat(a,e,g));h&&f&&(c=c.replace("{point.key}","{point.key:"+f+"}"));return Ha(c,{point:a,series:d})},bodyFormatter:function(a){return Ta(a,function(a){var c=a.series.tooltipOptions;return(c.pointFormatter||a.point.tooltipFormatter).call(a.point,c.pointFormat)})}};var oa;$a=C.documentElement.ontouchstart!==v;var Ua=B.Pointer=function(a,b){this.init(a,b)};Ua.prototype={init:function(a,
b){var c=b.chart,d=c.events,e=fa?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.hasZoom=f||e;this.runChartClick=d&&!!d.click;this.pinchDown=[];this.lastValidTouch={};if(B.Tooltip&&b.tooltip.enabled)a.tooltip=new Mb(a,b.tooltip),this.followTouchMove=p(b.tooltip.followTouchMove,!0);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||window.event,a=Sb(a);if(!a.target)a.target=a.srcElement;
d=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a;if(!b)this.chartPosition=b=Rb(this.chart.container);d.pageX===v?(c=t(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return r(a,{chartX:w(c),chartY:w(d)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};o(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e=d?d.shared:
!1,f=b.hoverPoint,g=b.hoverSeries,h,i=b.chartWidth,j,k,m=[],l,n;if(!e&&!g)for(h=0;h<c.length;h++)if(c[h].directTouch||!c[h].options.stickyTracking)c=[];!e&&g&&g.directTouch&&f?l=f:(o(c,function(b){j=b.noSharedTooltip&&e;k=!e&&b.directTouch;b.visible&&!j&&!k&&p(b.options.enableMouseTracking,!0)&&(n=b.searchPoint(a,!j&&b.kdDimensions===1))&&m.push(n)}),o(m,function(a){if(a&&typeof a.dist==="number"&&a.dist<i)i=a.dist,l=a}));if(l&&(l!==this.prevKDPoint||d&&d.isHidden)){if(e&&!l.series.noSharedTooltip){for(h=
m.length;h--;)(m[h].clientX!==l.clientX||m[h].series.noSharedTooltip)&&m.splice(h,1);m.length&&d&&d.refresh(m,a);o(m,function(b){b.onMouseOver(a,b!==(g&&g.directTouch&&f||l))})}else if(d&&d.refresh(l,a),!g||!g.directTouch)l.onMouseOver(a);this.prevKDPoint=l}else c=g&&g.tooltipOptions.followPointer,d&&c&&!d.isHidden&&(c=d.getAnchor([{}],a),d.updatePosition({plotX:c[0],plotY:c[1]}));if(d&&!this._onDocumentMouseMove)this._onDocumentMouseMove=function(a){if(Y[oa])Y[oa].pointer.onDocumentMouseMove(a)},
H(C,"mousemove",this._onDocumentMouseMove);o(b.axes,function(b){b.drawCrosshair(a,p(l,f))})},reset:function(a,b){var c=this.chart,d=c.hoverSeries,e=c.hoverPoint,f=c.hoverPoints,g=c.tooltip,h=g&&g.shared?f:e;(a=a&&g&&h)&&ra(h)[0].plotX===v&&(a=!1);if(a)g.refresh(h),e&&(e.setState(e.state,!0),o(c.axes,function(a){p(a.options.crosshair&&a.options.crosshair.snap,!0)?a.drawCrosshair(null,e):a.hideCrosshair()}));else{if(e)e.onMouseOut();f&&o(f,function(a){a.setState()});if(d)d.onMouseOut();g&&g.hide(b);
if(this._onDocumentMouseMove)Z(C,"mousemove",this._onDocumentMouseMove),this._onDocumentMouseMove=null;o(c.axes,function(a){a.hideCrosshair()});this.hoverX=c.hoverPoints=c.hoverPoint=null}},scaleGroups:function(a,b){var c=this.chart,d;o(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},dragStart:function(a){var b=
this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,m,l=this.selectionMarker,n=this.mouseDownX,q=this.mouseDownY,x=c.panKey&&a[c.panKey+"Key"];if(!l||!l.touch)if(d<h?d=h:d>h+j&&(d=h+j),e<i?e=i:e>i+k&&(e=i+k),this.hasDragged=Math.sqrt(Math.pow(n-d,2)+Math.pow(q-e,2)),this.hasDragged>
10){m=b.isInsidePlot(n-h,q-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&m&&!x&&!l)this.selectionMarker=l=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();l&&f&&(d-=n,l.attr({width:N(d),x:(d>0?0:d)+n}));l&&g&&(d=e-q,l.attr({height:N(d),y:(d>0?0:d)+q}));m&&!l&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this,c=this.chart,d=this.hasPinched;if(this.selectionMarker){var e={xAxis:[],yAxis:[],originalEvent:a.originalEvent||
a},f=this.selectionMarker,g=f.attr?f.attr("x"):f.x,h=f.attr?f.attr("y"):f.y,i=f.attr?f.attr("width"):f.width,j=f.attr?f.attr("height"):f.height,k;if(this.hasDragged||d)o(c.axes,function(c){if(c.zoomEnabled&&s(c.min)&&(d||b[{xAxis:"zoomX",yAxis:"zoomY"}[c.coll]])){var f=c.horiz,n=a.type==="touchend"?c.minPixelPadding:0,q=c.toValue((f?g:h)+n),f=c.toValue((f?g+i:h+j)-n);e[c.coll].push({axis:c,min:z(q,f),max:t(q,f)});k=!0}}),k&&I(c,"selection",e,function(a){c.zoom(r(a,d?{animation:!1}:null))});this.selectionMarker=
this.selectionMarker.destroy();d&&this.scaleGroups()}if(c)L(c.container,{cursor:c._cursor}),c.cancelClick=this.hasDragged>10,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){Y[oa]&&Y[oa].pointer.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,a=this.normalize(a,c);c&&!this.inClass(a.target,"highcharts-tracker")&&
!b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(){var a=Y[oa];if(a)a.pointer.reset(),a.pointer.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart;oa=b.index;a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,b){for(var c;a;){if(c=J(a,"class"))if(c.indexOf(b)!==
-1)return!0;else if(c.indexOf("highcharts-container")!==-1)return!1;a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries,c=(a=a.relatedTarget||a.toElement)&&a.point&&a.point.series;if(b&&!b.options.stickyTracking&&!this.inClass(a,"highcharts-tooltip")&&c!==b)b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,a=this.normalize(a);a.originalEvent=a;b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(I(c.series,"click",
r(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(r(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&I(b,"click",a)))},setDOMEvents:function(){var a=this,b=a.chart.container;b.onmousedown=function(b){a.onContainerMouseDown(b)};b.onmousemove=function(b){a.onContainerMouseMove(b)};b.onclick=function(b){a.onContainerClick(b)};H(b,"mouseleave",a.onContainerMouseLeave);ab===1&&H(C,"mouseup",a.onDocumentMouseUp);if($a)b.ontouchstart=function(b){a.onContainerTouchStart(b)},b.ontouchmove=
function(b){a.onContainerTouchMove(b)},ab===1&&H(C,"touchend",a.onDocumentTouchEnd)},destroy:function(){var a;Z(this.chart.container,"mouseleave",this.onContainerMouseLeave);ab||(Z(C,"mouseup",this.onDocumentMouseUp),Z(C,"touchend",this.onDocumentTouchEnd));clearInterval(this.tooltipTimeout);for(a in this)this[a]=null}};r(B.Pointer.prototype,{pinchTranslate:function(a,b,c,d,e,f){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,a,b,c,d,e,f);(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,
a,b,c,d,e,f)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",m="chart"+k,l=a?"width":"height",n=i["plot"+(a?"Left":"Top")],q,x,p=h||1,o=i.inverted,u=i.bounds[a?"h":"v"],t=b.length===1,s=b[0][m],r=c[0][m],w=!t&&b[1][m],v=!t&&c[1][m],z,c=function(){!t&&N(s-w)>20&&(p=h||N(r-v)/N(s-w));x=(n-r)/p+s;q=i["plot"+(a?"Width":"Height")]/p};c();b=x;b<u.min?(b=u.min,z=!0):b+q>u.max&&(b=u.max-q,z=!0);z?(r-=0.8*(r-g[j][0]),t||(v-=0.8*(v-g[j][1])),c()):g[j]=[r,v];o||(f[j]=
x-n,f[l]=q);f=o?1/p:p;e[l]=q;e[j]=b;d[o?a?"scaleY":"scaleX":"scale"+k]=p;d["translate"+k]=f*n+(r-f*s)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=a.touches,f=e.length,g=b.lastValidTouch,h=b.hasZoom,i=b.selectionMarker,j={},k=f===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||b.runChartClick),m={};if(f>1)b.initiated=!0;h&&b.initiated&&!k&&a.preventDefault();Ta(e,function(a){return b.normalize(a)});if(a.type==="touchstart")o(e,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY}}),
g.x=[d[0].chartX,d[1]&&d[1].chartX],g.y=[d[0].chartY,d[1]&&d[1].chartY],o(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(p(a.options.min,a.dataMin)),f=a.toPixels(p(a.options.max,a.dataMax)),g=z(e,f),e=t(e,f);b.min=z(a.pos,g-d);b.max=t(a.pos+a.len,e+d)}}),b.res=!0;else if(d.length){if(!i)b.selectionMarker=i=r({destroy:ta,touch:!0},c.plotBox);b.pinchTranslate(d,e,j,i,m,g);b.hasPinched=h;b.scaleGroups(j,m);if(!h&&b.followTouchMove&&f===1)this.runPointActions(b.normalize(a));
else if(b.res)b.res=!1,this.reset(!1,0)}},touch:function(a,b){var c=this.chart;oa=c.index;a.touches.length===1?(a=this.normalize(a),c.isInsidePlot(a.chartX-c.plotLeft,a.chartY-c.plotTop)&&!c.openMenu?(b&&this.runPointActions(a),this.pinch(a)):b&&this.reset()):a.touches.length===2&&this.pinch(a)},onContainerTouchStart:function(a){this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(a){Y[oa]&&Y[oa].pointer.drop(a)}});if(K.PointerEvent||K.MSPointerEvent){var va=
{},Ab=!!K.PointerEvent,Wb=function(){var a,b=[];b.item=function(a){return this[a]};for(a in va)va.hasOwnProperty(a)&&b.push({pageX:va[a].pageX,pageY:va[a].pageY,target:va[a].target});return b},Bb=function(a,b,c,d){a=a.originalEvent||a;if((a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&Y[oa])d(a),d=Y[oa].pointer,d[b]({type:c,target:a.currentTarget,preventDefault:ta,touches:Wb()})};r(Ua.prototype,{onContainerPointerDown:function(a){Bb(a,"onContainerTouchStart","touchstart",function(a){va[a.pointerId]=
{pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){Bb(a,"onContainerTouchMove","touchmove",function(a){va[a.pointerId]={pageX:a.pageX,pageY:a.pageY};if(!va[a.pointerId].target)va[a.pointerId].target=a.currentTarget})},onDocumentPointerUp:function(a){Bb(a,"onDocumentTouchEnd","touchend",function(a){delete va[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,Ab?"pointerdown":"MSPointerDown",this.onContainerPointerDown);a(this.chart.container,Ab?
"pointermove":"MSPointerMove",this.onContainerPointerMove);a(C,Ab?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});Sa(Ua.prototype,"init",function(a,b,c){a.call(this,b,c);this.hasZoom&&L(b.container,{"-ms-touch-action":O,"touch-action":O})});Sa(Ua.prototype,"setDOMEvents",function(a){a.apply(this);(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(H)});Sa(Ua.prototype,"destroy",function(a){this.batchMSEvents(Z);a.call(this)})}var lb=B.Legend=function(a,b){this.init(a,b)};lb.prototype=
{init:function(a,b){var c=this,d=b.itemStyle,e=b.itemMarginTop||0;this.options=b;if(b.enabled)c.itemStyle=d,c.itemHiddenStyle=A(d,b.itemHiddenStyle),c.itemMarginTop=e,c.padding=d=p(b.padding,8),c.initialItemX=d,c.initialItemY=d-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.symbolWidth=p(b.symbolWidth,16),c.pages=[],c.render(),H(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,
c=b?c.itemStyle.color:g,h=b?a.legendColor||a.color||"#CCC":g,g=a.options&&a.options.marker,i={fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in i.stroke=h,g=a.convertAttribs(g),g)d=g[j],d!==v&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(b?e:this.legendWidth-e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;
o(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Pa(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight;if(b)c=b.translateY,o(this.allItems,function(e){var f=e.checkbox,g;f&&(g=c+f.y+(a||0)+3,L(f,{left:b.translateX+e.checkboxOffset+f.x-20+"px",top:g+"px",display:g>c-6&&g<c+d-6?"":O}))})},
renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},setText:function(a){var b=this.options;a.legendItem.attr({text:b.labelFormat?Ha(b.labelFormat,a):b.labelFormatter.call(a)})},renderItem:function(a){var b=
this.chart,c=b.renderer,d=this.options,e=d.layout==="horizontal",f=this.symbolWidth,g=d.symbolPadding,h=this.itemStyle,i=this.itemHiddenStyle,j=this.padding,k=e?p(d.itemDistance,20):0,m=!d.rtl,l=d.width,n=d.itemMarginBottom||0,q=this.itemMarginTop,x=this.initialItemX,o=a.legendItem,s=a.series&&a.series.drawLegendSymbol?a.series:a,u=s.options,u=this.createCheckboxForItem&&u&&u.showCheckbox,y=d.useHTML;if(!o){a.legendGroup=c.g("legend-item").attr({zIndex:1}).add(this.scrollGroup);a.legendItem=o=c.text("",
m?f+g:-g,this.baseline||0,y).css(A(a.visible?h:i)).attr({align:m?"left":"right",zIndex:2}).add(a.legendGroup);if(!this.baseline)this.fontMetrics=c.fontMetrics(h.fontSize,o),this.baseline=this.fontMetrics.f+3+q,o.attr("y",this.baseline);s.drawLegendSymbol(this,a);this.setItemEvents&&this.setItemEvents(a,o,y,h,i);this.colorizeItem(a,a.visible);u&&this.createCheckboxForItem(a)}this.setText(a);c=o.getBBox();f=a.checkboxOffset=d.itemWidth||a.legendItemWidth||f+g+c.width+k+(u?20:0);this.itemHeight=g=w(a.legendItemHeight||
c.height);if(e&&this.itemX-x+f>(l||b.chartWidth-2*j-x-d.x))this.itemX=x,this.itemY+=q+this.lastLineHeight+n,this.lastLineHeight=0;this.maxItemWidth=t(this.maxItemWidth,f);this.lastItemY=q+this.itemY+n;this.lastLineHeight=t(g,this.lastLineHeight);a._legendItemPos=[this.itemX,this.itemY];e?this.itemX+=f:(this.itemY+=q+g+n,this.lastLineHeight=g);this.offsetWidth=l||t((e?this.itemX-x-k:f)+j,this.offsetWidth)},getAllItems:function(){var a=[];o(this.chart.series,function(b){var c=b.options;if(p(c.showInLegend,
!s(c.linkedTo)?v:!1,!0))a=a.concat(b.legendItems||(c.legendType==="point"?b.data:b))});return a},adjustMargins:function(a,b){var c=this.chart,d=this.options,e=d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0);this.display&&!d.floating&&o([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(e)&&!s(a[g])&&(c[gb[g]]=t(c[gb[g]],c.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*d[g%2?"x":"y"]+p(d.margin,12)+b[g]))})},render:function(){var a=this,b=
a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,m=j.borderWidth,l=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=a.getAllItems();pb(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=
f=!!e.length;a.lastLineHeight=0;o(e,function(b){a.renderItem(b)});g=(j.width||a.offsetWidth)+k;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);h+=k;if(m||l){if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp({width:g,height:h})),i.isNew=!1}else a.box=i=c.rect(0,0,g,h,j.borderRadius,m||0).attr({stroke:j.borderColor,"stroke-width":m||0,fill:l||O}).add(d).shadow(j.shadow),i.isNew=!0;i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;o(e,function(b){a.positionItem(b)});f&&d.align(r({width:g,
height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h,i=this.clipRect,j=e.navigation,k=p(j.animation,!0),m=j.arrowSize||12,l=this.nav,n=this.pages,q=this.padding,x,s=this.allItems,r=function(a){i.attr({height:a});if(b.contentGroup.div)b.contentGroup.div.style.clip="rect("+q+"px,9999px,"+(q+a)+"px,0)"};e.layout==="horizontal"&&
(f/=2);g&&(f=z(f,g));n.length=0;if(a>f){this.clipHeight=h=t(f-20-this.titleHeight-q,0);this.currentPage=p(this.currentPage,1);this.fullHeight=a;o(s,function(a,b){var c=a._legendItemPos[1],d=w(a.legendItem.getBBox().height),e=n.length;if(!e||c-n[e-1]>h&&(x||c)!==n[e-1])n.push(x||c),e++;b===s.length-1&&c+d-n[e-1]>h&&n.push(c);c!==x&&(x=c)});if(!i)i=b.clipRect=d.clipRect(0,q,9999,0),b.contentGroup.clip(i);r(h);if(!l)this.nav=l=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,m,
m).on("click",function(){b.scroll(-1,k)}).add(l),this.pager=d.text("",15,10).css(j.style).add(l),this.down=d.symbol("triangle-down",0,0,m,m).on("click",function(){b.scroll(1,k)}).add(l);b.scroll(0);a=f}else if(l)r(c.chartHeight),l.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0;return a},scroll:function(a,b){var c=this.pages,d=c.length,e=this.currentPage+a,f=this.clipHeight,g=this.options.navigation,h=g.activeColor,g=g.inactiveColor,i=this.pager,j=this.padding;e>d&&(e=d);if(e>0)b!==
v&&Qa(b,this.chart),this.nav.attr({translateX:j,translateY:f+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:e===1?g:h}).css({cursor:e===1?"default":"pointer"}),i.attr({text:e+"/"+d}),this.down.attr({x:18+this.pager.getBBox().width,fill:e===d?g:h}).css({cursor:e===d?"default":"pointer"}),c=-c[e-1]+this.initialItemY,this.scrollGroup.animate({translateY:c}),this.currentPage=e,this.positionCheckboxes(c)}};La=B.LegendSymbolMixin={drawRectangle:function(a,b){var c=a.options.symbolHeight||
a.fontMetrics.f;b.legendSymbol=this.chart.renderer.rect(0,a.baseline-c+1,a.symbolWidth,c,a.options.symbolRadius||0).attr({zIndex:3}).add(b.legendGroup)},drawLineMarker:function(a){var b=this.options,c=b.marker,d;d=a.symbolWidth;var e=this.chart.renderer,f=this.legendGroup,a=a.baseline-w(a.fontMetrics.b*0.3),g;if(b.lineWidth){g={"stroke-width":b.lineWidth};if(b.dashStyle)g.dashstyle=b.dashStyle;this.legendLine=e.path(["M",0,a,"L",d,a]).attr(g).add(f)}if(c&&c.enabled!==!1)b=c.radius,this.legendSymbol=
d=e.symbol(this.symbol,d/2-b,a-b,2*b,2*b).add(f),d.isMarker=!0}};(/Trident\/7\.0/.test(za)||Ja)&&Sa(lb.prototype,"positionItem",function(a,b){var c=this,d=function(){b._legendItemPos&&a.call(c,b)};d();setTimeout(d)});D=B.Chart=function(){this.init.apply(this,arguments)};D.prototype={callbacks:[],init:function(a,b){var c,d=a.series;a.series=null;c=A(S,a);c.series=a.series=d;this.userOptions=a;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;
this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=d.showAxes;var f=this,g;f.index=Y.length;Y.push(f);ab++;d.reflow!==!1&&H(f,"load",function(){f.initReflow()});if(e)for(g in e)H(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=fa?!1:p(d.animation,!0);f.pointCount=f.colorCounter=f.symbolCounter=0;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=M[a.type||b.type||b.defaultSeriesType])||la(17,!0);b=new b;b.init(this,
a);return b},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.hasCartesianSeries,j=this.isDirtyBox,k=c.length,m=k,l=this.renderer,n=l.isHidden(),q=[];Qa(a,this);n&&this.cloneRenderTo();for(this.layOutTitles();m--;)if(a=c[m],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(m=k;m--;)if(a=c[m],a.options.stacking)a.isDirty=!0;
o(c,function(a){a.isDirty&&a.options.legendType==="point"&&(a.updateTotals&&a.updateTotals(),f=!0)});if(f&&e.options.enabled)e.render(),this.isDirtyLegend=!1;g&&this.getStacks();if(i&&!this.isResizing)this.maxTicks=null,o(b,function(a){a.setScale()});this.getMargins();i&&(o(b,function(a){a.isDirty&&(j=!0)}),o(b,function(a){var b=a.min+","+a.max;if(a.extKey!==b)a.extKey=b,q.push(function(){I(a,"afterSetExtremes",r(a.eventArgs,a.getExtremes()));delete a.eventArgs});(j||g)&&a.redraw()}));j&&this.drawChartBox();
o(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset(!0);l.draw();I(this,"redraw");n&&this.cloneRenderTo(!0);o(q,function(a){a.call()})},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=ra(b.xAxis||
{}),b=b.yAxis=ra(b.yAxis||{});o(c,function(a,b){a.index=b;a.isX=!0});o(b,function(a,b){a.index=b});c=c.concat(b);o(c,function(b){new ha(a,b)})},getSelectedPoints:function(){var a=[];o(this.series,function(b){a=a.concat(ib(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return ib(this.series,function(a){return a.selected})},setTitle:function(a,b,c){var g;var d=this,e=d.options,f;f=e.title=A(e.title,a);g=e.subtitle=A(e.subtitle,b),e=g;o([["title",a,f],["subtitle",
b,e]],function(a){var b=a[0],c=d[b],e=a[1],a=a[2];c&&e&&(d[b]=c=c.destroy());a&&a.text&&!c&&(d[b]=d.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});d.layOutTitles(c)},layOutTitles:function(a){var b=0,c=this.title,d=this.subtitle,e=this.options,f=e.title,e=e.subtitle,g=this.renderer,h=this.spacingBox.width-44;if(c&&(c.css({width:(f.width||h)+"px"}).align(r({y:g.fontMetrics(f.style.fontSize,c).b-3},f),!1,"spacingBox"),!f.floating&&
!f.verticalAlign))b=c.getBBox().height;d&&(d.css({width:(e.width||h)+"px"}).align(r({y:b+(f.margin-13)+g.fontMetrics(f.style.fontSize,d).b},e),!1,"spacingBox"),!e.floating&&!e.verticalAlign&&(b=sa(b+d.getBBox().height)));c=this.titleOffset!==b;this.titleOffset=b;if(!this.isDirtyBox&&c)this.isDirtyBox=c,this.hasRendered&&p(a,!0)&&this.isDirtyBox&&this.redraw()},getChartSize:function(){var a=this.options.chart,b=a.width,a=a.height,c=this.renderToClone||this.renderTo;if(!s(b))this.containerWidth=hb(c,
"width");if(!s(a))this.containerHeight=hb(c,"height");this.chartWidth=t(0,b||this.containerWidth||600);this.chartHeight=t(0,p(a,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Pa(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),L(b,{position:"absolute",top:"-9999px",display:"block"}),b.style.setProperty&&
b.style.setProperty("display","block","important"),C.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options.chart,c,d,e;this.renderTo=a=b.renderTo;e="highcharts-"+wb++;if(Aa(a))this.renderTo=a=C.getElementById(a);a||la(13,!0);c=F(J(a,"data-highcharts-chart"));!isNaN(c)&&Y[c]&&Y[c].hasRendered&&Y[c].destroy();J(a,"data-highcharts-chart",this.index);a.innerHTML="";!b.skipClone&&!a.offsetWidth&&this.cloneRenderTo();this.getChartSize();c=this.chartWidth;d=this.chartHeight;
this.container=a=$(Ia,{className:"highcharts-container"+(b.className?" "+b.className:""),id:e},r({position:"relative",overflow:"hidden",width:c+"px",height:d+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},b.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=b.forExport?new ua(a,c,d,b.style,!0):new Za(a,c,d,b.style);fa&&this.renderer.create(this,a,c,d);this.renderer.chartIndex=this.index},getMargins:function(a){var b=this.spacing,
c=this.margin,d=this.titleOffset;this.resetMargins();if(d&&!s(c[0]))this.plotTop=t(this.plotTop,d+this.options.title.margin+b[0]);this.legend.adjustMargins(c,b);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);a||this.getAxisMargins()},getAxisMargins:function(){var a=this,b=a.axisOffset=[0,0,0,0],c=a.margin;a.hasCartesianSeries&&o(a.axes,function(a){a.getOffset()});o(gb,function(d,e){s(c[e])||(a[d]+=b[e])});a.setChartSize()},
reflow:function(a){var b=this,c=b.options.chart,d=b.renderTo,e=c.width||hb(d,"width"),f=c.height||hb(d,"height"),c=a?a.target:K,d=function(){if(b.container)b.setSize(e,f,!1),b.hasUserSize=null};if(!b.hasUserSize&&!b.isPrinting&&e&&f&&(c===K||c===C)){if(e!==b.containerWidth||f!==b.containerHeight)clearTimeout(b.reflowTimeout),a?b.reflowTimeout=setTimeout(d,100):d();b.containerWidth=e;b.containerHeight=f}},initReflow:function(){var a=this,b=function(b){a.reflow(b)};H(K,"resize",b);H(a,"destroy",function(){Z(K,
"resize",b)})},setSize:function(a,b,c){var d=this,e,f,g,h=d.renderer,i=h.globalAnimation;d.isResizing+=1;g=function(){d&&I(d,"endResize",null,function(){d.isResizing-=1})};Qa(c,d);d.oldChartHeight=d.chartHeight;d.oldChartWidth=d.chartWidth;if(s(a))d.chartWidth=e=t(0,w(a)),d.hasUserSize=!!e;if(s(b))d.chartHeight=f=t(0,w(b));(i?jb:L)(d.container,{width:e+"px",height:f+"px"},i);d.setChartSize(!0);h.setSize(e,f,c);d.maxTicks=null;o(d.axes,function(a){a.isDirty=!0;a.setScale()});o(d.series,function(a){a.isDirty=
!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.layOutTitles();d.getMargins();d.redraw(c);d.oldChartHeight=null;I(d,"resize");i===!1?g():setTimeout(g,i&&i.duration||500)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,m;this.plotLeft=i=w(this.plotLeft);this.plotTop=j=w(this.plotTop);this.plotWidth=k=t(0,w(d-i-this.marginRight));this.plotHeight=m=t(0,w(e-j-this.marginBottom));this.plotSizeX=b?m:
k;this.plotSizeY=b?k:m;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};this.plotBox=c.plotBox={x:i,y:j,width:k,height:m};d=2*V(this.plotBorderWidth/2);b=sa(t(d,h[3])/2);c=sa(t(d,h[0])/2);this.clipBox={x:b,y:c,width:V(this.plotSizeX-t(d,h[1])/2-b),height:t(0,V(this.plotSizeY-t(d,h[2])/2-c))};a||o(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this;o(gb,function(b,c){a[b]=p(a.margin[c],
a.spacing[c])});a.axisOffset=[0,0,0,0];a.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,m=a.plotBackgroundImage,l=a.plotBorderWidth||0,n,q=this.plotLeft,p=this.plotTop,o=this.plotWidth,t=this.plotHeight,u=this.plotBox,s=this.clipRect,r=this.clipBox;n=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp({width:c-
n,height:d-n}));else{e={fill:j||O};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(n/2,n/2,c-n,d-n,a.borderRadius,i).attr(e).addClass("highcharts-background").add().shadow(a.shadow)}if(k)f?f.animate(u):this.plotBackground=b.rect(q,p,o,t,0).attr({fill:k}).add().shadow(a.plotShadow);if(m)h?h.animate(u):this.plotBGImage=b.image(m,q,p,o,t).add();s?s.animate({width:r.width,height:r.height}):this.clipRect=b.clipRect(r);if(l)g?g.animate(g.crisp({x:q,y:p,width:o,height:t,strokeWidth:-l})):
this.plotBorder=b.rect(q,p,o,t,0,-l).attr({stroke:a.plotBorderColor,"stroke-width":l,fill:O,zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;o(["inverted","angular","polar"],function(g){c=M[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=M[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;o(b,function(a){a.linkedSeries.length=0});o(b,function(b){var d=
b.options.linkedTo;if(Aa(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),b.linkedParent=d,b.visible=p(b.options.visible,d.options.visible,b.visible)})},renderSeries:function(){o(this.series,function(a){a.translate();a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&o(b.items,function(c){var d=r(b.style,c.style),e=F(d.left)+a.plotLeft,f=F(d.top)+a.plotTop+12;delete d.left;delete d.top;a.renderer.text(c.html,e,f).attr({zIndex:2}).css(d).add()})},
render:function(){var a=this.axes,b=this.renderer,c=this.options,d,e,f,g;this.setTitle();this.legend=new lb(this,c.legend);this.getStacks&&this.getStacks();this.getMargins(!0);this.setChartSize();d=this.plotWidth;e=this.plotHeight-=13;o(a,function(a){a.setScale()});this.getAxisMargins();f=d/this.plotWidth>1.1;g=e/this.plotHeight>1.1;if(f||g)this.maxTicks=null,o(a,function(a){(a.horiz&&f||!a.horiz&&g)&&a.setTickInterval(!0)}),this.getMargins();this.drawChartBox();this.hasCartesianSeries&&o(a,function(a){a.render()});
if(!this.seriesGroup)this.seriesGroup=b.g("series-group").attr({zIndex:3}).add();this.renderSeries();this.renderLabels();this.showCredits(c.credits);this.hasRendered=!0},showCredits:function(a){if(a.enabled&&!this.credits)this.credits=this.renderer.text(a.text,0,0).on("click",function(){if(a.href)location.href=a.href}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position)},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;I(a,"destroy");Y[a.index]=
v;ab--;a.renderTo.removeAttribute("data-highcharts-chart");Z(a);for(e=b.length;e--;)b[e]=b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();o("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",Z(d),f&&Pa(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!ca&&K==K.top&&
C.readyState!=="complete"||fa&&!K.canvg?(fa?Lb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):C.attachEvent("onreadystatechange",function(){C.detachEvent("onreadystatechange",a.firstRender);C.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options,c=a.callback;if(a.isReadyToRender()){a.getContainer();I(a,"init");a.resetMargins();a.setChartSize();a.propFromSeries();a.getAxes();o(b.series||[],function(b){a.initSeries(b)});a.linkSeries();I(a,
"beforeRender");if(B.Pointer)a.pointer=new Ua(a,b);a.render();a.renderer.draw();c&&c.apply(a,[a]);o(a.callbacks,function(b){a.index!==v&&b.apply(a,[a])});I(a,"load");a.cloneRenderTo(!0)}},splashArray:function(a,b){var c=b[a],c=da(c)?c:[c,c,c,c];return[p(b[a+"Top"],c[0]),p(b[a+"Right"],c[1]),p(b[a+"Bottom"],c[2]),p(b[a+"Left"],c[3])]}};var Xb=B.CenteredSeriesMixin={getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d=b.plotWidth-2*c,b=b.plotHeight-2*c,e=a.center,e=[p(e[0],
"50%"),p(e[1],"50%"),a.size||"100%",a.innerSize||0],f=z(d,b),g,h;for(g=0;g<4;++g)h=e[g],a=g<2||g===2&&/%$/.test(h),e[g]=(/%$/.test(h)?[d,b,f,e[2]][g]*parseFloat(h)/100:parseFloat(h))+(a?c:0);return e}},Ea=function(){};Ea.prototype={init:function(a,b,c){this.series=a;this.color=a.color;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;
return this},applyOptions:function(a,b){var c=this.series,d=c.options.pointValKey||c.pointValKey,a=Ea.prototype.optionsToObject.call(this,a);r(this,a);this.options=this.options?r(this.options,a):a;if(d)this.y=this[d];if(this.x===v&&c)this.x=b===v?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.options.keys,e=d||c.pointArrayMap||["y"],f=e.length,g=0,h=0;if(typeof a==="number"||a===null)b[e[0]]=a;else if(Fa(a)){if(!d&&a.length>f){c=typeof a[0];if(c==="string")b.name=
a[0];else if(c==="number")b.x=a[0];g++}for(;h<f;)b[e[h++]]=a[g++]}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),ja(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)Z(this),this.destroyElements();this.legendItem&&a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a=
"graphic,dataLabel,dataLabelUpper,group,connector,shadowGroup".split(","),b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=p(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";o(b.pointArrayMap||["y"],function(b){b="{point."+
b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return Ha(a,{point:this,series:this.series})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select&&d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});I(this,a,b,c)}};var R=B.Series=function(){};R.prototype={isCartesian:!0,type:"line",pointClass:Ea,sorted:!0,requireSorting:!0,
pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(a,b){var c=this,d,e,f=a.series,g=function(a,b){return p(a.options.index,a._i)-p(b.options.index,b._i)};c.chart=a;c.options=b=c.setOptions(b);c.linkedSeries=[];c.bindAxes();r(c,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0});if(fa)b.animation=!1;e=b.events;for(d in e)H(c,d,e[d]);if(e&&e.click||
b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;c.getColor();c.getSymbol();o(c.parallelArrays,function(a){c[a+"Data"]=[]});c.setData(b.data,!1);if(c.isCartesian)a.hasCartesianSeries=!0;f.push(c);c._i=f.length-1;pb(f,g);this.yAxis&&pb(this.yAxis.series,g);o(f,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;o(a.axisTypes||[],function(e){o(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==v&&
b[e]===d.id||b[e]===v&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});!a[e]&&a.optionalAxis!==e&&la(18,!0)})},updateParallelArrays:function(a,b){var c=a.series,d=arguments;o(c.parallelArrays,typeof b==="number"?function(d){var f=d==="y"&&c.toYData?c.toYData(a):a[d];c[d+"Data"][b]=f}:function(a){Array.prototype[b].apply(c[a+"Data"],Array.prototype.slice.call(d,2))})},autoIncrement:function(){var a=this.options,b=this.xIncrement,c,d=a.pointIntervalUnit,b=p(b,a.pointStart,0);this.pointInterval=c=
p(this.pointInterval,a.pointInterval,1);if(d==="month"||d==="year")a=new ya(b),a=d==="month"?+a[ub](a[Xa]()+c):+a[vb](a[Ya]()+c),c=a-b;this.xIncrement=b+c;return b},getSegments:function(){var a=-1,b=[],c,d=this.points,e=d.length;if(e)if(this.options.connectNulls){for(c=e;c--;)d[c].y===null&&d.splice(c,1);d.length&&(b=[d])}else o(d,function(c,g){c.y===null?(g>a+1&&b.push(d.slice(a+1,g)),a=g):g===e-1&&b.push(d.slice(a+1,g+1))});this.segments=b},setOptions:function(a){var b=this.chart,c=b.options.plotOptions,
b=b.userOptions||{},d=b.plotOptions||{},e=c[this.type];this.userOptions=a;c=A(e,c.series,a);this.tooltipOptions=A(S.tooltip,S.plotOptions[this.type].tooltip,b.tooltip,d.series&&d.series.tooltip,d[this.type]&&d[this.type].tooltip,a.tooltip);e.marker===null&&delete c.marker;this.zoneAxis=c.zoneAxis;a=this.zones=(c.zones||[]).slice();if((c.negativeColor||c.negativeFillColor)&&!c.zones)a.push({value:c[this.zoneAxis+"Threshold"]||c.threshold||0,color:c.negativeColor,fillColor:c.negativeFillColor});a.length&&
s(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor});return c},getCyclic:function(a,b,c){var d=this.userOptions,e="_"+a+"Index",f=a+"Counter";b||(s(d[e])?b=d[e]:(d[e]=b=this.chart[f]%c.length,this.chart[f]+=1),b=c[b]);this[a]=b},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||ba[this.type].color,this.chart.options.colors)},getSymbol:function(){var a=this.options.marker;this.getCyclic("symbol",a.symbol,this.chart.options.symbols);
if(/^url/.test(this.symbol))a.radius=0},drawLegendSymbol:La.drawLineMarker,setData:function(a,b,c,d){var e=this,f=e.points,g=f&&f.length||0,h,i=e.options,j=e.chart,k=null,m=e.xAxis,l=m&&!!m.categories,n=i.turboThreshold,q=this.xData,x=this.yData,t=(h=e.pointArrayMap)&&h.length,a=a||[];h=a.length;b=p(b,!0);if(d!==!1&&h&&g===h&&!e.cropped&&!e.hasGroupedData&&e.visible)o(a,function(a,b){f[b].update&&f[b].update(a,!1,null,!1)});else{e.xIncrement=null;e.pointRange=l?1:i.pointRange;e.colorCounter=0;o(this.parallelArrays,
function(a){e[a+"Data"].length=0});if(n&&h>n){for(c=0;k===null&&c<h;)k=a[c],c++;if(qa(k)){l=p(i.pointStart,0);i=p(i.pointInterval,1);for(c=0;c<h;c++)q[c]=l,x[c]=a[c],l+=i;e.xIncrement=l}else if(Fa(k))if(t)for(c=0;c<h;c++)i=a[c],q[c]=i[0],x[c]=i.slice(1,t+1);else for(c=0;c<h;c++)i=a[c],q[c]=i[0],x[c]=i[1];else la(12)}else for(c=0;c<h;c++)if(a[c]!==v&&(i={series:e},e.pointClass.prototype.applyOptions.apply(i,[a[c]]),e.updateParallelArrays(i,c),l&&s(i.name)))m.names[i.x]=i.name;Aa(x[0])&&la(14,!0);e.data=
[];e.options.data=a;for(c=g;c--;)f[c]&&f[c].destroy&&f[c].destroy();if(m)m.minRange=m.userMinRange;e.isDirty=e.isDirtyData=j.isDirtyBox=!0;c=!1}b&&j.redraw(c)},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i,j=this.options;i=j.cropThreshold;var k=this.isCartesian,m,l;if(k&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(h)a=h.getExtremes(),m=a.min,l=a.max;if(k&&this.sorted&&(!i||d>i||this.forceCrop))if(b[d-1]<m||b[0]>l)b=[],c=[];else if(b[0]<
m||b[d-1]>l)e=this.cropData(this.xData,this.yData,m,l),b=e.xData,c=e.yData,e=e.start,f=!0;for(i=b.length-1;i>=0;i--)d=b[i]-b[i-1],d>0&&(g===v||d<g)?g=d:d<0&&this.requireSorting&&la(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;if(j.pointRange===null)this.pointRange=g||1;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=p(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=t(0,i-h);break}for(;i<e;i++)if(a[i]>d){g=i+h;break}return{xData:a.slice(f,
g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,m=[],l;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(l=0;l<g;l++)i=h+l,j?m[l]=(new f).init(this,[d[l]].concat(ra(e[l]))):(b[i]?k=b[i]:a[i]!==v&&(b[i]=k=(new f).init(this,a[i],d[l])),m[l]=k),m[l].index=i;if(b&&(g!==(c=b.length)||j))for(l=0;l<c;l++)if(l===h&&!j&&(l+=g),b[l])b[l].destroyElements(),
b[l].plotX=v;this.data=b;this.points=m},getExtremes:function(a){var b=this.yAxis,c=this.processedXData,d,e=[],f=0;d=this.xAxis.getExtremes();var g=d.min,h=d.max,i,j,k,m,a=a||this.stackedYData||this.processedYData;d=a.length;for(m=0;m<d;m++)if(j=c[m],k=a[m],i=k!==null&&k!==v&&(!b.isLog||k.length||k>0),j=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(c[m+1]||j)>=g&&(c[m-1]||j)<=h,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&(e[f++]=k[i]);else e[f++]=k;this.dataMin=Na(e);this.dataMax=
Ca(e)},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||qa(i),k=a.threshold,m=a.startFromThreshold?k:0,l,n,q,o=Number.MAX_VALUE,a=0;a<g;a++){var r=f[a],w=r.x,u=r.y;n=r.low;var y=b&&e.stacks[(this.negStacks&&u<(m?0:k)?"-":"")+this.stackKey];if(e.isLog&&u!==null&&u<=0)r.y=u=null,la(10);r.plotX=l=z(t(-1E5,c.translate(w,
0,0,0,1,i,this.type==="flags")),1E5);if(b&&this.visible&&y&&y[w])y=y[w],u=y.points[this.index+","+a],n=u[0],u=u[1],n===m&&(n=p(k,e.min)),e.isLog&&n<=0&&(n=null),r.total=r.stackTotal=y.total,r.percentage=y.total&&r.y/y.total*100,r.stackY=u,y.setOffset(this.pointXOffset||0,this.barW||0);r.yBottom=s(n)?e.translate(n,0,1,0,1):null;h&&(u=this.modifyValue(u,r));r.plotY=n=typeof u==="number"&&u!==Infinity?z(t(-1E5,e.translate(u,0,1,0,1)),1E5):v;r.isInside=n!==v&&n>=0&&n<=e.len&&l>=0&&l<=c.len;r.clientX=
j?c.translate(w,0,0,0,1):l;r.negative=r.y<(k||0);r.category=d&&d[r.x]!==v?d[r.x]:r.x;a&&(o=z(o,N(l-q)));q=l}this.closestPointRangePx=o;this.getSegments()},setClip:function(a){var b=this.chart,c=b.renderer,d=b.inverted,e=this.clipBox,f=e||b.clipBox,g=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,f.height].join(","),h=b[g],i=b[g+"m"];if(!h){if(a)f.width=0,b[g+"m"]=i=c.clipRect(-99,d?-b.plotLeft:-b.plotTop,99,d?b.chartWidth:b.chartHeight);b[g]=h=c.clipRect(f)}a&&(h.count+=1);if(this.options.clip!==
!1)this.group.clip(a||e?h:b.clipRect),this.markerGroup.clip(i),this.sharedClipKey=g;a||(h.count-=1,h.count<=0&&g&&b[g]&&(e||(b[g]=b[g].destroy()),b[g+"m"]&&(b[g+"m"]=b[g+"m"].destroy())))},animate:function(a){var b=this.chart,c=this.options.animation,d;if(c&&!da(c))c=ba[this.type].animation;a?this.setClip(c):(d=this.sharedClipKey,(a=b[d])&&a.animate({width:b.plotSizeX},c),b[d+"m"]&&b[d+"m"].animate({width:b.plotSizeX+99},c),this.animate=null)},afterAnimate:function(){this.setClip();I(this,"afterAnimate")},
drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,m=this.options.marker,l=this.pointAttr[""],n,q,o,t=this.markerGroup,s=p(m.enabled,this.xAxis.isRadial,this.closestPointRangePx>2*m.radius);if(m.enabled!==!1||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=V(g.plotX),e=g.plotY,k=g.graphic,n=g.marker||{},q=!!g.marker,a=s&&n.enabled===v||n.enabled,o=g.isInside,a&&e!==v&&!isNaN(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""]||l,h=a.r,i=p(n.symbol,this.symbol),j=i.indexOf("url")===
0,k)k[o?"show":"hide"](!0).animate(r({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(o&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h,q?n:m).attr(a).add(t)}else if(k)g.graphic=k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=p(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=ba[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h=a.options.negativeColor;
f={stroke:g,fill:g};var i=a.points||[],j,k,m=[],l=a.pointAttrToOptions;j=a.hasPointSpecificOptions;var n=c.lineColor,q=c.fillColor;k=b.turboThreshold;var p=a.zones,t=a.zoneAxis||"y",w;b.marker?(e.radius=e.radius||c.radius+e.radiusPlus,e.lineWidth=e.lineWidth||c.lineWidth+e.lineWidthPlus):(e.color=e.color||na(e.color||g).brighten(e.brightness).get(),e.negativeColor=e.negativeColor||na(e.negativeColor||h).brighten(e.brightness).get());m[""]=a.convertAttribs(c,f);o(["hover","select"],function(b){m[b]=
a.convertAttribs(d[b],m[""])});a.pointAttr=m;g=i.length;if(!k||g<k||j)for(;g--;){k=i[g];if((c=k.options&&k.options.marker||k.options)&&c.enabled===!1)c.radius=0;if(p.length){j=0;for(f=p[j];k[t]>=f.value;)f=p[++j];if(f.color)k.color=k.fillColor=f.color}j=b.colorByPoint||k.color;if(k.options)for(w in l)s(c[l[w]])&&(j=!0);if(j){c=c||{};j=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker)f.color=f.color||!k.options.color&&e[k.negative&&h?"negativeColor":"color"]||na(k.color).brighten(f.brightness||
e.brightness).get();f={color:k.color};if(!q)f.fillColor=k.color;if(!n)f.lineColor=k.color;c.hasOwnProperty("color")&&!c.color&&delete c.color;j[""]=a.convertAttribs(r(f,c),m[""]);j.hover=a.convertAttribs(d.hover,m.hover,j[""]);j.select=a.convertAttribs(d.select,m.select,j[""])}else j=m;k.pointAttr=j}},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(za),d,e=a.data||[],f,g,h;I(a,"destroy");Z(a);o(a.axisTypes||[],function(b){if(h=a[b])ja(h.series,a),h.isDirty=h.forceRedraw=!0});a.legendItem&&
a.chart.legend.destroyItem(a);for(d=e.length;d--;)(f=e[d])&&f.destroy&&f.destroy();a.points=null;clearTimeout(a.animationTimeout);for(g in a)a[g]instanceof P&&!a[g].survive&&(d=c&&g==="group"?"hide":"destroy",a[g][d]());if(b.hoverSeries===a)b.hoverSeries=null;ja(b.series,a);for(g in a)delete a[g]},getSegmentPath:function(a){var b=this,c=[],d=b.options.step;o(a,function(e,f){var g=e.plotX,h=e.plotY,i;b.getPointSpline?c.push.apply(c,b.getPointSpline(a,e,f)):(c.push(f?"L":"M"),d&&f&&(i=a[f-1],d==="right"?
c.push(i.plotX,h):d==="center"?c.push((i.plotX+g)/2,i.plotY,(i.plotX+g)/2,h):c.push(g,i.plotY)),c.push(e.plotX,e.plotY))});return c},getGraphPath:function(){var a=this,b=[],c,d=[];o(a.segments,function(e){c=a.getSegmentPath(e);e.length>1?b=b.concat(c):d.push(e[0])});a.singlePoints=d;return a.graphPath=b},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color,b.dashStyle]],d=b.lineWidth,e=b.linecap!=="square",f=this.getGraphPath(),g=this.fillGraph&&this.color||O;o(this.zones,
function(d,e){c.push(["zoneGraph"+e,d.color||a.color,d.dashStyle||b.dashStyle])});o(c,function(c,i){var j=c[0],k=a[j];if(k)k.animate({d:f});else if((d||g)&&f.length)k={stroke:c[1],"stroke-width":d,fill:g,zIndex:1},c[2]?k.dashstyle=c[2]:e&&(k["stroke-linecap"]=k["stroke-linejoin"]="round"),a[j]=a.chart.renderer.path(f).attr(k).add(a.group).shadow(i<2&&b.shadow)})},applyZones:function(){var a=this,b=this.chart,c=b.renderer,d=this.zones,e,f,g=this.clips||[],h,i=this.graph,j=this.area,k=t(b.chartWidth,
b.chartHeight),m=this[(this.zoneAxis||"y")+"Axis"],l,n=m.reversed,q=b.inverted,x=m.horiz,r,s,u,y=!1;if(d.length&&(i||j)&&m.min!==v)i&&i.hide(),j&&j.hide(),l=m.getExtremes(),o(d,function(d,o){e=n?x?b.plotWidth:0:x?0:m.toPixels(l.min);e=z(t(p(f,e),0),k);f=z(t(w(m.toPixels(p(d.value,l.max),!0)),0),k);y&&(e=f=m.toPixels(l.max));r=Math.abs(e-f);s=z(e,f);u=t(e,f);if(m.isXAxis){if(h={x:q?u:s,y:0,width:r,height:k},!x)h.x=b.plotHeight-h.x}else if(h={x:0,y:q?u:s,width:k,height:r},x)h.y=b.plotWidth-h.y;b.inverted&&
c.isVML&&(h=m.isXAxis?{x:0,y:n?s:u,height:h.width,width:b.chartWidth}:{x:h.y-b.plotLeft-b.spacingBox.x,y:0,width:h.height,height:b.chartHeight});g[o]?g[o].animate(h):(g[o]=c.clipRect(h),i&&a["zoneGraph"+o].clip(g[o]),j&&a["zoneArea"+o].clip(g[o]));y=d.value>l.max}),this.clips=g},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};o(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)H(c,"resize",a),H(b,"destroy",function(){Z(c,
"resize",a)}),a(),b.invertGroups=a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({visibility:c,zIndex:d||0.1}).add(e));f[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){var a=this.chart,b=this.xAxis,c=this.yAxis;if(a.inverted)b=c,c=this.xAxis;return{translateX:b?b.left:a.plotLeft,translateY:c?c.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this,b=a.chart,c,d=a.options,e=(c=d.animation)&&!!a.animate&&b.renderer.isSVG&&
p(c.duration,500)||0,f=a.visible?"visible":"hidden",g=d.zIndex,h=a.hasRendered,i=b.seriesGroup;c=a.plotGroup("group","series",f,g,i);a.markerGroup=a.plotGroup("markerGroup","markers",f,g,i);e&&a.animate(!0);a.getAttribs();c.inverted=a.isCartesian?b.inverted:!1;a.drawGraph&&(a.drawGraph(),a.applyZones());o(a.points,function(a){a.redraw&&a.redraw()});a.drawDataLabels&&a.drawDataLabels();a.visible&&a.drawPoints();a.drawTracker&&a.options.enableMouseTracking!==!1&&a.drawTracker();b.inverted&&a.invertGroups();
d.clip!==!1&&!a.sharedClipKey&&!h&&c.clip(b.clipRect);e&&a.animate();if(!h)e?a.animationTimeout=setTimeout(function(){a.afterAnimate()},e):a.afterAnimate();a.isDirty=a.isDirtyData=!1;a.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.isDirty,d=this.group,e=this.xAxis,f=this.yAxis;d&&(a.inverted&&d.attr({width:a.plotWidth,height:a.plotHeight}),d.animate({translateX:p(e&&e.left,a.plotLeft),translateY:p(f&&f.top,a.plotTop)}));this.translate();this.render();b&&I(this,"updatedData");
(c||b)&&delete this.kdTree},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(a,b){var c=this.xAxis,d=this.yAxis,e=this.chart.inverted;return this.searchKDTree({clientX:e?c.len-a.chartY+c.pos:a.chartX-c.pos,plotY:e?d.len-a.chartX+d.pos:a.chartY-d.pos},b)},buildKDTree:function(){function a(b,d,g){var h,i;if(i=b&&b.length)return h=c.kdAxisArray[d%g],b.sort(function(a,b){return a[h]-b[h]}),i=Math.floor(i/2),{point:b[i],left:a(b.slice(0,i),d+1,g),right:a(b.slice(i+1),d+1,g)}}function b(){var b=
ib(c.points||[],function(a){return a.y!==null});c.kdTree=a(b,d,d)}var c=this,d=c.kdDimensions;delete c.kdTree;c.options.kdSync?b():setTimeout(b)},searchKDTree:function(a,b){function c(a,b,j,k){var m=b.point,l=d.kdAxisArray[j%k],n,q,p=m;q=s(a[e])&&s(m[e])?Math.pow(a[e]-m[e],2):null;n=s(a[f])&&s(m[f])?Math.pow(a[f]-m[f],2):null;n=(q||0)+(n||0);m.dist=s(n)?Math.sqrt(n):Number.MAX_VALUE;m.distX=s(q)?Math.sqrt(q):Number.MAX_VALUE;l=a[l]-m[l];n=l<0?"left":"right";q=l<0?"right":"left";b[n]&&(n=c(a,b[n],
j+1,k),p=n[g]<p[g]?n:m);b[q]&&Math.sqrt(l*l)<p[g]&&(a=c(a,b[q],j+1,k),p=a[g]<p[g]?a:p);return p}var d=this,e=this.kdAxisArray[0],f=this.kdAxisArray[1],g=b?"distX":"dist";this.kdTree||this.buildKDTree();if(this.kdTree)return c(a,this.kdTree,this.kdDimensions,this.kdDimensions)}};Hb.prototype={destroy:function(){Oa(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?Ha(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,
null,null,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=c.reversed,f=this.isNegative&&!f||!this.isNegative&&f,g=c.translate(c.usePercentage?100:this.total,0,0,0,1),c=c.translate(0),c=N(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e[this.options.crop===
!1||d.isInsidePlot(f.x,f.y)?"show":"hide"](!0)}};D.prototype.getStacks=function(){var a=this;o(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});o(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+p(b.options.stack,"")})};ha.prototype.buildStacks=function(){var a=this.series,b=p(this.options.reversedStacks,!0),c=a.length;if(!this.isXAxis){for(this.usePercentage=!1;c--;)a[b?c:a.length-c-1].setStackedPoints();
if(this.usePercentage)for(c=0;c<a.length;c++)a[c].setPercentStacks()}};ha.prototype.renderStackTotals=function(){var a=this.chart,b=a.renderer,c=this.stacks,d,e,f=this.stackTotalGroup;if(!f)this.stackTotalGroup=f=b.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();f.translate(a.plotLeft,a.plotTop);for(d in c)for(e in a=c[d],a)a[e].render(f)};ha.prototype.resetStacks=function(){var a=this.stacks,b,c;if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].touched<this.stacksTouched?(a[b][c].destroy(),
delete a[b][c]):(a[b][c].total=null,a[b][c].cum=0)};ha.prototype.cleanStacks=function(){var a,b,c;if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}};R.prototype.setStackedPoints=function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.startFromThreshold?f:0,h=e.stack,e=e.stacking,i=this.stackKey,
j="-"+i,k=this.negStacks,m=this.yAxis,l=m.stacks,n=m.oldStacks,q,o,r,s,u,y;m.stacksTouched+=1;for(s=0;s<d;s++){u=a[s];y=b[s];r=this.index+","+s;o=(q=k&&y<(g?0:f))?j:i;l[o]||(l[o]={});if(!l[o][u])n[o]&&n[o][u]?(l[o][u]=n[o][u],l[o][u].total=null):l[o][u]=new Hb(m,m.options.stackLabels,q,u,h);o=l[o][u];o.points[r]=[p(o.cum,g)];o.touched=m.stacksTouched;e==="percent"?(q=q?i:j,k&&l[q]&&l[q][u]?(q=l[q][u],o.total=q.total=t(q.total,o.total)+N(y)||0):o.total=ea(o.total+(N(y)||0))):o.total=ea(o.total+(y||
0));o.cum=p(o.cum,g)+(y||0);o.points[r].push(o.cum);c[s]=o.cum}if(e==="percent")m.usePercentage=!0;this.stackedYData=c;m.oldStacks={}}};R.prototype.setPercentStacks=function(){var a=this,b=a.stackKey,c=a.yAxis.stacks,d=a.processedXData;o([b,"-"+b],function(b){var e;for(var f=d.length,g,h;f--;)if(g=d[f],e=(h=c[b]&&c[b][g])&&h.points[a.index+","+f],g=e)h=h.total?100/h.total:0,g[0]=ea(g[0]*h),g[1]=ea(g[1]*h),a.stackedYData[f]=g[1]})};r(D.prototype,{addSeries:function(a,b,c){var d,e=this;a&&(b=p(b,!0),
I(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options;new ha(this,A(a,{index:this[e].length,isX:b}));f[e]=ra(f[e]||{});f[e].push(a);p(c,!0)&&this.redraw(d)},showLoading:function(a){var b=this,c=b.options,d=b.loadingDiv,e=c.loading,f=function(){d&&L(d,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};if(!d)b.loadingDiv=d=$(Ia,{className:"highcharts-loading"},
r(e.style,{zIndex:10,display:O}),b.container),b.loadingSpan=$("span",null,e.labelStyle,d),H(b,"redraw",f);b.loadingSpan.innerHTML=a||c.lang.loading;if(!b.loadingShown)L(d,{opacity:0,display:""}),jb(d,{opacity:e.style.opacity},{duration:e.showDuration||0}),b.loadingShown=!0;f()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&jb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){L(b,{display:O})}});this.loadingShown=!1}});r(Ea.prototype,{update:function(a,b,c,d){function e(){f.applyOptions(a);
if(f.y===null&&h)f.graphic=h.destroy();if(da(a)&&!Fa(a))f.redraw=function(){if(h&&h.element&&a&&a.marker&&a.marker.symbol)f.graphic=h.destroy();if(a&&a.dataLabels&&f.dataLabel)f.dataLabel=f.dataLabel.destroy();f.redraw=null};i=f.index;g.updateParallelArrays(f,i);if(m&&f.name)m[f.x]=f.name;k.data[i]=f.options;g.isDirty=g.isDirtyData=!0;if(!g.fixedBox&&g.hasCartesianSeries)j.isDirtyBox=!0;if(k.legendType==="point")j.isDirtyLegend=!0;b&&j.redraw(c)}var f=this,g=f.series,h=f.graphic,i,j=g.chart,k=g.options,
m=g.xAxis&&g.xAxis.names,b=p(b,!0);d===!1?e():f.firePointEvent("update",{options:a},e)},remove:function(a,b){this.series.removePoint(Ka(this,this.series.data),a,b)}});r(R.prototype,{addPoint:function(a,b,c,d){var e=this,f=e.options,g=e.data,h=e.graph,i=e.area,j=e.chart,k=e.xAxis&&e.xAxis.names,m=h&&h.shift||0,l=["graph","area"],h=f.data,n,q=e.xData;Qa(d,j);if(c){for(d=e.zones.length;d--;)l.push("zoneGraph"+d,"zoneArea"+d);o(l,function(a){if(e[a])e[a].shift=m+1})}if(i)i.isArea=!0;b=p(b,!0);i={series:e};
e.pointClass.prototype.applyOptions.apply(i,[a]);l=i.x;d=q.length;if(e.requireSorting&&l<q[d-1])for(n=!0;d&&q[d-1]>l;)d--;e.updateParallelArrays(i,"splice",d,0,0);e.updateParallelArrays(i,d);if(k&&i.name)k[l]=i.name;h.splice(d,0,a);n&&(e.data.splice(d,0,null),e.processData());f.legendType==="point"&&e.generatePoints();c&&(g[0]&&g[0].remove?g[0].remove(!1):(g.shift(),e.updateParallelArrays(i,"shift"),h.shift()));e.isDirty=!0;e.isDirtyData=!0;b&&(e.getAttribs(),j.redraw())},removePoint:function(a,b,
c){var d=this,e=d.data,f=e[a],g=d.points,h=d.chart,i=function(){e.length===g.length&&g.splice(a,1);e.splice(a,1);d.options.data.splice(a,1);d.updateParallelArrays(f||{series:d},"splice",a,1);f&&f.destroy();d.isDirty=!0;d.isDirtyData=!0;b&&h.redraw()};Qa(c,h);b=p(b,!0);f?f.firePointEvent("remove",null,i):i()},remove:function(a,b){var c=this,d=c.chart,a=p(a,!0);if(!c.isRemoving)c.isRemoving=!0,I(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();a&&d.redraw(b)});c.isRemoving=
!1},update:function(a,b){var c=this,d=this.chart,e=this.userOptions,f=this.type,g=M[f].prototype,h=["group","markerGroup","dataLabelsGroup"],i;if(a.type&&a.type!==f||a.zIndex!==void 0)h.length=0;o(h,function(a){h[a]=c[a];delete c[a]});a=A(e,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(i in g)this[i]=v;r(this,M[a.type||f].prototype);o(h,function(a){c[a]=h[a]});this.init(d,a);d.linkSeries();p(b,!0)&&d.redraw(!1)}});r(ha.prototype,{update:function(a,
b){var c=this.chart,a=c.options[this.coll][this.options.index]=A(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.chart._labelPanes=v;this.init(c,r(a,{events:v}));c.isDirtyBox=!0;p(b,!0)&&c.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,d=this.series,e=d.length;e--;)d[e]&&d[e].remove(!1);ja(b.axes,this);ja(b[c],this);b.options[c].splice(this.options.index,1);o(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;p(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},
b)},setCategories:function(a,b){this.update({categories:a},b)}});var wa=ka(R);M.line=wa;ba.area=A(U,{threshold:0});var pa=ka(R,{type:"area",getSegments:function(){var a=this,b=[],c=[],d=[],e=this.xAxis,f=this.yAxis,g=f.stacks[this.stackKey],h={},i,j,k=this.points,m=this.options.connectNulls,l,n;if(this.options.stacking&&!this.cropped){for(l=0;l<k.length;l++)h[k[l].x]=k[l];for(n in g)g[n].total!==null&&d.push(+n);d.sort(function(a,b){return a-b});o(d,function(b){var d=0,k;if(!m||h[b]&&h[b].y!==null)if(h[b])c.push(h[b]);
else{for(l=a.index;l<=f.series.length;l++)if(k=g[b].points[l+","+b]){d=k[1];break}i=e.translate(b);j=f.toPixels(d,!0);c.push({y:null,plotX:i,clientX:i,plotY:j,yBottom:j,onMouseOver:ta})}});c.length&&b.push(c)}else R.prototype.getSegments.call(this),b=this.segments;this.segments=b},getSegmentPath:function(a){var b=R.prototype.getSegmentPath.call(this,a),c=[].concat(b),d,e=this.options;d=b.length;var f=this.yAxis.getThreshold(e.threshold),g;d===3&&c.push("L",b[1],b[2]);if(e.stacking&&!this.closedStacks)for(d=
a.length-1;d>=0;d--)g=p(a[d].yBottom,f),d<a.length-1&&e.step&&c.push(a[d+1].plotX,g),c.push(a[d].plotX,g);else this.closeSegment(c,a,f);this.areaPath=this.areaPath.concat(c);return b},closeSegment:function(a,b,c){a.push("L",b[b.length-1].plotX,c,"L",b[0].plotX,c)},drawGraph:function(){this.areaPath=[];R.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=[["area",this.color,c.fillColor]];o(this.zones,function(b,f){d.push(["zoneArea"+f,b.color||a.color,b.fillColor||c.fillColor])});
o(d,function(d){var f=d[0],g=a[f];g?g.animate({d:b}):a[f]=a.chart.renderer.path(b).attr({fill:p(d[2],na(d[1]).setOpacity(p(c.fillOpacity,0.75)).get()),zIndex:0}).add(a.group)})},drawLegendSymbol:La.drawRectangle});M.area=pa;ba.spline=A(U);wa=ka(R,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],h,i,j,k;if(f&&g){a=f.plotY;j=g.plotX;var g=g.plotY,m;h=(1.5*d+f.plotX)/2.5;i=(1.5*e+a)/2.5;j=(1.5*d+j)/2.5;k=(1.5*e+g)/2.5;m=(k-i)*(j-d)/(j-h)+e-k;i+=m;k+=m;i>a&&i>e?
(i=t(a,e),k=2*e-i):i<a&&i<e&&(i=z(a,e),k=2*e-i);k>g&&k>e?(k=t(g,e),i=2*e-k):k<g&&k<e&&(k=z(g,e),i=2*e-k);b.rightContX=j;b.rightContY=k}c?(b=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,h||d,i||e,d,e],f.rightContX=f.rightContY=null):b=["M",d,e];return b}});M.spline=wa;ba.areaspline=A(ba.area);pa=pa.prototype;wa=ka(wa,{type:"areaspline",closedStacks:!0,getSegmentPath:pa.getSegmentPath,closeSegment:pa.closeSegment,drawGraph:pa.drawGraph,drawLegendSymbol:La.drawRectangle});M.areaspline=wa;ba.column=
A(U,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0});wa=ka(R,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,directTouch:!0,trackerGroups:["group",
"dataLabelsGroup"],negStacks:!0,init:function(){R.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&o(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h,i=0;b.grouping===!1?i=1:o(a.chart.series,function(b){var c=b.options,e=b.yAxis;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===v&&(g[f]=i++),h=g[f]):c.grouping!==!1&&(h=i++),b.columnIndex=
h});var j=z(N(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||c.tickInterval||1),c.len),k=j*b.groupPadding,m=(j-2*k)/i,b=z(b.maxPointWidth||c.len,p(b.pointWidth,m*(1-2*b.pointPadding)));return a.columnMetrics={width:b,offset:(m-b)/2+(k+((e?i-(a.columnIndex||0):a.columnIndex)||0)*m-j/2)*(e?-1:1)}},translate:function(){var a=this,b=a.chart,c=a.options,d=a.borderWidth=p(c.borderWidth,a.closestPointRange*a.xAxis.transA<2?0:1),e=a.yAxis,f=a.translatedThreshold=e.getThreshold(c.threshold),
g=p(c.minPointLength,5),h=a.getColumnMetrics(),i=h.width,j=a.barW=t(i,1+2*d),k=a.pointXOffset=h.offset,m=-(d%2?0.5:0),l=d%2?0.5:1;b.inverted&&(f-=0.5,b.renderer.isVML&&(l+=1));c.pointPadding&&(j=sa(j));R.prototype.translate.apply(a);o(a.points,function(c){var d=p(c.yBottom,f),h=999+N(d),h=z(t(-h,c.plotY),e.len+h),o=c.plotX+k,r=j,s=z(h,d),y,v;y=t(h,d)-s;N(y)<g&&g&&(y=g,v=!e.reversed&&!c.negative||e.reversed&&c.negative,s=w(N(s-f)>g?d-g:f-(v?g:0)));c.barX=o;c.pointWidth=i;r=w(o+r)+m;o=w(o)+m;r-=o;d=
N(s)<0.5;y=z(w(s+y)+l,9E4);s=w(s)+l;y-=s;d&&(s-=1,y+=1);c.tooltipPos=b.inverted?[e.len+e.pos-b.plotLeft-h,a.xAxis.len-o-r/2,y]:[o+r/2,h+e.pos-b.plotTop,y];c.shapeType="rect";c.shapeArgs={x:o,y:s,width:r,height:y}})},getSymbol:ta,drawLegendSymbol:La.drawRectangle,drawGraph:ta,drawPoints:function(){var a=this,b=this.chart,c=a.options,d=b.renderer,e=c.animationLimit||250,f,g;o(a.points,function(h){var i=h.plotY,j=h.graphic;if(i!==v&&!isNaN(i)&&h.y!==null)f=h.shapeArgs,i=s(a.borderWidth)?{"stroke-width":a.borderWidth}:
{},g=h.pointAttr[h.selected?"select":""]||a.pointAttr[""],j?(kb(j),j.attr(i)[b.pointCount<e?"animate":"attr"](A(f))):h.graphic=d[h.shapeType](f).attr(i).attr(g).add(a.group).shadow(c.shadow,null,c.stacking&&!c.borderRadius);else if(j)h.graphic=j.destroy()})},animate:function(a){var b=this.yAxis,c=this.options,d=this.chart.inverted,e={};if(ca)a?(e.scaleY=0.001,a=z(b.pos+b.len,t(b.pos,b.toPixels(c.threshold))),d?e.translateX=a-b.len:e.translateY=a,this.group.attr(e)):(e.scaleY=1,e[d?"translateX":"translateY"]=
b.pos,this.group.animate(e,this.options.animation),this.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&o(b.series,function(b){if(b.type===a.type)b.isDirty=!0});R.prototype.remove.apply(a,arguments)}});M.column=wa;ba.bar=A(ba.column);pa=ka(wa,{type:"bar",inverted:!0});M.bar=pa;ba.scatter=A(U,{lineWidth:0,marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25cf</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});
pa=ka(R,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,kdDimensions:2,drawGraph:function(){this.options.lineWidth&&R.prototype.drawGraph.call(this)}});M.scatter=pa;ba.pie=A(U,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.y===null?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,
size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});U={type:"pie",isCartesian:!1,pointClass:ka(Ea,{init:function(){Ea.prototype.init.apply(this,arguments);var a=this,b;r(a,{visible:a.visible!==!1,name:p(a.name,"Slice")});b=function(b){a.slice(b.type==="select")};H(a,"select",b);H(a,"unselect",b);return a},setVisible:function(a,b){var c=this,d=c.series,e=d.chart,f=d.options.ignoreHiddenPoint,b=p(b,f);if(a!==c.visible){c.visible=
c.options.visible=a=a===v?!c.visible:a;d.options.data[Ka(c,d.data)]=c.options;o(["graphic","dataLabel","connector","shadowGroup"],function(b){if(c[b])c[b][a?"show":"hide"](!0)});c.legendItem&&e.legend.colorizeItem(c,a);!a&&c.state==="hover"&&c.setState("");if(f)d.isDirty=!0;b&&e.redraw()}},slice:function(a,b,c){var d=this.series;Qa(c,d.chart);p(b,!0);this.sliced=this.options.sliced=a=s(a)?a:!this.sliced;d.options.data[Ka(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};
this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)},haloPath:function(a){var b=this.shapeArgs,c=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.plotLeft+b.x,c.plotTop+b.y,b.r+a,b.r+a,{innerR:this.shapeArgs.r,start:b.start,end:b.end})}}),requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},animate:function(a){var b=
this,c=b.points,d=b.startAngleRad;if(!a)o(c,function(a){var c=a.graphic,g=a.shapeArgs;c&&(c.attr({r:a.startR||b.center[3]/2,start:d,end:d}),c.animate({r:g.r,start:g.start,end:g.end},b.options.animation))}),b.animate=null},setData:function(a,b,c,d){R.prototype.setData.call(this,a,!1,c,d);this.processData();this.generatePoints();p(b,!0)&&this.chart.redraw(c)},updateTotals:function(){var a,b=0,c=this.points,d=c.length,e,f=this.options.ignoreHiddenPoint;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=
b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0&&(e.visible||!f)?e.y/b*100:0,e.total=b},generatePoints:function(){R.prototype.generatePoints.call(this);this.updateTotals()},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=ma/180*(i-90),i=(this.endAngleRad=ma/180*(p(c.endAngle,i+360)-90))-j,k=this.points,m=c.dataLabels.distance,c=c.ignoreHiddenPoint,l,n=k.length,o;if(!a)this.center=a=this.getCenter();this.getX=
function(b,c){h=W.asin(z((b-a[1])/(a[2]/2+m),1));return a[0]+(c?-1:1)*X(h)*(a[2]/2+m)};for(l=0;l<n;l++){o=k[l];f=j+b*i;if(!c||o.visible)b+=o.percentage/100;g=j+b*i;o.shapeType="arc";o.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:w(f*1E3)/1E3,end:w(g*1E3)/1E3};h=(g+f)/2;h>1.5*ma?h-=2*ma:h<-ma/2&&(h+=2*ma);o.slicedTranslation={translateX:w(X(h)*d),translateY:w(aa(h)*d)};f=X(h)*a[2]/2;g=aa(h)*a[2]/2;o.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];o.half=h<-ma/2||h>ma/2?1:0;o.angle=h;e=z(e,m/2);o.labelPos=
[a[0]+f+X(h)*m,a[1]+g+aa(h)*m,a[0]+f+X(h)*e,a[1]+g+aa(h)*e,a[0]+f,a[1]+g,m<0?"center":o.half?"right":"left",h]}},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g,h;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);o(a.points,function(i){if(i.y!==null){d=i.graphic;g=i.shapeArgs;f=i.shadowGroup;if(e&&!f)f=i.shadowGroup=b.g("shadow").add(a.shadowGroup);c=i.sliced?i.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);if(d)d.animate(r(g,c));
else{h={"stroke-linejoin":"round"};if(!i.visible)h.visibility="hidden";i.graphic=d=b[i.shapeType](g).setRadialReference(a.center).attr(i.pointAttr[i.selected?"select":""]).attr(h).attr(c).add(a.group).shadow(e,f)}}})},searchPoint:ta,sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==void 0&&(d.angle-a.angle)*b})},drawLegendSymbol:La.drawRectangle,getCenter:Xb.getCenter,getSymbol:ta};U=ka(R,U);M.pie=U;R.prototype.drawDataLabels=function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,
e=a.points,f,g,h=a.hasRendered||0,i,j,k=a.chart.renderer;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),j=a.plotGroup("dataLabelsGroup","data-labels",d.defer?"hidden":"visible",d.zIndex||6),p(d.defer,!0)&&(j.attr({opacity:+h}),h||H(a,"afterAnimate",function(){a.visible&&j.show();j[b.animation?"animate":"attr"]({opacity:1},{duration:200})})),g=d,o(e,function(e){var h,n=e.dataLabel,o,t,w=e.connector,z=!0,u,y={};f=e.dlOptions||e.options&&e.options.dataLabels;h=p(f&&f.enabled,
g.enabled);if(n&&!h)e.dataLabel=n.destroy();else if(h){d=A(g,f);u=d.style;h=d.rotation;o=e.getLabelConfig();i=d.format?Ha(d.format,o):d.formatter.call(o,d);u.color=p(d.color,u.color,a.color,"black");if(n)if(s(i))n.attr({text:i}),z=!1;else{if(e.dataLabel=n=n.destroy(),w)e.connector=w.destroy()}else if(s(i)){n={fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:h,padding:d.padding,zIndex:1};if(u.color==="contrast")y.color=d.inside||d.distance<0||b.stacking?
k.getContrast(e.color||a.color):"#000000";if(c)y.cursor=c;for(t in n)n[t]===v&&delete n[t];n=e.dataLabel=k[h?"text":"label"](i,0,-999,d.shape,null,null,d.useHTML).attr(n).css(r(u,y)).add(j).shadow(d.shadow)}n&&a.alignDataLabel(e,n,d,null,z)}})};R.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=p(a.plotX,-999),i=p(a.plotY,-999),j=b.getBBox(),k=f.renderer.fontMetrics(c.style.fontSize).b,m=this.visible&&(a.series.forceDL||f.isInsidePlot(h,w(i),g)||d&&f.isInsidePlot(h,g?d.x+
1:d.y+d.height-1,g));if(m)d=r({x:g?f.plotWidth-i:h,y:w(g?f.plotHeight-h:i),width:0,height:0},d),r(c,{width:j.width,height:j.height}),c.rotation?(a=f.renderer.rotCorr(k,c.rotation),b[e?"attr":"animate"]({x:d.x+c.x+d.width/2+a.x,y:d.y+c.y+d.height/2}).attr({align:c.align})):(b.align(c,null,d),g=b.alignAttr,p(c.overflow,"justify")==="justify"?this.justifyDataLabel(b,c,g,j,d,e):p(c.crop,!0)&&(m=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)),c.shape&&b.attr({anchorX:a.plotX,anchorY:a.plotY}));
if(!m)b.attr({y:-999}),b.placed=!1};R.prototype.justifyDataLabel=function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,k,m=a.box?0:a.padding||0;j=c.x+m;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width-m;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y+m;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height-m;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)};if(M.pie)M.pie.prototype.drawDataLabels=
function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=p(e.connectorPadding,10),g=p(e.connectorWidth,1),h=d.plotWidth,i=d.plotHeight,j,k,m=p(e.softConnector,!0),l=e.distance,n=a.center,q=n[2]/2,r=n[1],s=l>0,v,u,y,C=[[],[]],A,B,D,F,G,E=[0,0,0,0],L=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){R.prototype.drawDataLabels.apply(a);o(b,function(a){a.dataLabel&&a.visible&&C[a.half].push(a)});for(F=2;F--;){var I=[],M=[],H=C[F],K=H.length,J;if(K){a.sortByAngle(H,
F-0.5);for(G=b=0;!b&&H[G];)b=H[G]&&H[G].dataLabel&&(H[G].dataLabel.getBBox().height||21),G++;if(l>0){u=z(r+q+l,d.plotHeight);for(G=t(0,r-q-l);G<=u;G+=b)I.push(G);u=I.length;if(K>u){c=[].concat(H);c.sort(L);for(G=K;G--;)c[G].rank=G;for(G=K;G--;)H[G].rank>=u&&H.splice(G,1);K=H.length}for(G=0;G<K;G++){c=H[G];y=c.labelPos;c=9999;var P,O;for(O=0;O<u;O++)P=N(I[O]-y[1]),P<c&&(c=P,J=O);if(J<G&&I[G]!==null)J=G;else for(u<K-G+J&&I[G]!==null&&(J=u-K+G);I[J]===null;)J++;M.push({i:J,y:I[J]});I[J]=null}M.sort(L)}for(G=
0;G<K;G++){c=H[G];y=c.labelPos;v=c.dataLabel;D=c.visible===!1?"hidden":"inherit";c=y[1];if(l>0){if(u=M.pop(),J=u.i,B=u.y,c>B&&I[J+1]!==null||c<B&&I[J-1]!==null)B=z(t(0,c),d.plotHeight)}else B=c;A=e.justify?n[0]+(F?-1:1)*(q+l):a.getX(B===r-q-l||B===r+q+l?c:B,F);v._attr={visibility:D,align:y[6]};v._pos={x:A+e.x+({left:f,right:-f}[y[6]]||0),y:B+e.y-10};v.connX=A;v.connY=B;if(this.options.size===null)u=v.width,A-u<f?E[3]=t(w(u-A+f),E[3]):A+u>h-f&&(E[1]=t(w(A+u-h+f),E[1])),B-b/2<0?E[0]=t(w(-B+b/2),E[0]):
B+b/2>i&&(E[2]=t(w(B+b/2-i),E[2]))}}}if(Ca(E)===0||this.verifyDataLabelOverflow(E))this.placeDataLabels(),s&&g&&o(this.points,function(b){j=b.connector;y=b.labelPos;if((v=b.dataLabel)&&v._pos&&b.visible)D=v._attr.visibility,A=v.connX,B=v.connY,k=m?["M",A+(y[6]==="left"?5:-5),B,"C",A,B,2*y[2]-y[4],2*y[3]-y[5],y[2],y[3],"L",y[4],y[5]]:["M",A+(y[6]==="left"?5:-5),B,"L",y[2],y[3],"L",y[4],y[5]],j?(j.animate({d:k}),j.attr("visibility",D)):b.connector=j=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||
b.color||"#606060",visibility:D}).add(a.dataLabelsGroup);else if(j)b.connector=j.destroy()})}},M.pie.prototype.placeDataLabels=function(){o(this.points,function(a){var b=a.dataLabel;if(b&&a.visible)(a=b._pos)?(b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-999})})},M.pie.prototype.alignDataLabel=ta,M.pie.prototype.verifyDataLabelOverflow=function(a){var b=this.center,c=this.options,d=c.center,e=c.minSize||80,f=e,g;d[0]!==null?f=t(b[2]-t(a[1],a[3]),e):(f=t(b[2]-a[1]-a[3],
e),b[0]+=(a[3]-a[1])/2);d[1]!==null?f=t(z(f,b[2]-t(a[0],a[2])),e):(f=t(z(f,b[2]-a[0]-a[2]),e),b[1]+=(a[0]-a[2])/2);f<b[2]?(b[2]=f,b[3]=/%$/.test(c.innerSize||0)?f*parseFloat(c.innerSize||0)/100:parseFloat(c.innerSize||0),this.translate(b),o(this.points,function(a){if(a.dataLabel)a.dataLabel._pos=null}),this.drawDataLabels&&this.drawDataLabels()):g=!0;return g};if(M.column)M.column.prototype.alignDataLabel=function(a,b,c,d,e){var f=this.chart.inverted,g=a.series,h=a.dlBox||a.shapeArgs,i=p(a.below,
a.plotY>p(this.translatedThreshold,g.yAxis.len)),j=p(c.inside,!!this.options.stacking);if(h&&(d=A(h),f&&(d={x:g.yAxis.len-d.y-d.height,y:g.xAxis.len-d.x-d.width,width:d.height,height:d.width}),!j))f?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0);c.align=p(c.align,!f||j?"center":i?"right":"left");c.verticalAlign=p(c.verticalAlign,f||j?"middle":i?"top":"bottom");R.prototype.alignDataLabel.call(this,a,b,c,d,e)};(function(a){var b=a.Chart,c=a.each,d=a.pick,e=HighchartsAdapter.addEvent;b.prototype.callbacks.push(function(a){function b(){var e=
[];c(a.series,function(a){var b=a.options.dataLabels,f=a.dataLabelCollections||["dataLabel"];(b.enabled||a._hasPointLabels)&&!b.allowOverlap&&a.visible&&c(f,function(b){c(a.points,function(a){if(a[b])a[b].labelrank=d(a.labelrank,a.shapeArgs&&a.shapeArgs.height),e.push(a[b])})})});a.hideOverlappingLabels(e)}b();e(a,"redraw",b)});b.prototype.hideOverlappingLabels=function(a){var b=a.length,d,e,j,k,m,l,n;for(e=0;e<b;e++)if(d=a[e])d.oldOpacity=d.opacity,d.newOpacity=1;a.sort(function(a,b){return(b.labelrank||
0)-(a.labelrank||0)});for(e=0;e<b;e++){j=a[e];for(d=e+1;d<b;++d)if(k=a[d],j&&k&&j.placed&&k.placed&&j.newOpacity!==0&&k.newOpacity!==0&&(m=j.alignAttr,l=k.alignAttr,n=2*(j.box?0:j.padding),m=!(l.x>m.x+(j.width-n)||l.x+(k.width-n)<m.x||l.y>m.y+(j.height-n)||l.y+(k.height-n)<m.y)))(j.labelrank<k.labelrank?j:k).newOpacity=0}c(a,function(a){var b,c;if(a){c=a.newOpacity;if(a.oldOpacity!==c&&a.placed)c?a.show(!0):b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,
b);a.isOld=!0}})}})(B);U=B.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(a){for(var c=a.target,d;c&&!d;)d=c.point,c=c.parentNode;if(d!==v&&d!==b.hoverPoint)d.onMouseOver(a)};o(a.points,function(a){if(a.graphic)a.graphic.element.point=a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)o(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),
$a))a[b].on("touchstart",f)}),a._hasTracking=!0},drawTrackerGraph:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,m=k&&{cursor:k},k=a.singlePoints,l,n=function(){if(f.hoverSeries!==a)a.onMouseOver()},p="rgba(192,192,192,"+(ca?1.0E-4:0.002)+")";if(e&&!c)for(l=e+1;l--;)d[l]==="M"&&d.splice(l+1,0,d[l+1]-i,d[l+2],"L"),(l&&d[l]==="M"||l===e)&&d.splice(l,0,"L",d[l-2]+i,d[l-
1]);for(l=0;l<k.length;l++)e=k[l],d.push("M",e.plotX-i,e.plotY,"L",e.plotX+i,e.plotY);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:p,fill:c?p:O,"stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),o([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(m);if($a)a.on("touchstart",n)}))}};if(M.column)wa.prototype.drawTracker=U.drawTrackerPoint;
if(M.pie)M.pie.prototype.drawTracker=U.drawTrackerPoint;if(M.scatter)pa.prototype.drawTracker=U.drawTrackerPoint;r(lb.prototype,{setItemEvents:function(a,b,c,d,e){var f=this;(c?b:a.legendGroup).on("mouseover",function(){a.setState("hover");b.css(f.options.itemHoverStyle)}).on("mouseout",function(){b.css(a.visible?d:e);a.setState()}).on("click",function(b){var c=function(){a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):I(a,"legendItemClick",b,c)})},createCheckboxForItem:function(a){a.checkbox=
$("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container);H(a.checkbox,"click",function(b){I(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}});S.legend.itemStyle.cursor="pointer";r(D.prototype,{showResetZoom:function(){var a=this,b=S.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,
function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;I(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?o(this.axes,function(a){b=a.zoom()}):o(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();
else if(!d&&da(e))this.resetZoomButton=e.destroy();b&&this.redraw(p(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&o(d,function(a){a.setState()});o(b==="xy"?[1,0]:[1],function(b){var d=a[b?"chartX":"chartY"],h=c[b?"xAxis":"yAxis"][0],i=c[b?"mouseDownX":"mouseDownY"],j=(h.pointRange||0)/2,k=h.getExtremes(),m=h.toValue(i-d,!0)+j,j=h.toValue(i+c[b?"plotWidth":"plotHeight"]-d,!0)-j,i=i>d;if(h.series.length&&(i||m>z(k.dataMin,k.min))&&
(!i||j<t(k.dataMax,k.max)))h.setExtremes(m,j,!1,!1,{trigger:"pan"}),e=!0;c[b?"mouseDownX":"mouseDownY"]=d});e&&c.redraw(!1);L(c.container,{cursor:"move"})}});r(Ea.prototype,{select:function(a,b){var c=this,d=c.series,e=d.chart,a=p(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[Ka(c,d.data)]=c.options;c.setState(a&&"select");b||o(e.getSelectedPoints(),function(a){if(a.selected&&a!==c)a.selected=a.options.selected=!1,d.options.data[Ka(a,
d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a,b){var c=this.series,d=c.chart,e=d.tooltip,f=d.hoverPoint;if(d.hoverSeries!==c)c.onMouseOver();if(f&&f!==this)f.onMouseOut();if(this.series&&(this.firePointEvent("mouseOver"),e&&(!e.shared||c.noSharedTooltip)&&e.refresh(this,a),this.setState("hover"),!b))d.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;this.firePointEvent("mouseOut");if(!b||Ka(this,b)===-1)this.setState(),a.hoverPoint=
null},importEvents:function(){if(!this.hasImportedEvents){var a=A(this.series.options.point,this.options).events,b;this.events=a;for(b in a)H(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a,b){var c=this.plotX,d=this.plotY,e=this.series,f=e.options.states,g=ba[e.type].marker&&e.options.marker,h=g&&!g.enabled,i=g&&g.states[a],j=i&&i.enabled===!1,k=e.stateMarkerGraphic,m=this.marker||{},l=e.chart,n=e.halo,o,a=a||"";o=this.pointAttr[a]||e.pointAttr[a];if(!(a===this.state&&!b||this.selected&&
a!=="select"||f[a]&&f[a].enabled===!1||a&&(j||h&&i.enabled===!1)||a&&m.states&&m.states[a]&&m.states[a].enabled===!1)){if(this.graphic)g=g&&this.graphic.symbolName&&o.r,this.graphic.attr(A(o,g?{x:c-g,y:d-g,width:2*g,height:2*g}:{})),k&&k.hide();else{if(a&&i)if(g=i.radius,m=m.symbol||e.symbol,k&&k.currentSymbol!==m&&(k=k.destroy()),k)k[b?"animate":"attr"]({x:c-g,y:d-g});else if(m)e.stateMarkerGraphic=k=l.renderer.symbol(m,c-g,d-g,2*g,2*g).attr(o).add(e.markerGroup),k.currentSymbol=m;if(k)k[a&&l.isInsidePlot(c,
d,l.inverted)?"show":"hide"](),k.element.point=this}if((c=f[a]&&f[a].halo)&&c.size){if(!n)e.halo=n=l.renderer.path().add(l.seriesGroup);n.attr(r({fill:na(this.color||e.color).setOpacity(c.opacity).get()},c.attributes))[b?"animate":"attr"]({d:this.haloPath(c.size)})}else n&&n.attr({d:[]});this.state=a}},haloPath:function(a){var b=this.series,c=b.chart,d=b.getPlotBox(),e=c.inverted;return c.renderer.symbols.circle(d.translateX+(e?b.yAxis.len-this.plotY:this.plotX)-a,d.translateY+(e?b.xAxis.len-this.plotX:
this.plotY)-a,a*2,a*2)}});r(R.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&I(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;b.hoverSeries=null;if(d)d.onMouseOut();this&&a.events.mouseOut&&I(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&c.hide();this.setState()},setState:function(a){var b=this.options,
c=this.graph,d=b.states,e=b.lineWidth,b=0,a=a||"";if(this.state!==a&&(this.state=a,!(d[a]&&d[a].enabled===!1)&&(a&&(e=d[a].lineWidth||e+(d[a].lineWidthPlus||0)),c&&!c.dashstyle))){a={"stroke-width":e};for(c.attr(a);this["zoneGraph"+b];)this["zoneGraph"+b].attr(a),b+=1}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===v?!h:a)?"show":"hide";o(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});
if(d.hoverSeries===c||(d.hoverPoint&&d.hoverPoint.series)===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&o(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});o(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();I(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=a===v?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;I(this,a?"select":"unselect")},
drawTracker:U.drawTrackerGraph});r(B,{Color:na,Point:Ea,Tick:Ra,Renderer:Za,SVGElement:P,SVGRenderer:ua,arrayMin:Na,arrayMax:Ca,charts:Y,dateFormat:Ma,error:la,format:Ha,pathAnim:xb,getOptions:function(){return S},hasBidiBug:Nb,isTouchDevice:Jb,setOptions:function(a){S=A(!0,S,a);Cb();return S},addEvent:H,removeEvent:Z,createElement:$,discardElement:Pa,css:L,each:o,map:Ta,merge:A,splat:ra,extendClass:ka,pInt:F,svg:ca,canvas:fa,vml:!ca&&!fa,product:"Highcharts",version:"4.1.8"})})();
</script>
    <script>/*
 Highcharts JS v4.1.8 (2015-08-20)
 Exporting module

 (c) 2010-2014 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(g){var A=g.Chart,t=g.addEvent,B=g.removeEvent,C=HighchartsAdapter.fireEvent,j=g.createElement,p=g.discardElement,v=g.css,l=g.merge,m=g.each,q=g.extend,E=g.splat,F=Math.max,k=document,D=window,G=g.isTouchDevice,H=g.Renderer.prototype.symbols,r=g.getOptions(),y;q(r.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"});r.navigation=
{menuStyle:{border:"1px solid #A0A0A0",background:"#FFFFFF",padding:"5px 0"},menuItemStyle:{padding:"0 10px",background:"none",color:"#303030",fontSize:G?"14px":"11px"},menuItemHoverStyle:{background:"#4572A5",color:"#FFFFFF"},buttonOptions:{symbolFill:"#E0E0E0",symbolSize:14,symbolStroke:"#666",symbolStrokeWidth:3,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,theme:{fill:"white",stroke:"none"},verticalAlign:"top",width:24}};r.exporting={type:"image/png",url:"http://export.highcharts.com/",
buttons:{contextButton:{menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChart()}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}]}}};
g.post=function(b,a,e){var c,b=j("form",l({method:"post",action:b,enctype:"multipart/form-data"},e),{display:"none"},k.body);for(c in a)j("input",{type:"hidden",name:c,value:a[c]},null,b);b.submit();p(b)};q(A.prototype,{sanitizeSVG:function(b){return b.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g,
" xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"\u00a0").replace(/&shy;/g,"\u00ad").replace(/<IMG /g,"<image ").replace(/<(\/?)TITLE>/g,"<$1title>").replace(/height=([^" ]+)/g,'height="$1"').replace(/width=([^" ]+)/g,'width="$1"').replace(/hc-svg-href="([^"]+)">/g,'xlink:href="$1"/>').replace(/ id=([^" >]+)/g,' id="$1"').replace(/class=([^" >]+)/g,'class="$1"').replace(/ transform /g,
" ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(a){return a.toLowerCase()})},getChartHTML:function(){return this.container.innerHTML},getSVG:function(b){var a=this,e,c,f,z,h,d=l(a.options,b),s=d.exporting.allowHTML;if(!k.createElementNS)k.createElementNS=function(a,b){return k.createElement(b)};c=j("div",null,{position:"absolute",top:"-9999em",width:a.chartWidth+"px",height:a.chartHeight+"px"},k.body);f=a.renderTo.style.width;h=a.renderTo.style.height;f=d.exporting.sourceWidth||
d.chart.width||/px$/.test(f)&&parseInt(f,10)||600;h=d.exporting.sourceHeight||d.chart.height||/px$/.test(h)&&parseInt(h,10)||400;q(d.chart,{animation:!1,renderTo:c,forExport:!s,width:f,height:h});d.exporting.enabled=!1;delete d.data;d.series=[];m(a.series,function(a){z=l(a.options,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:a.visible});z.isInternal||d.series.push(z)});b&&m(["xAxis","yAxis"],function(a){m(E(b[a]),function(b,c){d[a][c]=l(d[a][c],b)})});e=new g.Chart(d,a.callback);m(["xAxis",
"yAxis"],function(b){m(a[b],function(a,c){var d=e[b][c],f=a.getExtremes(),h=f.userMin,f=f.userMax;d&&(h!==void 0||f!==void 0)&&d.setExtremes(h,f,!0,!1)})});f=e.getChartHTML();d=null;e.destroy();p(c);if(s&&(c=f.match(/<\/svg>(.*?$)/)))c='<foreignObject x="0" y="0 width="200" height="200"><body xmlns="http://www.w3.org/1999/xhtml">'+c[1]+"</body></foreignObject>",f=f.replace("</svg>",c+"</svg>");f=this.sanitizeSVG(f);return f=f.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'")},
getSVGForExport:function(b,a){var e=this.options.exporting;return this.getSVG(l({chart:{borderRadius:0}},e.chartOptions,a,{exporting:{sourceWidth:b&&b.sourceWidth||e.sourceWidth,sourceHeight:b&&b.sourceHeight||e.sourceHeight}}))},exportChart:function(b,a){var e=this.getSVGForExport(b,a),b=l(this.options.exporting,b);g.post(b.url,{filename:b.filename||"chart",type:b.type,width:b.width||0,scale:b.scale||2,svg:e},b.formAttributes)},print:function(){var b=this,a=b.container,e=[],c=a.parentNode,f=k.body,
g=f.childNodes;if(!b.isPrinting)b.isPrinting=!0,C(b,"beforePrint"),m(g,function(a,b){if(a.nodeType===1)e[b]=a.style.display,a.style.display="none"}),f.appendChild(a),D.focus(),D.print(),setTimeout(function(){c.appendChild(a);m(g,function(a,b){if(a.nodeType===1)a.style.display=e[b]});b.isPrinting=!1;C(b,"afterPrint")},1E3)},contextMenu:function(b,a,e,c,f,g,h){var d=this,s=d.options.navigation,l=s.menuItemStyle,n=d.chartWidth,o=d.chartHeight,k="cache-"+b,i=d[k],u=F(f,g),w,x,p,r=function(a){d.pointer.inClass(a.target,
b)||x()};if(!i)d[k]=i=j("div",{className:b},{position:"absolute",zIndex:1E3,padding:u+"px"},d.container),w=j("div",null,q({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},s.menuStyle),i),x=function(){v(i,{display:"none"});h&&h.setState(0);d.openMenu=!1},t(i,"mouseleave",function(){p=setTimeout(x,500)}),t(i,"mouseenter",function(){clearTimeout(p)}),t(document,"mouseup",r),t(d,"destroy",function(){B(document,"mouseup",r)}),m(a,function(a){if(a){var b=
a.separator?j("hr",null,null,w):j("div",{onmouseover:function(){v(this,s.menuItemHoverStyle)},onmouseout:function(){v(this,l)},onclick:function(b){b.stopPropagation();x();a.onclick&&a.onclick.apply(d,arguments)},innerHTML:a.text||d.options.lang[a.textKey]},q({cursor:"pointer"},l),w);d.exportDivElements.push(b)}}),d.exportDivElements.push(w,i),d.exportMenuWidth=i.offsetWidth,d.exportMenuHeight=i.offsetHeight;a={display:"block"};e+d.exportMenuWidth>n?a.right=n-e-f-u+"px":a.left=e-u+"px";c+g+d.exportMenuHeight>
o&&h.alignOptions.verticalAlign!=="top"?a.bottom=o-c-u+"px":a.top=c+g-u+"px";v(i,a);d.openMenu=!0},addButton:function(b){var a=this,e=a.renderer,c=l(a.options.navigation.buttonOptions,b),f=c.onclick,k=c.menuItems,h,d,m={stroke:c.symbolStroke,fill:c.symbolFill},j=c.symbolSize||12;if(!a.btnCount)a.btnCount=0;if(!a.exportDivElements)a.exportDivElements=[],a.exportSVGElements=[];if(c.enabled!==!1){var n=c.theme,o=n.states,p=o&&o.hover,o=o&&o.select,i;delete n.states;f?i=function(b){b.stopPropagation();
f.call(a,b)}:k&&(i=function(){a.contextMenu(d.menuClassName,k,d.translateX,d.translateY,d.width,d.height,d);d.setState(2)});c.text&&c.symbol?n.paddingLeft=g.pick(n.paddingLeft,25):c.text||q(n,{width:c.width,height:c.height,padding:0});d=e.button(c.text,0,0,i,n,p,o).attr({title:a.options.lang[c._titleKey],"stroke-linecap":"round"});d.menuClassName=b.menuClassName||"highcharts-menu-"+a.btnCount++;c.symbol&&(h=e.symbol(c.symbol,c.symbolX-j/2,c.symbolY-j/2,j,j).attr(q(m,{"stroke-width":c.symbolStrokeWidth||
1,zIndex:1})).add(d));d.add().align(q(c,{width:d.width,x:g.pick(c.x,y)}),!0,"spacingBox");y+=(d.width+c.buttonSpacing)*(c.align==="right"?-1:1);a.exportSVGElements.push(d,h)}},destroyExport:function(b){var b=b.target,a,e;for(a=0;a<b.exportSVGElements.length;a++)if(e=b.exportSVGElements[a])e.onclick=e.ontouchstart=null,b.exportSVGElements[a]=e.destroy();for(a=0;a<b.exportDivElements.length;a++)e=b.exportDivElements[a],B(e,"mouseleave"),b.exportDivElements[a]=e.onmouseout=e.onmouseover=e.ontouchstart=
e.onclick=null,p(e)}});H.menu=function(b,a,e,c){return["M",b,a+2.5,"L",b+e,a+2.5,"M",b,a+c/2+0.5,"L",b+e,a+c/2+0.5,"M",b,a+c-1.5,"L",b+e,a+c-1.5]};A.prototype.callbacks.push(function(b){var a,e=b.options.exporting,c=e.buttons;y=0;if(e.enabled!==!1){for(a in c)b.addButton(c[a]);t(b,"destroy",b.destroyExport)}})})(Highcharts);
</script>
<script type='text/javascript'>
// Generated by CoffeeScript 1.6.3
var Cloner, Denuller, Random, StrictMath, println, typeIsArray;

if (typeof println === "undefined" || println === null) {
  if (typeof console !== "undefined" && console !== null) {
    println = console.log;
  }
  if (println == null) {
    println = print;
  }
}

typeIsArray = function(value) {
  return value && typeof value === 'object' && value instanceof Array && typeof value.length === 'number' && typeof value.splice === 'function' && !(value.propertyIsEnumerable('length'));
};

if (typeof Random === "undefined" || Random === null) {
  Random = {};
  Random.nextInt = function(limit) {
    return Math.floor(Math.random() * limit);
  };
  Random.nextLong = Random.nextInt;
  Random.nextDouble = function() {
    return Math.random();
  };
}

Cloner = {
  clone: function(obj) {
    var key, temp, _i, _len, _ref;
    if (obj === null || typeof obj !== "object") {
      return obj;
    }
    temp = new obj.constructor();
    _ref = Object.getOwnPropertyNames(obj);
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      key = _ref[_i];
      temp[key] = this.clone(obj[key]);
    }
    return temp;
  }
};

if (typeof StrictMath === "undefined" || StrictMath === null) {
  StrictMath = Cloner.clone(Math);
  StrictMath.toRadians = function(degrees) {
    return degrees * Math.PI / 180;
  };
  StrictMath.toDegrees = function(radians) {
    return radians * 180 / Math.PI;
  };
}

Denuller = {
  denull: function(x) {
    var key, result, value, y, _i, _len, _results;
    if (typeIsArray(x)) {
      _results = [];
      for (_i = 0, _len = x.length; _i < _len; _i++) {
        y = x[_i];
        _results.push(this.denull(y));
      }
      return _results;
    } else if (x === null) {
      return x;
    } else if (typeof x === "object") {
      result = {};
      for (key in x) {
        value = x[key];
        if (isNaN(key) || value !== null) {
          result[key] = this.denull(value);
        }
      }
      return result;
    } else {
      return x;
    }
  }
};
;
// Generated by CoffeeScript 1.6.3
var AgentSet, Agents, Box, Breed, Breeds, DeathInterrupt, Dump, Globals, HorzCylinder, Iterator, Layouts, Link, Links, NetLogoException, Nobody, Patch, PatchesOwn, Prims, Shufflerator, Topology, TopologyInterrupt, Torus, Trig, Turtle, TurtlesOwn, Updates, VertCylinder, World, collectUpdates, died, linkBuiltins, noop, patchBuiltins, turtleBuiltins, updated, _ref, _ref1,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
  __slice = [].slice,
  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

turtleBuiltins = ["id", "color", "heading", "xcor", "ycor", "shape", "label", "labelcolor", "breed", "hidden", "size", "pensize", "penmode"];

patchBuiltins = ["pxcor", "pycor", "pcolor", "plabel", "plabelcolor"];

linkBuiltins = ["end1", "end2", "lcolor", "llabel", "llabelcolor", "lhidden", "lbreed", "thickness", "lshape", "tiemode", "size", "heading", "midpointx", "midpointy"];

NetLogoException = (function() {
  function NetLogoException(message) {
    this.message = message;
  }

  return NetLogoException;

})();

DeathInterrupt = (function(_super) {
  __extends(DeathInterrupt, _super);

  function DeathInterrupt() {
    _ref = DeathInterrupt.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  return DeathInterrupt;

})(NetLogoException);

TopologyInterrupt = (function(_super) {
  __extends(TopologyInterrupt, _super);

  function TopologyInterrupt() {
    _ref1 = TopologyInterrupt.__super__.constructor.apply(this, arguments);
    return _ref1;
  }

  return TopologyInterrupt;

})(NetLogoException);

Updates = [];

Nobody = {
  toString: function() {
    return "nobody";
  }
};

collectUpdates = function() {
  var result;
  result = Updates.length === 0 ? [
    {
      turtles: {},
      patches: {}
    }
  ] : Updates;
  Updates = [
    {
      turtles: {},
      patches: {},
      links: {},
      observer: {},
      world: {}
    }
  ];
  return result;
};

died = function(agent) {
  if (agent instanceof Turtle) {
    Updates[0].turtles[agent.id] = {
      WHO: -1
    };
  } else if (agent instanceof Link) {
    Updates[0].links[agent.id] = {
      WHO: -1
    };
  }
};

noop = function() {
  var vars;
  vars = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
};

updated = function() {
  var agentUpdate, agents, obj, update, v, vars, _i, _len;
  obj = arguments[0], vars = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
  update = Updates[0];
  if (obj instanceof Turtle) {
    agents = update.turtles;
  } else if (obj instanceof Patch) {
    agents = update.patches;
  } else if (obj instanceof Link) {
    agents = update.links;
  }
  agentUpdate = agents[obj.id] || {};
  if (agentUpdate['WHO'] < 0) {
    delete agentUpdate['WHO'];
  }
  for (_i = 0, _len = vars.length; _i < _len; _i++) {
    v = vars[_i];
    switch (v) {
      case "xcor":
        agentUpdate["XCOR"] = obj.xcor();
        break;
      case "ycor":
        agentUpdate["YCOR"] = obj.ycor();
        break;
      case "id":
        agentUpdate[obj instanceof Link ? "ID" : "WHO"] = obj[v];
        break;
      case "plabelcolor":
        agentUpdate["PLABEL-COLOR"] = obj[v];
        break;
      case "breed":
        agentUpdate["BREED"] = obj[v].name;
        break;
      case "labelcolor":
        agentUpdate["LABEL-COLOR"] = obj[v];
        break;
      case "pensize":
        agentUpdate["PEN-SIZE"] = obj[v];
        break;
      case "penmode":
        agentUpdate["PEN-MODE"] = obj[v];
        break;
      case "hidden":
        agentUpdate["HIDDEN?"] = obj[v];
        break;
      case "tiemode":
        agentUpdate["TIE-MODE"] = obj[v];
        break;
      case "end1":
        agentUpdate["END1"] = obj[v].id;
        break;
      case "end2":
        agentUpdate["END2"] = obj[v].id;
        break;
      default:
        agentUpdate[v.toUpperCase()] = obj[v];
    }
  }
  agents[obj.id] = agentUpdate;
};

Turtle = (function() {
  Turtle.prototype.vars = [];

  Turtle.prototype._xcor = 0;

  Turtle.prototype._ycor = 0;

  Turtle.prototype._links = [];

  function Turtle(color, heading, xcor, ycor, breed, label, labelcolor, hidden, size, pensize, penmode) {
    var x;
    this.color = color != null ? color : 0;
    this.heading = heading != null ? heading : 0;
    if (xcor == null) {
      xcor = 0;
    }
    if (ycor == null) {
      ycor = 0;
    }
    if (breed == null) {
      breed = Breeds.get("TURTLES");
    }
    this.label = label != null ? label : "";
    this.labelcolor = labelcolor != null ? labelcolor : 9.9;
    this.hidden = hidden != null ? hidden : false;
    this.size = size != null ? size : 1.0;
    this.pensize = pensize != null ? pensize : 1.0;
    this.penmode = penmode != null ? penmode : "up";
    this._xcor = xcor;
    this._ycor = ycor;
    this.breedVars = {};
    this.updateBreed(breed);
    this.vars = (function() {
      var _i, _len, _ref2, _results;
      _ref2 = TurtlesOwn.vars;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        x = _ref2[_i];
        _results.push(x);
      }
      return _results;
    })();
    this.getPatchHere().arrive(this);
  }

  Turtle.prototype.updateBreed = function(breed) {
    var x, _i, _len, _ref2, _results;
    if (this.breed) {
      this.breed.remove(this);
    }
    this.breed = breed;
    breed.add(this);
    this.shape = this.breed.shape();
    if (this.breed !== Breeds.get("TURTLES")) {
      _ref2 = this.breed.vars;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        x = _ref2[_i];
        if (this.breedVars[x] === void 0) {
          _results.push(this.breedVars[x] = 0);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    }
  };

  Turtle.prototype.xcor = function() {
    return this._xcor;
  };

  Turtle.prototype.setXcor = function(newX) {
    var originPatch;
    originPatch = this.getPatchHere();
    this._xcor = world.topology().wrapX(newX);
    if (originPatch !== this.getPatchHere()) {
      originPatch.leave(this);
      this.getPatchHere().arrive(this);
    }
    return this.refreshLinks();
  };

  Turtle.prototype.ycor = function() {
    return this._ycor;
  };

  Turtle.prototype.setYcor = function(newY) {
    var originPatch;
    originPatch = this.getPatchHere();
    this._ycor = world.topology().wrapY(newY);
    if (originPatch !== this.getPatchHere()) {
      originPatch.leave(this);
      this.getPatchHere().arrive(this);
    }
    return this.refreshLinks();
  };

  Turtle.prototype.setBreed = function(breed) {
    this.updateBreed(breed);
    updated(this, "breed");
    return updated(this, "shape");
  };

  Turtle.prototype.toString = function() {
    return "(" + this.breed.singular + " " + this.id + ")";
  };

  Turtle.prototype.keepHeadingInRange = function() {
    if (this.heading < 0 || this.heading >= 360) {
      this.heading = ((this.heading % 360) + 360) % 360;
    }
  };

  Turtle.prototype.canMove = function(amount) {
    return this.patchAhead(amount) !== Nobody;
  };

  Turtle.prototype.distanceXY = function(x, y) {
    return world.topology().distanceXY(this.xcor(), this.ycor(), x, y);
  };

  Turtle.prototype.distance = function(agent) {
    return world.topology().distance(this.xcor(), this.ycor(), agent);
  };

  Turtle.prototype.faceXY = function(x, y) {
    if (x !== this.xcor() || y !== this.ycor()) {
      this.heading = world.topology().towards(this.xcor(), this.ycor(), x, y);
      return updated(this, "heading");
    }
  };

  Turtle.prototype.face = function(agent) {
    if (agent instanceof Turtle) {
      return this.faceXY(agent.xcor(), agent.ycor());
    } else if (agent instanceof Patch) {
      return this.faceXY(agent.pxcor, agent.pycor);
    }
  };

  Turtle.prototype.inRadius = function(agents, radius) {
    return world.topology().inRadius(this, this.xcor(), this.ycor(), agents, radius);
  };

  Turtle.prototype.patchAt = function(dx, dy) {
    return this.getPatchHere().patchAt(dx, dy);
  };

  Turtle.prototype.turtlesAt = function(dx, dy) {
    return this.getPatchHere().turtlesAt(dx, dy);
  };

  Turtle.prototype.connectedLinks = function(directed, isSource) {
    var me;
    me = this;
    if (directed) {
      return new Agents(world.links().items.map(function(l) {
        if ((l.directed && l.end1 === me && isSource) || (l.directed && l.end2 === me && !isSource)) {
          return l;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      }), Breeds.get("LINKS"));
    } else {
      return new Agents(world.links().items.map(function(l) {
        if ((!l.directed && l.end1 === me) || (!l.directed && l.end2 === me)) {
          return l;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      }), Breeds.get("LINKS"));
    }
  };

  Turtle.prototype.refreshLinks = function() {
    var l, _i, _j, _k, _len, _len1, _len2, _ref2, _ref3, _ref4, _results;
    if (this._links.length > 0) {
      _ref2 = (this.connectedLinks(true, true).items);
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        l = _ref2[_i];
        l.updateEndRelatedVars();
      }
      _ref3 = (this.connectedLinks(true, false).items);
      for (_j = 0, _len1 = _ref3.length; _j < _len1; _j++) {
        l = _ref3[_j];
        l.updateEndRelatedVars();
      }
      _ref4 = (this.connectedLinks(false, false).items);
      _results = [];
      for (_k = 0, _len2 = _ref4.length; _k < _len2; _k++) {
        l = _ref4[_k];
        _results.push(l.updateEndRelatedVars());
      }
      return _results;
    }
  };

  Turtle.prototype.linkNeighbors = function(directed, isSource) {
    var me;
    me = this;
    if (directed) {
      return new Agents(world.links().items.map(function(l) {
        if (l.directed && l.end1 === me && isSource) {
          return l.end2;
        } else if (l.directed && l.end2 === me && !isSource) {
          return l.end1;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      }), Breeds.get("TURTLES"));
    } else {
      return new Agents(world.links().items.map(function(l) {
        if (!l.directed && l.end1 === me) {
          return l.end2;
        } else if (!l.directed && l.end2 === me) {
          return l.end1;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      }), Breeds.get("TURTLES"));
    }
  };

  Turtle.prototype.isLinkNeighbor = function(directed, isSource, other) {
    return this.linkNeighbors(directed, isSource).items.filter(function(o) {
      return o === other;
    }).length > 0;
  };

  Turtle.prototype.findLinkViaNeighbor = function(directed, isSource, other) {
    var links, me;
    me = this;
    links = [];
    if (directed) {
      links = world.links().items.map(function(l) {
        if ((l.directed && l.end1 === me && l.end2 === other && isSource) || (l.directed && l.end1 === other && l.end2 === me && !isSource)) {
          return l;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      });
    } else {
      if (world.unbreededLinksAreDirected) {
        throw new NetLogoException("LINKS is a directed breed.");
      }
      links = world.links().items.map(function(l) {
        if ((!l.directed && l.end1 === me && l.end2 === other) || (!l.directed && l.end2 === me && l.end1 === other)) {
          return l;
        } else {
          return null;
        }
      }).filter(function(o) {
        return o !== null;
      });
    }
    if (links.length === 0) {
      return Nobody;
    } else {
      return links[0];
    }
  };

  Turtle.prototype.otherEnd = function() {
    if (this === AgentSet.myself().end1) {
      return AgentSet.myself().end2;
    } else {
      return AgentSet.myself().end1;
    }
  };

  Turtle.prototype.patchRightAndAhead = function(angle, amount) {
    var error, heading, newX, newY;
    heading = this.heading + angle;
    if (heading < 0 || heading >= 360) {
      heading = ((heading % 360) + 360) % 360;
    }
    try {
      newX = world.topology().wrapX(this.xcor() + amount * Trig.sin(heading));
      newY = world.topology().wrapY(this.ycor() + amount * Trig.cos(heading));
      return world.getPatchAt(newX, newY);
    } catch (_error) {
      error = _error;
      if (error instanceof TopologyInterrupt) {
        return Nobody;
      } else {
        throw error;
      }
    }
  };

  Turtle.prototype.patchLeftAndAhead = function(angle, amount) {
    return this.patchRightAndAhead(-angle, amount);
  };

  Turtle.prototype.patchAhead = function(amount) {
    return this.patchRightAndAhead(0, amount);
  };

  Turtle.prototype.fd = function(amount) {
    if (amount > 0) {
      while (amount >= 1 && this.jump(1)) {
        amount -= 1;
      }
      this.jump(amount);
    } else if (amount < 0) {
      while (amount <= -1 && this.jump(-1)) {
        amount += 1;
      }
      this.jump(amount);
    }
  };

  Turtle.prototype.jump = function(amount) {
    if (this.canMove(amount)) {
      this.setXcor(this.xcor() + amount * Trig.sin(this.heading));
      this.setYcor(this.ycor() + amount * Trig.cos(this.heading));
      updated(this, "xcor", "ycor");
      return true;
    }
    return false;
  };

  Turtle.prototype.right = function(amount) {
    this.heading += amount;
    this.keepHeadingInRange();
    updated(this, "heading");
  };

  Turtle.prototype.setXY = function(x, y) {
    var error, origXcor, origYcor;
    origXcor = this.xcor();
    origYcor = this.ycor();
    try {
      this.setXcor(x);
      this.setYcor(y);
    } catch (_error) {
      error = _error;
      this.setXcor(origXcor);
      this.setYcor(origYcor);
      if (error instanceof TopologyInterrupt) {
        throw new TopologyInterrupt("The point [ " + x + " , " + y + " ] is outside of the boundaries of the world and wrapping is not permitted in one or both directions.");
      } else {
        throw error;
      }
    }
    updated(this, "xcor", "ycor");
  };

  Turtle.prototype.hideTurtle = function(flag) {
    this.hidden = flag;
    updated(this, "hidden");
  };

  Turtle.prototype.isBreed = function(breedName) {
    return this.breed.name === breedName;
  };

  Turtle.prototype.die = function() {
    var error, l, _i, _len, _ref2;
    this.breed.remove(this);
    if (this.id !== -1) {
      world.removeTurtle(this.id);
      died(this);
      _ref2 = world.links().items;
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        l = _ref2[_i];
        try {
          if (l.end1.id === this.id || l.end2.id === this.id) {
            l.die();
          }
        } catch (_error) {
          error = _error;
          if (!(error instanceof DeathInterrupt)) {
            throw error;
          }
        }
      }
      this.id = -1;
      this.getPatchHere().leave(this);
    }
    throw new DeathInterrupt("Call only from inside an askAgent block");
  };

  Turtle.prototype.getTurtleVariable = function(n) {
    if (n < turtleBuiltins.length) {
      if (n === 3) {
        return this.xcor();
      } else if (n === 4) {
        return this.ycor();
      } else if (n === 8) {
        return world.turtlesOfBreed(this.breed.name);
      } else {
        return this[turtleBuiltins[n]];
      }
    } else {
      return this.vars[n - turtleBuiltins.length];
    }
  };

  Turtle.prototype.setTurtleVariable = function(n, v) {
    if (n < turtleBuiltins.length) {
      if (n === 3) {
        this.setXcor(v);
      } else if (n === 4) {
        this.setYcor(v);
      } else {
        if (n === 5) {
          v = v.toLowerCase();
        }
        this[turtleBuiltins[n]] = v;
        if (n === 2) {
          this.keepHeadingInRange();
        }
      }
      return updated(this, turtleBuiltins[n]);
    } else {
      return this.vars[n - turtleBuiltins.length] = v;
    }
  };

  Turtle.prototype.getBreedVariable = function(n) {
    return this.breedVars[n];
  };

  Turtle.prototype.setBreedVariable = function(n, v) {
    return this.breedVars[n] = v;
  };

  Turtle.prototype.getPatchHere = function() {
    return world.getPatchAt(this.xcor(), this.ycor());
  };

  Turtle.prototype.getPatchVariable = function(n) {
    return this.getPatchHere().getPatchVariable(n);
  };

  Turtle.prototype.setPatchVariable = function(n, v) {
    return this.getPatchHere().setPatchVariable(n, v);
  };

  Turtle.prototype.getNeighbors = function() {
    return this.getPatchHere().getNeighbors();
  };

  Turtle.prototype.getNeighbors4 = function() {
    return this.getPatchHere().getNeighbors4();
  };

  Turtle.prototype.turtlesHere = function() {
    return this.getPatchHere().turtlesHere();
  };

  Turtle.prototype.breedHere = function(breedName) {
    return this.getPatchHere().breedHere(breedName);
  };

  Turtle.prototype.hatch = function(n, breedName) {
    var breed, newTurtles, num, t, v, _i, _j, _ref2;
    breed = breedName ? Breeds.get(breedName) : this.breed;
    newTurtles = [];
    for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
      t = new Turtle(this.color, this.heading, this.xcor(), this.ycor(), breed, this.label, this.labelcolor, this.hidden, this.size, this.pensize, this.penmode);
      for (v = _j = 0, _ref2 = TurtlesOwn.vars.length; 0 <= _ref2 ? _j <= _ref2 : _j >= _ref2; v = 0 <= _ref2 ? ++_j : --_j) {
        t.setTurtleVariable(turtleBuiltins.length + v, this.getTurtleVariable(turtleBuiltins.length + v));
      }
      newTurtles.push(world.createTurtle(t));
    }
    return new Agents(newTurtles, breed);
  };

  Turtle.prototype.moveTo = function(agent) {
    if (agent instanceof Turtle) {
      return this.setXY(agent.xcor(), agent.ycor());
    } else if (agent instanceof Patch) {
      return this.setXY(agent.pxcor, agent.pycor);
    }
  };

  Turtle.prototype.watchme = function() {
    return world.watch(this);
  };

  Turtle.prototype._removeLink = function(l) {
    return this._links.splice(this._links.indexOf(l));
  };

  return Turtle;

})();

Patch = (function() {
  Patch.prototype.vars = [];

  function Patch(id, pxcor, pycor, pcolor, plabel, plabelcolor) {
    var x;
    this.id = id;
    this.pxcor = pxcor;
    this.pycor = pycor;
    this.pcolor = pcolor != null ? pcolor : 0.0;
    this.plabel = plabel != null ? plabel : "";
    this.plabelcolor = plabelcolor != null ? plabelcolor : 9.9;
    this.vars = (function() {
      var _i, _len, _ref2, _results;
      _ref2 = PatchesOwn.vars;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        x = _ref2[_i];
        _results.push(x);
      }
      return _results;
    })();
    this.turtles = [];
  }

  Patch.prototype.toString = function() {
    return "(patch " + this.pxcor + " " + this.pycor + ")";
  };

  Patch.prototype.getPatchVariable = function(n) {
    if (n < patchBuiltins.length) {
      return this[patchBuiltins[n]];
    } else {
      return this.vars[n - patchBuiltins.length];
    }
  };

  Patch.prototype.setPatchVariable = function(n, v) {
    if (n < patchBuiltins.length) {
      this[patchBuiltins[n]] = v;
      if (patchBuiltins[n] === "pcolor" && v !== 0) {
        world.patchesAllBlack(false);
      }
      return updated(this, patchBuiltins[n]);
    } else {
      return this.vars[n - patchBuiltins.length] = v;
    }
  };

  Patch.prototype.leave = function(t) {
    return this.turtles.splice(this.turtles.indexOf(t, 0), 1);
  };

  Patch.prototype.arrive = function(t) {
    return this.turtles.push(t);
  };

  Patch.prototype.distanceXY = function(x, y) {
    return world.topology().distanceXY(this.pxcor, this.pycor, x, y);
  };

  Patch.prototype.distance = function(agent) {
    return world.topology().distance(this.pxcor, this.pycor, agent);
  };

  Patch.prototype.turtlesHere = function() {
    return new Agents(this.turtles, Breeds.get("TURTLES"));
  };

  Patch.prototype.getNeighbors = function() {
    return world.getNeighbors(this.pxcor, this.pycor);
  };

  Patch.prototype.getNeighbors4 = function() {
    return world.getNeighbors4(this.pxcor, this.pycor);
  };

  Patch.prototype.sprout = function(n, breedName) {
    var breed, num;
    breed = "" === breedName ? Breeds.get("TURTLES") : Breeds.get(breedName);
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(world.createTurtle(new Turtle(5 + 10 * Random.nextInt(14), Random.nextInt(360), this.pxcor, this.pycor, breed)));
      }
      return _results;
    }).call(this));
  };

  Patch.prototype.breedHere = function(breedName) {
    var breed, t;
    breed = Breeds.get(breedName);
    return new Agents((function() {
      var _i, _len, _ref2, _results;
      _ref2 = this.turtles;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        t = _ref2[_i];
        if (t.breed === breed) {
          _results.push(t);
        }
      }
      return _results;
    }).call(this), breed);
  };

  Patch.prototype.turtlesAt = function(dx, dy) {
    return this.patchAt(dx, dy).turtlesHere();
  };

  Patch.prototype.patchAt = function(dx, dy) {
    var error, newX, newY;
    try {
      newX = world.topology().wrapX(this.pxcor + dx);
      newY = world.topology().wrapY(this.pycor + dy);
      return world.getPatchAt(newX, newY);
    } catch (_error) {
      error = _error;
      if (error instanceof TopologyInterrupt) {
        return Nobody;
      } else {
        throw error;
      }
    }
  };

  Patch.prototype.watchme = function() {
    return world.watch(this);
  };

  return Patch;

})();

Links = {
  compare: function(a, b) {
    if (a === b) {
      return 0;
    } else if (a.end1.id < b.end1.id) {
      return -1;
    } else if (a.end1.id > b.end1.id) {
      return 1;
    } else if (a.end2.id < b.end2.id) {
      return -1;
    } else if (a.end2.id > b.end2.id) {
      return 1;
    } else if (a.breed === b.breed) {
      return 0;
    } else if (a.breed === Breeds.get("LINKS")) {
      return -1;
    } else if (b.breed === Breeds.get("LINKS")) {
      return 1;
    } else {
      throw new Error("We have yet to implement link breed comparison");
    }
  }
};

Link = (function() {
  Link.prototype.color = 5;

  Link.prototype.label = "";

  Link.prototype.labelcolor = 9.9;

  Link.prototype.hidden = false;

  Link.prototype.shape = "default";

  Link.prototype.thickness = 0;

  Link.prototype.tiemode = "none";

  Link.prototype.xcor = function() {};

  Link.prototype.ycor = function() {};

  function Link(id, directed, end1, end2) {
    this.id = id;
    this.directed = directed;
    this.end1 = end1;
    this.end2 = end2;
    this.breed = Breeds.get("LINKS");
    this.breed.add(this);
    this.end1._links.push(this);
    this.end2._links.push(this);
    this.updateEndRelatedVars();
  }

  Link.prototype.getLinkVariable = function(n) {
    if (n < linkBuiltins.length) {
      return this[linkBuiltins[n]];
    } else {
      return this.vars[n - linkBuiltins.length];
    }
  };

  Link.prototype.setLinkVariable = function(n, v) {
    if (n < linkBuiltins.length) {
      this[linkBuiltins[n]] = v;
      return updated(this, linkBuiltins[n]);
    } else {
      return this.vars[n - linkBuiltins.length] = v;
    }
  };

  Link.prototype.die = function() {
    this.breed.remove(this);
    if (this.id !== -1) {
      this.end1._removeLink(this);
      this.end2._removeLink(this);
      world.removeLink(this.id);
      died(this);
      this.id = -1;
    }
    throw new DeathInterrupt("Call only from inside an askAgent block");
  };

  Link.prototype.getTurtleVariable = function(n) {
    return this[turtleBuiltins[n]];
  };

  Link.prototype.setTurtleVariable = function(n, v) {
    this[turtleBuiltins[n]] = v;
    return updated(this, turtleBuiltins[n]);
  };

  Link.prototype.bothEnds = function() {
    return new Agents([this.end1, this.end2], Breeds.get("TURTLES"));
  };

  Link.prototype.otherEnd = function() {
    if (this.end1 === AgentSet.myself()) {
      return this.end2;
    } else {
      return this.end1;
    }
  };

  Link.prototype.updateEndRelatedVars = function() {
    this.heading = world.topology().towards(this.end1.xcor(), this.end1.ycor(), this.end2.xcor(), this.end2.ycor());
    this.size = world.topology().distanceXY(this.end1.xcor(), this.end1.ycor(), this.end2.xcor(), this.end2.ycor());
    this.midpointx = world.topology().midpointx(this.end1.xcor(), this.end2.xcor());
    this.midpointy = world.topology().midpointy(this.end1.ycor(), this.end2.ycor());
    return updated.apply(null, [this].concat(__slice.call(linkBuiltins)));
  };

  Link.prototype.toString = function() {
    return "(" + this.breed.singular + " " + this.end1.id + " " + this.end2.id + ")";
  };

  return Link;

})();

World = (function() {
  var _links, _nextLinkId, _nextTurtleId, _patches, _patchesAllBlack, _ticks, _timer, _topology, _turtles, _turtlesById;

  _nextLinkId = 0;

  _nextTurtleId = 0;

  _turtles = [];

  _turtlesById = {};

  _patches = [];

  _links = [];

  _topology = null;

  _ticks = -1;

  _timer = Date.now();

  _patchesAllBlack = true;

  function World(minPxcor, maxPxcor, minPycor, maxPycor, patchSize, wrappingAllowedInY, wrappingAllowedInX, turtleShapeList, linkShapeList, interfaceGlobalCount) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
    this.patchSize = patchSize;
    this.wrappingAllowedInY = wrappingAllowedInY;
    this.wrappingAllowedInX = wrappingAllowedInX;
    this.interfaceGlobalCount = interfaceGlobalCount;
    Breeds.reset();
    AgentSet.reset();
    this.perspective = 0;
    this.targetAgent = null;
    collectUpdates();
    Updates.push({
      world: {
        0: {
          worldWidth: Math.abs(this.minPxcor - this.maxPxcor) + 1,
          worldHeight: Math.abs(this.minPycor - this.maxPycor) + 1,
          minPxcor: this.minPxcor,
          minPycor: this.minPycor,
          maxPxcor: this.maxPxcor,
          maxPycor: this.maxPycor,
          linkBreeds: "XXX IMPLEMENT ME",
          linkShapeList: linkShapeList,
          patchSize: this.patchSize,
          patchesAllBlack: _patchesAllBlack,
          patchesWithLabels: 0,
          ticks: _ticks,
          turtleBreeds: "XXX IMPLEMENT ME",
          turtleShapeList: turtleShapeList,
          unbreededLinksAreDirected: false,
          wrappingAllowedInX: this.wrappingAllowedInX,
          wrappingAllowedInY: this.wrappingAllowedInY
        }
      }
    });
    this.updatePerspective();
    this.resize(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
  }

  World.prototype.createPatches = function() {
    var nested, p, x, y, _i, _len, _ref2, _results;
    nested = (function() {
      var _i, _ref2, _ref3, _results;
      _results = [];
      for (y = _i = _ref2 = this.maxPycor, _ref3 = this.minPycor; _ref2 <= _ref3 ? _i <= _ref3 : _i >= _ref3; y = _ref2 <= _ref3 ? ++_i : --_i) {
        _results.push((function() {
          var _j, _ref4, _ref5, _results1;
          _results1 = [];
          for (x = _j = _ref4 = this.minPxcor, _ref5 = this.maxPxcor; _ref4 <= _ref5 ? _j <= _ref5 : _j >= _ref5; x = _ref4 <= _ref5 ? ++_j : --_j) {
            _results1.push(new Patch((this.width() * (this.maxPycor - y)) + x - this.minPxcor, x, y));
          }
          return _results1;
        }).call(this));
      }
      return _results;
    }).call(this);
    _patches = (_ref2 = []).concat.apply(_ref2, nested);
    _results = [];
    for (_i = 0, _len = _patches.length; _i < _len; _i++) {
      p = _patches[_i];
      _results.push(updated(p, "pxcor", "pycor", "pcolor", "plabel", "plabelcolor"));
    }
    return _results;
  };

  World.prototype.topology = function() {
    return _topology;
  };

  World.prototype.links = function() {
    return new Agents(_links.sort(Links.compare));
  };

  World.prototype.turtles = function() {
    return new Agents(_turtles, Breeds.get("TURTLES"));
  };

  World.prototype.turtlesOfBreed = function(breedName) {
    var breed;
    breed = Breeds.get(breedName);
    return new Agents(breed.members, breed);
  };

  World.prototype.patches = function() {
    return new Agents(_patches);
  };

  World.prototype.resetTimer = function() {
    return _timer = Date.now();
  };

  World.prototype.resetTicks = function() {
    _ticks = 0;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.clearTicks = function() {
    _ticks = -1;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.resize = function(minPxcor, maxPxcor, minPycor, maxPycor) {
    if (minPxcor > 0 || maxPxcor < 0 || minPycor > 0 || maxPycor < 0) {
      throw new NetLogoException("You must include the point (0, 0) in the world.");
    }
    this.clearAll();
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
    if (this.wrappingAllowedInX && this.wrappingAllowedInY) {
      _topology = new Torus(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    } else if (this.wrappingAllowedInX) {
      _topology = new VertCylinder(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    } else if (this.wrappingAllowedInY) {
      _topology = new HorzCylinder(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    } else {
      _topology = new Box(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    }
    this.createPatches();
    return Updates.push({
      world: {
        0: {
          worldWidth: Math.abs(this.minPxcor - this.maxPxcor) + 1,
          worldHeight: Math.abs(this.minPycor - this.maxPycor) + 1,
          minPxcor: this.minPxcor,
          minPycor: this.minPycor,
          maxPxcor: this.maxPxcor,
          maxPycor: this.maxPycor
        }
      }
    });
  };

  World.prototype.tick = function() {
    if (_ticks === -1) {
      throw new NetLogoException("The tick counter has not been started yet. Use RESET-TICKS.");
    }
    _ticks++;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.tickAdvance = function(n) {
    if (_ticks === -1) {
      throw new NetLogoException("The tick counter has not been started yet. Use RESET-TICKS.");
    }
    if (n < 0) {
      throw new NetLogoException("Cannot advance the tick counter by a negative amount.");
    }
    _ticks += n;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.timer = function() {
    return (Date.now() - _timer) / 1000;
  };

  World.prototype.ticks = function() {
    if (_ticks === -1) {
      throw new NetLogoException("The tick counter has not been started yet. Use RESET-TICKS.");
    }
    return _ticks;
  };

  World.prototype.width = function() {
    return 1 + this.maxPxcor - this.minPxcor;
  };

  World.prototype.height = function() {
    return 1 + this.maxPycor - this.minPycor;
  };

  World.prototype.getPatchAt = function(x, y) {
    var index;
    index = (this.maxPycor - StrictMath.round(y)) * this.width() + (StrictMath.round(x) - this.minPxcor);
    return _patches[index];
  };

  World.prototype.getTurtle = function(id) {
    return _turtlesById[id] || Nobody;
  };

  World.prototype.getTurtleOfBreed = function(breedName, id) {
    var turtle;
    turtle = this.getTurtle(id);
    if (turtle.breed.name === breedName) {
      return turtle;
    } else {
      return Nobody;
    }
  };

  World.prototype.removeLink = function(id) {
    _links = this.links().items.filter(function(l) {
      return l.id !== id;
    });
    if (_links.length === 0) {
      this.unbreededLinksAreDirected = false;
      Updates.push({
        world: {
          0: {
            unbreededLinksAreDirected: false
          }
        }
      });
    }
  };

  World.prototype.removeTurtle = function(id) {
    var turtle;
    turtle = _turtlesById[id];
    _turtles.splice(_turtles.indexOf(turtle), 1);
    return delete _turtlesById[id];
  };

  World.prototype.patchesAllBlack = function(val) {
    _patchesAllBlack = val;
    return Updates.push({
      world: {
        0: {
          patchesAllBlack: _patchesAllBlack
        }
      }
    });
  };

  World.prototype.clearAll = function() {
    var error, t, _i, _len, _ref2;
    Globals.clear(this.interfaceGlobalCount);
    _ref2 = this.turtles().items.slice(0);
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      t = _ref2[_i];
      try {
        t.die();
      } catch (_error) {
        error = _error;
        if (!(error instanceof DeathInterrupt)) {
          throw error;
        }
      }
    }
    this.createPatches();
    _nextTurtleId = 0;
    _nextLinkId = 0;
    this.patchesAllBlack(true);
    this.clearTicks();
  };

  World.prototype.createTurtle = function(t) {
    t.id = _nextTurtleId++;
    updated.apply(null, [t].concat(__slice.call(turtleBuiltins)));
    _turtles.push(t);
    _turtlesById[t.id] = t;
    return t;
  };

  World.prototype.createLink = function(directed, from, to) {
    var end1, end2, l;
    if (from.id < to.id || directed) {
      end1 = from;
      end2 = to;
    } else {
      end1 = to;
      end2 = from;
    }
    if (Nobody === this.getLink(end1.id, end2.id)) {
      l = new Link(_nextLinkId++, directed, end1, end2);
      updated.apply(null, [l].concat(__slice.call(linkBuiltins)));
      updated.apply(null, [l].concat(__slice.call(turtleBuiltins.slice(1))));
      _links.push(l);
      return l;
    } else {
      return Nobody;
    }
  };

  World.prototype.createOrderedTurtles = function(n, breedName) {
    var num;
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(this.createTurtle(new Turtle((10 * num + 5) % 140, (360 * num) / n, 0, 0, Breeds.get(breedName))));
      }
      return _results;
    }).call(this));
  };

  World.prototype.createTurtles = function(n, breedName) {
    var num;
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(this.createTurtle(new Turtle(5 + 10 * Random.nextInt(14), Random.nextInt(360), 0, 0, Breeds.get(breedName))));
      }
      return _results;
    }).call(this));
  };

  World.prototype.getNeighbors = function(pxcor, pycor) {
    return this.topology().getNeighbors(pxcor, pycor);
  };

  World.prototype.getNeighbors4 = function(pxcor, pycor) {
    return this.topology().getNeighbors4(pxcor, pycor);
  };

  World.prototype.createDirectedLink = function(from, to) {
    this.unbreededLinksAreDirected = true;
    Updates.push({
      world: {
        0: {
          unbreededLinksAreDirected: true
        }
      }
    });
    return this.createLink(true, from, to);
  };

  World.prototype.createDirectedLinks = function(source, others) {
    var t;
    this.unbreededLinksAreDirected = true;
    Updates.push({
      world: {
        0: {
          unbreededLinksAreDirected: true
        }
      }
    });
    return new Agents(((function() {
      var _i, _len, _ref2, _results;
      _ref2 = others.items;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        t = _ref2[_i];
        _results.push(this.createLink(true, source, t));
      }
      return _results;
    }).call(this)).filter(function(o) {
      return o !== Nobody;
    }), Breeds.get("LINKS"));
  };

  World.prototype.createReverseDirectedLinks = function(source, others) {
    var t;
    this.unbreededLinksAreDirected = true;
    Updates.push({
      world: {
        0: {
          unbreededLinksAreDirected: true
        }
      }
    });
    return new Agents(((function() {
      var _i, _len, _ref2, _results;
      _ref2 = others.items;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        t = _ref2[_i];
        _results.push(this.createLink(true, t, source));
      }
      return _results;
    }).call(this)).filter(function(o) {
      return o !== Nobody;
    }), Breeds.get("LINKS"));
  };

  World.prototype.createUndirectedLink = function(source, other) {
    return this.createLink(false, source, other);
  };

  World.prototype.createUndirectedLinks = function(source, others) {
    var t;
    return new Agents(((function() {
      var _i, _len, _ref2, _results;
      _ref2 = others.items;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        t = _ref2[_i];
        _results.push(this.createLink(false, source, t));
      }
      return _results;
    }).call(this)).filter(function(o) {
      return o !== Nobody;
    }), Breeds.get("LINKS"));
  };

  World.prototype.getLink = function(fromId, toId) {
    var filteredLinks;
    filteredLinks = this.links().items.filter(function(l) {
      return l.end1.id === fromId && l.end2.id === toId;
    });
    if (filteredLinks.length === 0) {
      return Nobody;
    } else {
      return filteredLinks[0];
    }
  };

  World.prototype.updatePerspective = function() {
    return Updates.push({
      observer: {
        0: {
          perspective: this.perspective,
          targetAgent: this.targetAgent
        }
      }
    });
  };

  World.prototype.watch = function(agent) {
    var agentId, agentKind;
    this.perspective = 3;
    agentKind = 0;
    agentId = -1;
    if (agent instanceof Turtle) {
      agentKind = 1;
      agentId = agent.id;
    } else if (agent instanceof Patch) {
      agentKind = 2;
      agentId = agent.id;
    }
    this.targetAgent = [agentKind, agentId];
    return this.updatePerspective();
  };

  World.prototype.resetPerspective = function() {
    this.perspective = 0;
    this.targetAgent = null;
    return this.updatePerspective();
  };

  return World;

})();

AgentSet = {
  count: function(x) {
    return x.items.length;
  },
  any: function(x) {
    return x.items.length > 0;
  },
  all: function(x, f) {
    var a, _i, _len, _ref2;
    _ref2 = x.items;
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      a = _ref2[_i];
      if (!this.askAgent(a, f)) {
        return false;
      }
    }
    return true;
  },
  _self: 0,
  _myself: 0,
  reset: function() {
    this._self = 0;
    return this._myself = 0;
  },
  self: function() {
    return this._self;
  },
  myself: function() {
    if (this._myself !== 0) {
      return this._myself;
    } else {
      throw new NetLogoException("There is no agent for MYSELF to refer to.");
    }
  },
  askAgent: function(a, f) {
    var error, oldAgent, oldMyself, res;
    oldMyself = this._myself;
    oldAgent = this._self;
    this._myself = this._self;
    this._self = a;
    try {
      res = f();
    } catch (_error) {
      error = _error;
      if (!(error instanceof DeathInterrupt)) {
        throw error;
      }
    }
    this._self = oldAgent;
    this._myself = oldMyself;
    return res;
  },
  ask: function(agentsOrAgent, shuffle, f) {
    var a, agents, iter;
    if (agentsOrAgent.items) {
      agents = agentsOrAgent.items;
    } else {
      agents = [agentsOrAgent];
    }
    iter = shuffle ? new Shufflerator(agents) : new Iterator(agents);
    while (iter.hasNext()) {
      a = iter.next();
      this.askAgent(a, f);
    }
    if (this._self.id && this._self.id === -1) {
      throw new DeathInterrupt;
    }
  },
  agentFilter: function(agents, f) {
    var a;
    return new Agents((function() {
      var _i, _len, _ref2, _results;
      _ref2 = agents.items;
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        a = _ref2[_i];
        if (this.askAgent(a, f)) {
          _results.push(a);
        }
      }
      return _results;
    }).call(this));
  },
  maxOneOf: function(agents, f) {
    var a, result, winners, winningValue, _i, _len, _ref2;
    winningValue = -Number.MAX_VALUE;
    winners = [];
    _ref2 = agents.items;
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      a = _ref2[_i];
      result = this.askAgent(a, f);
      if (result >= winningValue) {
        if (result > winningValue) {
          winningValue = result;
          winners = [];
        }
        winners.push(a);
      }
    }
    if (winners.length === 0) {
      return Nobody;
    } else {
      return winners[Random.nextInt(winners.length)];
    }
  },
  minOneOf: function(agents, f) {
    var a, result, winners, winningValue, _i, _len, _ref2;
    winningValue = Number.MAX_VALUE;
    winners = [];
    _ref2 = agents.items;
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      a = _ref2[_i];
      result = this.askAgent(a, f);
      if (result <= winningValue) {
        if (result < winningValue) {
          winningValue = result;
          winners = [];
        }
        winners.push(a);
      }
    }
    if (winners.length === 0) {
      return Nobody;
    } else {
      return winners[Random.nextInt(winners.length)];
    }
  },
  of: function(agentsOrAgent, f) {
    var a, agents, isagentset, iter, result;
    isagentset = agentsOrAgent.items;
    if (isagentset) {
      agents = agentsOrAgent.items;
    } else {
      agents = [agentsOrAgent];
    }
    result = [];
    iter = new Shufflerator(agents);
    while (iter.hasNext()) {
      a = iter.next();
      result.push(this.askAgent(a, f));
    }
    if (isagentset) {
      return result;
    } else {
      return result[0];
    }
  },
  oneOf: function(agentsOrList) {
    var isagentset, l;
    isagentset = agentsOrList.items;
    if (isagentset) {
      l = agentsOrList.items;
    } else {
      l = agentsOrList;
    }
    if (l.length === 0) {
      return Nobody;
    } else {
      return l[Random.nextInt(l.length)];
    }
  },
  nOf: function(resultSize, agentsOrList) {
    var i, index1, index2, items, j, result;
    items = agentsOrList.items;
    if (!items) {
      throw new Error("n-of not implemented on lists yet");
    }
    return new Agents((function() {
      var _ref2;
      switch (resultSize) {
        case 0:
          return [];
        case 1:
          return [items[Random.nextInt(items.length)]];
        case 2:
          index1 = Random.nextInt(items.length);
          index2 = Random.nextInt(items.length - 1);
          _ref2 = index2 >= index1 ? [index1, index2 + 1] : [index2, index1], index1 = _ref2[0], index2 = _ref2[1];
          return [items[index1], items[index2]];
        default:
          i = 0;
          j = 0;
          result = [];
          while (j < resultSize) {
            if (Random.nextInt(items.length - i) < resultSize - j) {
              result.push(items[i]);
              j += 1;
            }
            i += 1;
          }
          return result;
      }
    })());
  },
  turtlesOn: function(agentsOrAgent) {
    var agent, agents, turtles, _ref2;
    if (agentsOrAgent.items) {
      agents = agentsOrAgent.items;
    } else {
      agents = [agentsOrAgent];
    }
    turtles = (_ref2 = []).concat.apply(_ref2, (function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = agents.length; _i < _len; _i++) {
        agent = agents[_i];
        _results.push(agent.turtlesHere().items);
      }
      return _results;
    })());
    return new Agents(turtles, agentsOrAgent.breed);
  },
  die: function() {
    return this._self.die();
  },
  connectedLinks: function(directed, isSource) {
    return this._self.connectedLinks(directed, isSource);
  },
  linkNeighbors: function(directed, isSource) {
    return this._self.linkNeighbors(directed, isSource);
  },
  isLinkNeighbor: function(directed, isSource) {
    var t;
    t = this._self;
    return function(other) {
      return t.isLinkNeighbor(directed, isSource, other);
    };
  },
  findLinkViaNeighbor: function(directed, isSource) {
    var t;
    t = this._self;
    return function(other) {
      return t.findLinkViaNeighbor(directed, isSource, other);
    };
  },
  getTurtleVariable: function(n) {
    return this._self.getTurtleVariable(n);
  },
  setTurtleVariable: function(n, v) {
    return this._self.setTurtleVariable(n, v);
  },
  getLinkVariable: function(n) {
    return this._self.getLinkVariable(n);
  },
  setLinkVariable: function(n, v) {
    return this._self.setLinkVariable(n, v);
  },
  getBreedVariable: function(n) {
    return this._self.getBreedVariable(n);
  },
  setBreedVariable: function(n, v) {
    return this._self.setBreedVariable(n, v);
  },
  setBreed: function(agentSet) {
    return this._self.setBreed(agentSet.breed);
  },
  getPatchVariable: function(n) {
    return this._self.getPatchVariable(n);
  },
  setPatchVariable: function(n, v) {
    return this._self.setPatchVariable(n, v);
  },
  createLinkFrom: function(other) {
    return world.createDirectedLink(other, this._self);
  },
  createLinksFrom: function(others) {
    return world.createReverseDirectedLinks(this._self, this.shuffle(others));
  },
  createLinkTo: function(other) {
    return world.createDirectedLink(this._self, other);
  },
  createLinksTo: function(others) {
    return world.createDirectedLinks(this._self, this.shuffle(others));
  },
  createLinkWith: function(other) {
    return world.createUndirectedLink(this._self, other);
  },
  createLinksWith: function(others) {
    return world.createUndirectedLinks(this._self, this.shuffle(others));
  },
  other: function(agentSet) {
    var filteredAgents, self;
    self = this._self;
    filteredAgents = agentSet.items.filter(function(o) {
      return o !== self;
    });
    return new Agents(filteredAgents, agentSet.breed);
  },
  shuffle: function(agents) {
    var iter, result;
    result = [];
    iter = new Shufflerator(agents.items);
    while (iter.hasNext()) {
      result.push(iter.next());
    }
    return new Agents(result, agents.breed);
  }
};

Agents = (function() {
  function Agents(items, breed) {
    this.items = items;
    this.breed = breed;
  }

  Agents.prototype.toString = function() {
    return "(" + this.items.length + " " + this.breed.name + ")";
  };

  Agents.prototype.sort = function() {
    if (this.items.length === 0) {
      return this.items;
    } else if (this.items[0] instanceof Link) {
      return this.items.sort(Links.compare);
    } else {
      throw new Error("We don't know how to sort your kind here!");
    }
  };

  return Agents;

})();

Iterator = (function() {
  function Iterator(agents) {
    this.agents = agents;
    this.agents = this.agents.slice(0);
    this.i = 0;
  }

  Iterator.prototype.hasNext = function() {
    return this.i < this.agents.length;
  };

  Iterator.prototype.next = function() {
    var result;
    result = this.agents[this.i];
    this.i = this.i + 1;
    return result;
  };

  return Iterator;

})();

Shufflerator = (function() {
  function Shufflerator(agents) {
    this.agents = agents;
    this.agents = this.agents.slice(0);
    this.fetch();
  }

  Shufflerator.prototype.i = 0;

  Shufflerator.prototype.nextOne = null;

  Shufflerator.prototype.hasNext = function() {
    return this.nextOne !== null;
  };

  Shufflerator.prototype.next = function() {
    var result;
    result = this.nextOne;
    this.fetch();
    return result;
  };

  Shufflerator.prototype.fetch = function() {
    var r;
    if (this.i >= this.agents.length) {
      this.nextOne = null;
    } else {
      if (this.i < this.agents.length - 1) {
        r = this.i + Random.nextInt(this.agents.length - this.i);
        this.nextOne = this.agents[r];
        this.agents[r] = this.agents[this.i];
      } else {
        this.nextOne = this.agents[this.i];
      }
      this.i = this.i + 1;
    }
  };

  return Shufflerator;

})();

Prims = {
  fd: function(n) {
    return AgentSet.self().fd(n);
  },
  bk: function(n) {
    return AgentSet.self().fd(-n);
  },
  right: function(n) {
    return AgentSet.self().right(n);
  },
  left: function(n) {
    return AgentSet.self().right(-n);
  },
  setXY: function(x, y) {
    return AgentSet.self().setXY(x, y);
  },
  empty: function(l) {
    return l.length === 0;
  },
  getNeighbors: function() {
    return AgentSet.self().getNeighbors();
  },
  getNeighbors4: function() {
    return AgentSet.self().getNeighbors4();
  },
  sprout: function(n, breedName) {
    return AgentSet.self().sprout(n, breedName);
  },
  hatch: function(n, breedName) {
    return AgentSet.self().hatch(n, breedName);
  },
  patch: function(x, y) {
    return world.getPatchAt(x, y);
  },
  randomXcor: function() {
    return world.minPxcor - 0.5 + Random.nextDouble() * (world.maxPxcor - world.minPxcor + 1);
  },
  randomYcor: function() {
    return world.minPycor - 0.5 + Random.nextDouble() * (world.maxPycor - world.minPycor + 1);
  },
  shadeOf: function(c1, c2) {
    return Math.floor(c1 / 10) === Math.floor(c2 / 10);
  },
  equality: function(a, b) {
    if (a === void 0 || b === void 0) {
      throw new Error("Checking equality on undefined is an invalid condition");
    }
    if (a === b) {
      return true;
    } else if (typeIsArray(a) && typeIsArray(b)) {
      return a.length === b.length && a.every(function(elem, i) {
        return Prims.equality(elem, b[i]);
      });
    } else if (a instanceof Agents && b instanceof Agents) {
      return a.items.length === b.items.length && a.items.every(function(elem) {
        return __indexOf.call(b.items, elem) >= 0;
      });
    } else {
      return false;
    }
  },
  scaleColor: function(color, number, min, max) {
    var perc, tempmax, tempval;
    color = Math.floor(color / 10) * 10;
    perc = 0.0;
    if (min > max) {
      if (number < max) {
        perc = 1.0;
      } else if (number > min) {
        perc = 0.0;
      } else {
        tempval = min - number;
        tempmax = min - max;
        perc = tempval / tempmax;
      }
    } else {
      if (number > max) {
        perc = 1.0;
      } else if (number < min) {
        perc = 0.0;
      } else {
        tempval = number - min;
        tempmax = max - min;
        perc = tempval / tempmax;
      }
    }
    perc *= 10;
    if (perc >= 9.9999) {
      perc = 9.9999;
    }
    if (perc < 0) {
      perc = 0;
    }
    return color + perc;
  },
  random: function(n) {
    var truncated;
    truncated = n >= 0 ? Math.floor(n) : Math.ceil(n);
    if (truncated === 0) {
      return 0;
    } else if (truncated > 0) {
      return Random.nextLong(truncated);
    } else {
      return -Random.nextLong(-truncated);
    }
  },
  randomFloat: function(n) {
    return n * Random.nextDouble();
  },
  list: function() {
    var xs;
    xs = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return xs;
  },
  item: function(n, xs) {
    return xs[n];
  },
  first: function(xs) {
    return xs[0];
  },
  last: function(xs) {
    return xs[xs.length - 1];
  },
  fput: function(x, xs) {
    return [x].concat(xs);
  },
  lput: function(x, xs) {
    var result;
    result = xs.slice(0);
    result.push(x);
    return result;
  },
  butFirst: function(xs) {
    return xs.slice(1);
  },
  butLast: function(xs) {
    return xs.slice(0, xs.length - 1);
  },
  length: function(xs) {
    return xs.length;
  },
  _int: function(n) {
    if (n < 0) {
      return Math.ceil(n);
    } else {
      return Math.floor(n);
    }
  },
  mod: function(a, b) {
    return ((a % b) + b) % b;
  },
  max: function(xs) {
    return Math.max.apply(Math, xs);
  },
  min: function(xs) {
    return Math.min.apply(Math, xs);
  },
  mean: function(xs) {
    return this.sum(xs) / xs.length;
  },
  sum: function(xs) {
    return xs.reduce((function(a, b) {
      return a + b;
    }), 0);
  },
  precision: function(n, places) {
    var multiplier, result;
    multiplier = Math.pow(10, places);
    result = Math.floor(n * multiplier + .5) / multiplier;
    if (places > 0) {
      return result;
    } else {
      return Math.round(result);
    }
  },
  sort: function(xs) {
    return xs.sort();
  },
  removeDuplicates: function(xs) {
    var result, seen, x, _i, _len;
    result = [];
    seen = {};
    for (_i = 0, _len = xs.length; _i < _len; _i++) {
      x = xs[_i];
      if (seen[x] == null) {
        seen[x] = x;
        result.push(x);
      }
    }
    return result;
  },
  outputPrint: function(x) {
    return println(Dump(x));
  },
  patchSet: function() {
    var inputs, recurse, result;
    inputs = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    result = [];
    recurse = function(inputs) {
      var agent, input, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = inputs.length; _i < _len; _i++) {
        input = inputs[_i];
        if (typeIsArray(input)) {
          _results.push(recurse(input));
        } else if (input instanceof Patch) {
          _results.push(result.push(input));
        } else {
          _results.push((function() {
            var _j, _len1, _ref2, _results1;
            _ref2 = input.items;
            _results1 = [];
            for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
              agent = _ref2[_j];
              if (!(__indexOf.call(result, agent) >= 0)) {
                _results1.push(result.push(agent));
              } else {
                _results1.push(void 0);
              }
            }
            return _results1;
          })());
        }
      }
      return _results;
    };
    recurse(inputs);
    return new Agents(result);
  },
  repeat: function(n, fn) {
    var i, _i;
    for (i = _i = 0; 0 <= n ? _i < n : _i > n; i = 0 <= n ? ++_i : --_i) {
      fn();
    }
  }
};

Globals = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= n ? _i < n : _i > n; x = 0 <= n ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  },
  clear: function(n) {
    var i, _i, _ref2;
    for (i = _i = n, _ref2 = this.vars.length; n <= _ref2 ? _i < _ref2 : _i > _ref2; i = n <= _ref2 ? ++_i : --_i) {
      this.vars[i] = 0;
    }
  },
  getGlobal: function(n) {
    return this.vars[n];
  },
  setGlobal: function(n, v) {
    return this.vars[n] = v;
  }
};

TurtlesOwn = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= n ? _i < n : _i > n; x = 0 <= n ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  }
};

PatchesOwn = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= n ? _i < n : _i > n; x = 0 <= n ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  }
};

Dump = function(x) {
  var x2;
  if (typeIsArray(x)) {
    return "[" + ((function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = x.length; _i < _len; _i++) {
        x2 = x[_i];
        _results.push(Dump(x2));
      }
      return _results;
    })()).join(" ") + "]";
  } else {
    return "" + x;
  }
};

Trig = {
  squash: function(x) {
    if (StrictMath.abs(x) < 3.2e-15) {
      return 0;
    } else {
      return x;
    }
  },
  sin: function(degrees) {
    return this.squash(StrictMath.sin(StrictMath.toRadians(degrees)));
  },
  cos: function(degrees) {
    return this.squash(StrictMath.cos(StrictMath.toRadians(degrees)));
  },
  unsquashedSin: function(degrees) {
    return StrictMath.sin(StrictMath.toRadians(degrees));
  },
  unsquashedCos: function(degrees) {
    return StrictMath.cos(StrictMath.toRadians(degrees));
  },
  atan: function(d1, d2) {
    if (d1 === 0 && d2 === 0) {
      throw new NetLogoException("Runtime error: atan is undefined when both inputs are zero.");
    }
    if (d1 === 0) {
      if (d2 > 0) {
        return 0;
      } else {
        return 180;
      }
    } else if (d2 === 0) {
      if (d1 > 0) {
        return 90;
      } else {
        return 270;
      }
    } else {
      return (StrictMath.toDegrees(StrictMath.atan2(d1, d2)) + 360) % 360;
    }
  }
};

Breed = (function() {
  function Breed(name, singular, _shape, members) {
    this.name = name;
    this.singular = singular;
    this._shape = _shape != null ? _shape : false;
    this.members = members != null ? members : [];
  }

  Breed.prototype.shape = function() {
    if (this._shape) {
      return this._shape;
    } else {
      return Breeds.get("TURTLES")._shape;
    }
  };

  Breed.prototype.vars = [];

  Breed.prototype.add = function(agent) {
    var a, i, _i, _len, _ref2;
    _ref2 = this.members;
    for (i = _i = 0, _len = _ref2.length; _i < _len; i = ++_i) {
      a = _ref2[i];
      if (a.id > agent.id) {
        break;
      }
    }
    return this.members.splice(i, 0, agent);
  };

  Breed.prototype.remove = function(agent) {
    return this.members.splice(this.members.indexOf(agent), 1);
  };

  return Breed;

})();

Breeds = {
  defaultBreeds: function() {
    return {
      TURTLES: new Breed("TURTLES", "turtle", "default"),
      LINKS: new Breed("LINKS", "link", "default")
    };
  },
  breeds: {},
  reset: function() {
    return this.breeds = this.defaultBreeds();
  },
  add: function(name, singular) {
    return this.breeds[name] = new Breed(name, singular);
  },
  get: function(name) {
    return this.breeds[name];
  },
  setDefaultShape: function(agents, shape) {
    return agents.breed._shape = shape.toLowerCase();
  }
};

Topology = (function() {
  function Topology() {}

  Topology.prototype.wrap = function(pos, min, max) {
    var result;
    if (pos >= max) {
      return min + ((pos - max) % (max - min));
    } else if (pos < min) {
      result = max - ((min - pos) % (max - min));
      if (result < max) {
        return result;
      } else {
        return min;
      }
    } else {
      return pos;
    }
  };

  Topology.prototype.getNeighbors = function(pxcor, pycor) {
    var patch;
    return new Agents((function() {
      var _i, _len, _ref2, _results;
      _ref2 = this._getNeighbors(pxcor, pycor);
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        patch = _ref2[_i];
        if (patch !== false) {
          _results.push(patch);
        }
      }
      return _results;
    }).call(this));
  };

  Topology.prototype._getNeighbors = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor && pxcor === this.minPxcor) {
      if ((pycor === this.maxPycor && pycor === this.minPycor)([])) {

      } else {
        return [this.getPatchNorth(pxcor, pycor), this.getPatchSouth(pxcor, pycor)];
      }
    } else if (pycor === this.maxPycor && pycor === this.minPycor) {
      return [this.getPatchEast(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    } else {
      return [this.getPatchNorth(pxcor, pycor), this.getPatchEast(pxcor, pycor), this.getPatchSouth(pxcor, pycor), this.getPatchWest(pxcor, pycor), this.getPatchNorthEast(pxcor, pycor), this.getPatchSouthEast(pxcor, pycor), this.getPatchSouthWest(pxcor, pycor), this.getPatchNorthWest(pxcor, pycor)];
    }
  };

  Topology.prototype.getNeighbors4 = function(pxcor, pycor) {
    var patch;
    return new Agents((function() {
      var _i, _len, _ref2, _results;
      _ref2 = this._getNeighbors4(pxcor, pycor);
      _results = [];
      for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
        patch = _ref2[_i];
        if (patch !== false) {
          _results.push(patch);
        }
      }
      return _results;
    }).call(this));
  };

  Topology.prototype._getNeighbors4 = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor && pxcor === this.minPxcor) {
      if ((pycor === this.maxPycor && pycor === this.minPycor)([])) {

      } else {
        return [this.getPatchNorth(pxcor, pycor), this.getPatchSouth(pxcor, pycor)];
      }
    } else if (pycor === this.maxPycor && pycor === this.minPycor) {
      return [this.getPatchEast(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    } else {
      return [this.getPatchNorth(pxcor, pycor), this.getPatchEast(pxcor, pycor), this.getPatchSouth(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    }
  };

  Topology.prototype.distanceXY = function(x1, y1, x2, y2) {
    return StrictMath.sqrt(StrictMath.pow(this.shortestX(x1, x2), 2) + StrictMath.pow(this.shortestY(y1, y2), 2));
  };

  Topology.prototype.distance = function(x1, y1, agent) {
    if (agent instanceof Turtle) {
      return this.distanceXY(x1, y1, agent.xcor(), agent.ycor());
    } else if (agent instanceof Patch) {
      return this.distanceXY(x1, y1, agent.pxcor, agent.pycor);
    }
  };

  Topology.prototype.towards = function(x1, y1, x2, y2) {
    var dx, dy;
    dx = this.shortestX(x1, x2);
    dy = this.shortestY(y1, y2);
    if (dx === 0) {
      if (dy >= 0) {
        return 0;
      } else {
        return 180;
      }
    } else if (dy === 0) {
      if (dx >= 0) {
        return 90;
      } else {
        return 270;
      }
    } else {
      return (270 + StrictMath.toDegrees(Math.PI + StrictMath.atan2(-dy, dx))) % 360;
    }
  };

  Topology.prototype.midpointx = function(x1, x2) {
    return this.wrap((x1 + (x1 + this.shortestX(x1, x2))) / 2, world.minPxcor - 0.5, world.maxPxcor + 0.5);
  };

  Topology.prototype.midpointy = function(y1, y2) {
    return this.wrap((y1 + (y1 + this.shortestY(y1, y2))) / 2, world.minPycor - 0.5, world.maxPycor + 0.5);
  };

  Topology.prototype.inRadius = function(origin, x, y, agents, radius) {
    var dx, dy, height, maxDX, maxDY, minDX, minDY, p, r, result, t, width, _i, _j, _k, _len, _ref2;
    result = [];
    r = Math.ceil(radius);
    width = world.width() / 2;
    height = world.height() / 2;
    if (r < width || !world.wrappingAllowedInX) {
      minDX = -r;
      maxDX = r;
    } else {
      maxDX = StrictMath.floor(width);
      minDX = -Math.ceil(width - 1);
    }
    if (r < height || !world.wrappingAllowedInY) {
      minDY = -r;
      maxDY = r;
    } else {
      maxDY = StrictMath.floor(height);
      minDY = -Math.ceil(height - 1);
    }
    for (dy = _i = minDY; minDY <= maxDY ? _i <= maxDY : _i >= maxDY; dy = minDY <= maxDY ? ++_i : --_i) {
      for (dx = _j = minDX; minDX <= maxDX ? _j <= maxDX : _j >= maxDX; dx = minDX <= maxDX ? ++_j : --_j) {
        p = origin.patchAt(dx, dy);
        if (p !== Nobody) {
          if (this.distanceXY(p.pxcor, p.pycor, x, y) <= radius && agents.items.filter(function(o) {
            return o === p;
          }).length > 0) {
            result.push(p);
          }
          _ref2 = p.turtlesHere().items;
          for (_k = 0, _len = _ref2.length; _k < _len; _k++) {
            t = _ref2[_k];
            if (this.distanceXY(t.xcor(), t.ycor(), x, y) <= radius && agents.items.filter(function(o) {
              return o === t;
            }).length > 0) {
              result.push(t);
            }
          }
        }
      }
    }
    return new Agents(result, agents.breed);
  };

  return Topology;

})();

Torus = (function(_super) {
  __extends(Torus, _super);

  function Torus(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  Torus.prototype.wrapX = function(pos) {
    return this.wrap(pos, this.minPxcor - 0.5, this.maxPxcor + 0.5);
  };

  Torus.prototype.wrapY = function(pos) {
    return this.wrap(pos, this.minPycor - 0.5, this.maxPycor + 0.5);
  };

  Torus.prototype.shortestX = function(x1, x2) {
    if (StrictMath.abs(x1 - x2) > world.width() / 2) {
      return (world.width() - StrictMath.abs(x1 - x2)) * (x2 > x1 ? -1 : 1);
    } else {
      return Math.abs(x1 - x2) * (x1 > x2 ? -1 : 1);
    }
  };

  Torus.prototype.shortestY = function(y1, y2) {
    if (StrictMath.abs(y1 - y2) > world.height() / 2) {
      return (world.height() - StrictMath.abs(y1 - y2)) * (y2 > y1 ? -1 : 1);
    } else {
      return Math.abs(y1 - y2) * (y1 > y2 ? -1 : 1);
    }
  };

  Torus.prototype.diffuse = function(vn, amount) {
    var diffusalSum, diffusallyOrderedNeighbors, n, patch, pxcor, pycor, scratch, x, _i, _j, _len, _len1, _ref2, _ref3, _results;
    scratch = (function() {
      var _i, _ref2, _results;
      _results = [];
      for (x = _i = 0, _ref2 = world.width(); 0 <= _ref2 ? _i < _ref2 : _i > _ref2; x = 0 <= _ref2 ? ++_i : --_i) {
        _results.push([]);
      }
      return _results;
    })();
    _ref2 = world.patches().items;
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      patch = _ref2[_i];
      scratch[patch.pxcor - this.minPxcor][patch.pycor - this.minPycor] = patch.getPatchVariable(vn);
    }
    _ref3 = world.patches().items;
    _results = [];
    for (_j = 0, _len1 = _ref3.length; _j < _len1; _j++) {
      patch = _ref3[_j];
      pxcor = patch.pxcor;
      pycor = patch.pycor;
      diffusallyOrderedNeighbors = [this.getPatchSouthWest(pxcor, pycor), this.getPatchWest(pxcor, pycor), this.getPatchNorthWest(pxcor, pycor), this.getPatchSouth(pxcor, pycor), this.getPatchNorth(pxcor, pycor), this.getPatchSouthEast(pxcor, pycor), this.getPatchEast(pxcor, pycor), this.getPatchNorthEast(pxcor, pycor)];
      diffusalSum = ((function() {
        var _k, _len2, _results1;
        _results1 = [];
        for (_k = 0, _len2 = diffusallyOrderedNeighbors.length; _k < _len2; _k++) {
          n = diffusallyOrderedNeighbors[_k];
          _results1.push(scratch[n.pxcor - this.minPxcor][n.pycor - this.minPycor]);
        }
        return _results1;
      }).call(this)).reduce(function(a, b) {
        return a + b;
      });
      _results.push(patch.setPatchVariable(vn, patch.getPatchVariable(vn) * (1.0 - amount) + (diffusalSum / 8) * amount));
    }
    return _results;
  };

  Torus.prototype.getPatchNorth = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      return world.getPatchAt(pxcor, this.minPycor);
    } else {
      return world.getPatchAt(pxcor, pycor + 1);
    }
  };

  Torus.prototype.getPatchSouth = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      return world.getPatchAt(pxcor, this.maxPycor);
    } else {
      return world.getPatchAt(pxcor, pycor - 1);
    }
  };

  Torus.prototype.getPatchEast = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor + 1, pycor);
    }
  };

  Torus.prototype.getPatchWest = function(pxcor, pycor) {
    if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor - 1, pycor);
    }
  };

  Torus.prototype.getPatchNorthWest = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      if (pxcor === this.minPxcor) {
        return world.getPatchAt(this.maxPxcor, this.minPycor);
      } else {
        return world.getPatchAt(pxcor - 1, this.minPycor);
      }
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor + 1);
    }
  };

  Torus.prototype.getPatchSouthWest = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      if (pxcor === this.minPxcor) {
        return world.getPatchAt(this.maxPxcor, this.maxPycor);
      } else {
        return world.getPatchAt(pxcor - 1, this.maxPycor);
      }
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor - 1);
    }
  };

  Torus.prototype.getPatchSouthEast = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      if (pxcor === this.maxPxcor) {
        return world.getPatchAt(this.minPxcor, this.maxPycor);
      } else {
        return world.getPatchAt(pxcor + 1, this.maxPycor);
      }
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor - 1);
    }
  };

  Torus.prototype.getPatchNorthEast = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      if (pxcor === this.maxPxcor) {
        return world.getPatchAt(this.minPxcor, this.minPycor);
      } else {
        return world.getPatchAt(pxcor + 1, this.minPycor);
      }
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor + 1);
    }
  };

  return Torus;

})(Topology);

VertCylinder = (function(_super) {
  __extends(VertCylinder, _super);

  function VertCylinder(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  VertCylinder.prototype.shortestX = function(x1, x2) {
    if (StrictMath.abs(x1 - x2) > (1 + this.maxPxcor - this.minPxcor) / 2) {
      return (world.width() - StrictMath.abs(x1 - x2)) * (x2 > x1 ? -1 : 1);
    } else {
      return Math.abs(x1 - x2) * (x1 > x2 ? -1 : 1);
    }
  };

  VertCylinder.prototype.shortestY = function(y1, y2) {
    return Math.abs(y1 - y2) * (y1 > y2 ? -1 : 1);
  };

  VertCylinder.prototype.wrapX = function(pos) {
    return this.wrap(pos, this.minPxcor - 0.5, this.maxPxcor + 0.5);
  };

  VertCylinder.prototype.wrapY = function(pos) {
    if (pos >= this.maxPycor + 0.5 || pos <= this.minPycor - 0.5) {
      throw new TopologyInterrupt("Cannot move turtle beyond the world's edge.");
    } else {
      return pos;
    }
  };

  VertCylinder.prototype.getPatchNorth = function(pxcor, pycor) {
    return (pycor !== this.maxPycor) && world.getPatchAt(pxcor, pycor + 1);
  };

  VertCylinder.prototype.getPatchSouth = function(pxcor, pycor) {
    return (pycor !== this.minPycor) && world.getPatchAt(pxcor, pycor - 1);
  };

  VertCylinder.prototype.getPatchEast = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor + 1, pycor);
    }
  };

  VertCylinder.prototype.getPatchWest = function(pxcor, pycor) {
    if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor - 1, pycor);
    }
  };

  VertCylinder.prototype.getPatchNorthWest = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      return false;
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor + 1);
    }
  };

  VertCylinder.prototype.getPatchSouthWest = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      return false;
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor - 1);
    }
  };

  VertCylinder.prototype.getPatchSouthEast = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      return false;
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor - 1);
    }
  };

  VertCylinder.prototype.getPatchNorthEast = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      return false;
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor + 1);
    }
  };

  VertCylinder.prototype.diffuse = function(vn, amount) {
    var diffuseVal, scratch, scratch2, x, xx, y, yy, _i, _j, _k, _ref2, _ref3, _results;
    yy = world.height();
    xx = world.width();
    scratch = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).getPatchVariable(vn));
          }
          return _results1;
        }).call(this));
      }
      return _results;
    }).call(this);
    scratch2 = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(0);
          }
          return _results1;
        })());
      }
      return _results;
    })();
    for (y = _i = yy, _ref2 = yy * 2; yy <= _ref2 ? _i < _ref2 : _i > _ref2; y = yy <= _ref2 ? ++_i : --_i) {
      for (x = _j = xx, _ref3 = xx * 2; xx <= _ref3 ? _j < _ref3 : _j > _ref3; x = xx <= _ref3 ? ++_j : --_j) {
        diffuseVal = (scratch[x - xx][y - yy] / 8) * amount;
        if (y > yy && y < (yy * 2) - 1) {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (8 * diffuseVal);
          scratch2[(x - 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x - 1) % xx][y % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][y % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y + 1) % yy] += diffuseVal;
        } else if (y === yy) {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (5 * diffuseVal);
          scratch2[(x - 1) % xx][y % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y + 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][y % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y + 1) % yy] += diffuseVal;
        } else {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (5 * diffuseVal);
          scratch2[(x - 1) % xx][y % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[x % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][y % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y - 1) % yy] += diffuseVal;
        }
      }
    }
    _results = [];
    for (y = _k = 0; 0 <= yy ? _k < yy : _k > yy; y = 0 <= yy ? ++_k : --_k) {
      _results.push((function() {
        var _l, _results1;
        _results1 = [];
        for (x = _l = 0; 0 <= xx ? _l < xx : _l > xx; x = 0 <= xx ? ++_l : --_l) {
          _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).setPatchVariable(vn, scratch2[x][y]));
        }
        return _results1;
      }).call(this));
    }
    return _results;
  };

  return VertCylinder;

})(Topology);

HorzCylinder = (function(_super) {
  __extends(HorzCylinder, _super);

  function HorzCylinder(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  HorzCylinder.prototype.shortestX = function(x1, x2) {
    return Math.abs(x1 - x2) * (x1 > x2 ? -1 : 1);
  };

  HorzCylinder.prototype.shortestY = function(y1, y2) {
    if (StrictMath.abs(y1 - y2) > (1 + this.maxPycor - this.minPycor) / 2) {
      return (world.height() - Math.abs(y1 - y2)) * (y2 > y1 ? -1 : 1);
    } else {
      return Math.abs(y1 - y2) * (y1 > y2 ? -1 : 1);
    }
  };

  HorzCylinder.prototype.wrapX = function(pos) {
    if (pos >= this.maxPxcor + 0.5 || pos <= this.minPxcor - 0.5) {
      throw new TopologyInterrupt("Cannot move turtle beyond the world's edge.");
    } else {
      return pos;
    }
  };

  HorzCylinder.prototype.wrapY = function(pos) {
    return this.wrap(pos, this.minPycor - 0.5, this.maxPycor + 0.5);
  };

  HorzCylinder.prototype.getPatchEast = function(pxcor, pycor) {
    return (pxcor !== this.maxPxcor) && world.getPatchAt(pxcor + 1, pycor);
  };

  HorzCylinder.prototype.getPatchWest = function(pxcor, pycor) {
    return (pxcor !== this.minPxcor) && world.getPatchAt(pxcor - 1, pycor);
  };

  HorzCylinder.prototype.getPatchNorth = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      return world.getPatchAt(pxcor, this.minPycor);
    } else {
      return world.getPatchAt(pxcor, pycor + 1);
    }
  };

  HorzCylinder.prototype.getPatchSouth = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      return world.getPatchAt(pxcor, this.maxPycor);
    } else {
      return world.getPatchAt(pxcor, pycor - 1);
    }
  };

  HorzCylinder.prototype.getPatchNorthWest = function(pxcor, pycor) {
    if (pxcor === this.minPxcor) {
      return false;
    } else if (pycor === this.maxPycor) {
      return world.getPatchAt(pxcor - 1, this.minPycor);
    } else {
      return world.getPatchAt(pxcor - 1, pycor + 1);
    }
  };

  HorzCylinder.prototype.getPatchSouthWest = function(pxcor, pycor) {
    if (pxcor === this.minPxcor) {
      return false;
    } else if (pycor === this.minPycor) {
      return world.getPatchAt(pxcor - 1, this.maxPycor);
    } else {
      return world.getPatchAt(pxcor - 1, pycor - 1);
    }
  };

  HorzCylinder.prototype.getPatchSouthEast = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor) {
      return false;
    } else if (pycor === this.minPycor) {
      return world.getPatchAt(pxcor + 1, this.maxPycor);
    } else {
      return world.getPatchAt(pxcor + 1, pycor - 1);
    }
  };

  HorzCylinder.prototype.getPatchNorthEast = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor) {
      return false;
    } else if (pycor === this.maxPycor) {
      return world.getPatchAt(pxcor + 1, this.minPycor);
    } else {
      return world.getPatchAt(pxcor + 1, pycor + 1);
    }
  };

  HorzCylinder.prototype.diffuse = function(vn, amount) {
    var diffuseVal, scratch, scratch2, x, xx, y, yy, _i, _j, _k, _ref2, _ref3, _results;
    yy = world.height();
    xx = world.width();
    scratch = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).getPatchVariable(vn));
          }
          return _results1;
        }).call(this));
      }
      return _results;
    }).call(this);
    scratch2 = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(0);
          }
          return _results1;
        })());
      }
      return _results;
    })();
    for (y = _i = yy, _ref2 = yy * 2; yy <= _ref2 ? _i < _ref2 : _i > _ref2; y = yy <= _ref2 ? ++_i : --_i) {
      for (x = _j = xx, _ref3 = xx * 2; xx <= _ref3 ? _j < _ref3 : _j > _ref3; x = xx <= _ref3 ? ++_j : --_j) {
        diffuseVal = (scratch[x - xx][y - yy] / 8) * amount;
        if (x > xx && x < (xx * 2) - 1) {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (8 * diffuseVal);
          scratch2[(x - 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x - 1) % xx][y % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][y % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y + 1) % yy] += diffuseVal;
        } else if (x === xx) {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (5 * diffuseVal);
          scratch2[x % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x + 1) % xx][y % yy] += diffuseVal;
          scratch2[(x + 1) % xx][(y + 1) % yy] += diffuseVal;
        } else {
          scratch2[x - xx][y - yy] += scratch[x - xx][y - yy] - (5 * diffuseVal);
          scratch2[x % xx][(y + 1) % yy] += diffuseVal;
          scratch2[x % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y - 1) % yy] += diffuseVal;
          scratch2[(x - 1) % xx][y % yy] += diffuseVal;
          scratch2[(x - 1) % xx][(y + 1) % yy] += diffuseVal;
        }
      }
    }
    _results = [];
    for (y = _k = 0; 0 <= yy ? _k < yy : _k > yy; y = 0 <= yy ? ++_k : --_k) {
      _results.push((function() {
        var _l, _results1;
        _results1 = [];
        for (x = _l = 0; 0 <= xx ? _l < xx : _l > xx; x = 0 <= xx ? ++_l : --_l) {
          _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).setPatchVariable(vn, scratch2[x][y]));
        }
        return _results1;
      }).call(this));
    }
    return _results;
  };

  return HorzCylinder;

})(Topology);

Box = (function(_super) {
  __extends(Box, _super);

  function Box(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  Box.prototype.shortestX = function(x1, x2) {
    return Math.abs(x1 - x2) * (x1 > x2 ? -1 : 1);
  };

  Box.prototype.shortestY = function(y1, y2) {
    return Math.abs(y1 - y2) * (y1 > y2 ? -1 : 1);
  };

  Box.prototype.wrapX = function(pos) {
    if (pos >= this.maxPxcor + 0.5 || pos <= this.minPxcor - 0.5) {
      throw new TopologyInterrupt("Cannot move turtle beyond the worlds edge.");
    } else {
      return pos;
    }
  };

  Box.prototype.wrapY = function(pos) {
    if (pos >= this.maxPycor + 0.5 || pos <= this.minPycor - 0.5) {
      throw new TopologyInterrupt("Cannot move turtle beyond the worlds edge.");
    } else {
      return pos;
    }
  };

  Box.prototype.getPatchNorth = function(pxcor, pycor) {
    return (pycor !== this.maxPycor) && world.getPatchAt(pxcor, pycor + 1);
  };

  Box.prototype.getPatchSouth = function(pxcor, pycor) {
    return (pycor !== this.minPycor) && world.getPatchAt(pxcor, pycor - 1);
  };

  Box.prototype.getPatchEast = function(pxcor, pycor) {
    return (pxcor !== this.maxPxcor) && world.getPatchAt(pxcor + 1, pycor);
  };

  Box.prototype.getPatchWest = function(pxcor, pycor) {
    return (pxcor !== this.minPxcor) && world.getPatchAt(pxcor - 1, pycor);
  };

  Box.prototype.getPatchNorthWest = function(pxcor, pycor) {
    return (pycor !== this.maxPycor) && (pxcor !== this.minPxcor) && world.getPatchAt(pxcor - 1, pycor + 1);
  };

  Box.prototype.getPatchSouthWest = function(pxcor, pycor) {
    return (pycor !== this.minPycor) && (pxcor !== this.minPxcor) && world.getPatchAt(pxcor - 1, pycor - 1);
  };

  Box.prototype.getPatchSouthEast = function(pxcor, pycor) {
    return (pycor !== this.minPycor) && (pxcor !== this.maxPxcor) && world.getPatchAt(pxcor + 1, pycor - 1);
  };

  Box.prototype.getPatchNorthEast = function(pxcor, pycor) {
    return (pycor !== this.maxPycor) && (pxcor !== this.maxPxcor) && world.getPatchAt(pxcor + 1, pycor + 1);
  };

  Box.prototype.diffuse = function(vn, amount) {
    var diffuseVal, scratch, scratch2, x, xx, y, yy, _i, _j, _k, _results;
    yy = world.height();
    xx = world.width();
    scratch = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).getPatchVariable(vn));
          }
          return _results1;
        }).call(this));
      }
      return _results;
    }).call(this);
    scratch2 = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= xx ? _i < xx : _i > xx; x = 0 <= xx ? ++_i : --_i) {
        _results.push((function() {
          var _j, _results1;
          _results1 = [];
          for (y = _j = 0; 0 <= yy ? _j < yy : _j > yy; y = 0 <= yy ? ++_j : --_j) {
            _results1.push(0);
          }
          return _results1;
        })());
      }
      return _results;
    })();
    for (y = _i = 0; 0 <= yy ? _i < yy : _i > yy; y = 0 <= yy ? ++_i : --_i) {
      for (x = _j = 0; 0 <= xx ? _j < xx : _j > xx; x = 0 <= xx ? ++_j : --_j) {
        diffuseVal = (scratch[x][y] / 8) * amount;
        if (y > 0 && y < yy - 1 && x > 0 && x < xx - 1) {
          scratch2[x][y] += scratch[x][y] - (8 * diffuseVal);
          scratch2[x - 1][y - 1] += diffuseVal;
          scratch2[x - 1][y] += diffuseVal;
          scratch2[x - 1][y + 1] += diffuseVal;
          scratch2[x][y + 1] += diffuseVal;
          scratch2[x][y - 1] += diffuseVal;
          scratch2[x + 1][y - 1] += diffuseVal;
          scratch2[x + 1][y] += diffuseVal;
          scratch2[x + 1][y + 1] += diffuseVal;
        } else if (y > 0 && y < yy - 1) {
          if (x === 0) {
            scratch2[x][y] += scratch[x][y] - (5 * diffuseVal);
            scratch2[x][y + 1] += diffuseVal;
            scratch2[x][y - 1] += diffuseVal;
            scratch2[x + 1][y - 1] += diffuseVal;
            scratch2[x + 1][y] += diffuseVal;
            scratch2[x + 1][y + 1] += diffuseVal;
          } else {
            scratch2[x][y] += scratch[x][y] - (5 * diffuseVal);
            scratch2[x][y + 1] += diffuseVal;
            scratch2[x][y - 1] += diffuseVal;
            scratch2[x - 1][y - 1] += diffuseVal;
            scratch2[x - 1][y] += diffuseVal;
            scratch2[x - 1][y + 1] += diffuseVal;
          }
        } else if (x > 0 && x < xx - 1) {
          if (y === 0) {
            scratch2[x][y] += scratch[x][y] - (5 * diffuseVal);
            scratch2[x - 1][y] += diffuseVal;
            scratch2[x - 1][y + 1] += diffuseVal;
            scratch2[x][y + 1] += diffuseVal;
            scratch2[x + 1][y] += diffuseVal;
            scratch2[x + 1][y + 1] += diffuseVal;
          } else {
            scratch2[x][y] += scratch[x][y] - (5 * diffuseVal);
            scratch2[x - 1][y] += diffuseVal;
            scratch2[x - 1][y - 1] += diffuseVal;
            scratch2[x][y - 1] += diffuseVal;
            scratch2[x + 1][y] += diffuseVal;
            scratch2[x + 1][y - 1] += diffuseVal;
          }
        } else if (x === 0) {
          if (y === 0) {
            scratch2[x][y] += scratch[x][y] - (3 * diffuseVal);
            scratch2[x][y + 1] += diffuseVal;
            scratch2[x + 1][y] += diffuseVal;
            scratch2[x + 1][y + 1] += diffuseVal;
          } else {
            scratch2[x][y] += scratch[x][y] - (3 * diffuseVal);
            scratch2[x][y - 1] += diffuseVal;
            scratch2[x + 1][y] += diffuseVal;
            scratch2[x + 1][y - 1] += diffuseVal;
          }
        } else if (y === 0) {
          scratch2[x][y] += scratch[x][y] - (3 * diffuseVal);
          scratch2[x][y + 1] += diffuseVal;
          scratch2[x - 1][y] += diffuseVal;
          scratch2[x - 1][y + 1] += diffuseVal;
        } else {
          scratch2[x][y] += scratch[x][y] - (3 * diffuseVal);
          scratch2[x][y - 1] += diffuseVal;
          scratch2[x - 1][y] += diffuseVal;
          scratch2[x - 1][y - 1] += diffuseVal;
        }
      }
    }
    _results = [];
    for (y = _k = 0; 0 <= yy ? _k < yy : _k > yy; y = 0 <= yy ? ++_k : --_k) {
      _results.push((function() {
        var _l, _results1;
        _results1 = [];
        for (x = _l = 0; 0 <= xx ? _l < xx : _l > xx; x = 0 <= xx ? ++_l : --_l) {
          _results1.push(world.getPatchAt(x + this.minPxcor, y + this.minPycor).setPatchVariable(vn, scratch2[x][y]));
        }
        return _results1;
      }).call(this));
    }
    return _results;
  };

  return Box;

})(Topology);

Layouts = {
  layoutSpring: function(nodeSet, linkSet, spr, len, rep) {
    var agt, ang, ax, ay, degCount, degCount1, degCount2, dist, div, dx, dy, f, fx, fy, i, j, limit, link, newx, newy, nodeCount, perturbAmt, t, t1, t1Index, t2, t2Index, tMap, _i, _j, _k, _l, _len, _len1, _len2, _m, _n, _ref2, _ref3, _ref4, _ref5, _results;
    nodeCount = nodeSet.items.length;
    if (nodeCount === 0) {
      return;
    }
    ax = [];
    ay = [];
    tMap = [];
    degCount = (function() {
      var _i, _results;
      _results = [];
      for (i = _i = 0; 0 <= nodeCount ? _i < nodeCount : _i > nodeCount; i = 0 <= nodeCount ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
    agt = [];
    i = 0;
    _ref2 = AgentSet.shuffle(nodeSet).items;
    for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
      t = _ref2[_i];
      agt[i] = t;
      tMap[t.id] = i;
      ax[i] = 0.0;
      ay[i] = 0.0;
      i++;
    }
    _ref3 = linkSet.items;
    for (_j = 0, _len1 = _ref3.length; _j < _len1; _j++) {
      link = _ref3[_j];
      t1 = link.end1;
      t2 = link.end2;
      if (tMap[t1.id] !== void 0) {
        t1Index = tMap[t1.id];
        degCount[t1Index]++;
      }
      if (tMap[t2.id] !== void 0) {
        t2Index = tMap[t2.id];
        degCount[t2Index]++;
      }
    }
    _ref4 = linkSet.items;
    for (_k = 0, _len2 = _ref4.length; _k < _len2; _k++) {
      link = _ref4[_k];
      dx = 0;
      dy = 0;
      t1 = link.end1;
      t2 = link.end2;
      t1Index = -1;
      degCount1 = 0;
      if (tMap[t1.id] !== void 0) {
        t1Index = tMap[t1.id];
        degCount1 = degCount[t1Index];
      }
      t2Index = -1;
      degCount2 = 0;
      if (tMap[t2.id] !== void 0) {
        t2Index = tMap[t2.id];
        degCount2 = degCount[t2Index];
      }
      dist = t1.distance(t2);
      div = (degCount1 + degCount2) / 2.0;
      div = Math.max(div, 1.0);
      if (dist === 0) {
        dx += (spr * len) / div;
      } else {
        f = spr * (dist - len) / div;
        dx = dx + (f * (t2.xcor() - t1.xcor()) / dist);
        dy = dy + (f * (t2.ycor() - t1.ycor()) / dist);
      }
      if (t1Index !== -1) {
        ax[t1Index] += dx;
        ay[t1Index] += dy;
      }
      if (t2Index !== -1) {
        ax[t2Index] -= dx;
        ay[t2Index] -= dy;
      }
    }
    for (i = _l = 0; 0 <= nodeCount ? _l < nodeCount : _l > nodeCount; i = 0 <= nodeCount ? ++_l : --_l) {
      t1 = agt[i];
      for (j = _m = _ref5 = i + 1; _ref5 <= nodeCount ? _m < nodeCount : _m > nodeCount; j = _ref5 <= nodeCount ? ++_m : --_m) {
        t2 = agt[j];
        dx = 0.0;
        dy = 0.0;
        div = (degCount[i] + degCount[j]) / 2.0;
        div = Math.max(div, 1.0);
        if (t2.xcor() === t1.xcor() && t2.ycor() === t1.ycor()) {
          ang = 360 * Random.nextDouble();
          dx = -(rep / div * Trig.sin(StrictMath.toRadians(ang)));
          dy = -(rep / div * Trig.cos(StrictMath.toRadians(ang)));
        } else {
          dist = t1.distance(t2);
          f = rep / (dist * dist) / div;
          dx = -(f * (t2.xcor() - t1.xcor()) / dist);
          dy = -(f * (t2.ycor() - t1.ycor()) / dist);
        }
        ax[i] += dx;
        ay[i] += dy;
        ax[j] -= dx;
        ay[j] -= dy;
      }
    }
    if (nodeCount > 1) {
      perturbAmt = (world.width() + world.height()) / 1.0e10;
      ax[0] += Random.nextDouble() * perturbAmt - perturbAmt / 2.0;
      ay[0] += Random.nextDouble() * perturbAmt - perturbAmt / 2.0;
    }
    limit = (world.width() + world.height()) / 50.0;
    _results = [];
    for (i = _n = 0; 0 <= nodeCount ? _n < nodeCount : _n > nodeCount; i = 0 <= nodeCount ? ++_n : --_n) {
      t = agt[i];
      fx = ax[i];
      fy = ay[i];
      if (fx > limit) {
        fx = limit;
      } else if (fx < -limit) {
        fx = -limit;
      }
      if (fy > limit) {
        fy = limit;
      } else if (fy < -limit) {
        fy = -limit;
      }
      newx = t.xcor() + fx;
      newy = t.ycor() + fy;
      if (newx > world.maxPxcor) {
        newx = world.maxPxcor;
      } else if (newx < world.minPxcor) {
        newx = world.minPxcor;
      }
      if (newy > world.maxPycor) {
        newy = world.maxPycor;
      } else if (newy < world.minPycor) {
        newy = world.minPycor;
      }
      _results.push(t.setXY(newx, newy));
    }
    return _results;
  }
};
;
(function() {

  window.AgentModel = (function() {
    var mergeObjectInto;

    function AgentModel() {
      this.turtles = {};
      this.patches = {};
      this.links = {};
      this.observer = {};
      this.world = {};
    }

    AgentModel.prototype.update = function(modelUpdate) {
      var index, linkId, linkUpdates, patch, patchId, patchUpdates, turtleId, turtleUpdates, worldUpdate, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _ref3;
      turtleUpdates = modelUpdate.turtles;
      if (turtleUpdates) {
        _ref = Object.keys(turtleUpdates);
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          turtleId = _ref[_i];
          if (isFinite(turtleId)) {
            this.updateTurtle(turtleId, turtleUpdates[turtleId]);
          }
        }
      }
      linkUpdates = modelUpdate.links;
      if (linkUpdates) {
        _ref1 = Object.keys(linkUpdates);
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          linkId = _ref1[_j];
          this.updateLink(linkId, linkUpdates[linkId]);
        }
      }
      if ((modelUpdate.world != null) && (modelUpdate.world[0] != null)) {
        worldUpdate = modelUpdate.world[0];
        mergeObjectInto(modelUpdate.world[0], this.world);
        if ((worldUpdate.minPxcor != null) && (worldUpdate.maxPxcor != null) && (worldUpdate.minPycor != null) && (worldUpdate.maxPycor != null)) {
          _ref2 = this.patches;
          for (index in _ref2) {
            patch = _ref2[index];
            if (patch.pxcor < worldUpdate.minPxcor || patch.pxcor > worldUpdate.maxPxcor || patch.pycor < worldUpdate.minPycor || patch.pycor > worldUpdate.maxPycor) {
              delete this.patches[index];
            }
          }
        }
      }
      patchUpdates = modelUpdate.patches;
      if (patchUpdates) {
        _ref3 = Object.keys(patchUpdates);
        for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
          patchId = _ref3[_k];
          this.updatePatch(patchId, patchUpdates[patchId]);
        }
      }
      if ((modelUpdate.observer != null) && (modelUpdate.observer[0] != null)) {
        mergeObjectInto(modelUpdate.observer[0], this.observer);
      }
    };

    AgentModel.prototype.updateTurtle = function(turtleId, varUpdates) {
      var t;
      if (varUpdates === null || varUpdates['WHO'] === -1) {
        return delete this.turtles[turtleId];
      } else {
        t = this.turtles[turtleId];
        if (!(t != null)) {
          t = this.turtles[turtleId] = {
            heading: 360 * Math.random(),
            xcor: 0,
            ycor: 0,
            shape: 'default',
            color: 'hsl(' + (360 * Math.random()) + ',100%,50%)'
          };
        }
        return mergeObjectInto(varUpdates, t);
      }
    };

    AgentModel.prototype.updateLink = function(linkId, varUpdates) {
      var l;
      if (varUpdates === null || varUpdates['WHO'] === -1) {
        return delete this.links[linkId];
      } else {
        l = this.links[linkId];
        if (!(l != null)) {
          l = this.links[linkId] = {
            shape: 'default',
            color: 5
          };
        }
        return mergeObjectInto(varUpdates, l);
      }
    };

    AgentModel.prototype.updatePatch = function(patchId, varUpdates) {
      var p;
      p = this.patches[patchId];
      if (p == null) {
        p = this.patches[patchId] = {};
      }
      return mergeObjectInto(varUpdates, p);
    };

    mergeObjectInto = function(updatedObject, targetObject) {
      var value, variable;
      for (variable in updatedObject) {
        value = updatedObject[variable];
        targetObject[variable.toLowerCase()] = value;
      }
    };

    return AgentModel;

  })();

}).call(this);
;
(function() {
  var b, baseIndex, cachedNetlogoColors, color, colorArrayToCSS, colorTimesTen, g, i, netlogoBaseColors, netlogoColorNamesIndices, r, step, _i, _len, _ref;

  window.netlogoColorToCSS = function(netlogoColor) {
    var a, array, b, g, r, _ref;
    _ref = array = netlogoColorToRGB(netlogoColor), r = _ref[0], g = _ref[1], b = _ref[2];
    a = array.length > 3 ? array[3] : 255;
    if (a < 255) {
      return "rgba(" + r + ", " + g + ", " + b + ", " + (a / 255) + ")";
    } else {
      return "rgb(" + r + ", " + g + ", " + b + ")";
    }
  };

  window.netlogoColorToRGB = function(netlogoColor) {
    switch (typeof netlogoColor) {
      case "number":
        return cachedNetlogoColors[Math.floor(netlogoColor * 10)];
      case "object":
        return netlogoColor.map(Math.round);
      case "string":
        return netlogoBaseColors[netlogoColorNamesIndices[netlogoColor]];
      default:
        return console.error("Unrecognized color: " + netlogoColor);
    }
  };

  netlogoColorNamesIndices = {};

  _ref = ['gray', 'red', 'orange', 'brown', 'yellow', 'green', 'lime', 'turqoise', 'cyan', 'sky', 'blue', 'violet', 'magenta', 'pink', 'black', 'white'];
  for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
    color = _ref[i];
    netlogoColorNamesIndices[color] = i;
  }

  netlogoBaseColors = [[140, 140, 140], [215, 48, 39], [241, 105, 19], [156, 109, 70], [237, 237, 47], [87, 176, 58], [42, 209, 57], [27, 158, 119], [82, 196, 196], [43, 140, 190], [50, 92, 168], [123, 78, 163], [166, 25, 105], [224, 126, 149], [0, 0, 0], [255, 255, 255]];

  cachedNetlogoColors = (function() {
    var _j, _ref1, _results;
    _results = [];
    for (colorTimesTen = _j = 0; _j <= 1400; colorTimesTen = ++_j) {
      baseIndex = Math.floor(colorTimesTen / 100);
      _ref1 = netlogoBaseColors[baseIndex], r = _ref1[0], g = _ref1[1], b = _ref1[2];
      step = (colorTimesTen % 100 - 50) / 50.48 + 0.012;
      if (step < 0) {
        r += Math.floor(r * step);
        g += Math.floor(g * step);
        b += Math.floor(b * step);
      } else {
        r += Math.floor((0xFF - r) * step);
        g += Math.floor((0xFF - g) * step);
        b += Math.floor((0xFF - b) * step);
      }
      _results.push([r, g, b]);
    }
    return _results;
  })();

  colorArrayToCSS = function(array) {
    var a, _ref1;
    _ref1 = array.map(Math.round), r = _ref1[0], g = _ref1[1], b = _ref1[2];
    a = array.length > 3 ? array[3] : 255;
    if (a < 255) {
      return "rgba(" + r + ", " + g + ", " + b + ", " + (a / 255) + ")";
    } else {
      return "rgb(" + r + ", " + g + ", " + b + ")";
    }
  };

}).call(this);
;
(function() {
  var drawPath, setColoring,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  window.ShapeDrawer = (function() {

    function ShapeDrawer(shapes) {
      this.shapes = shapes;
    }

    ShapeDrawer.prototype.drawShape = function(ctx, turtleColor, shapeName) {
      ctx.translate(.5, -.5);
      ctx.scale(-1 / 300, 1 / 300);
      this.drawRawShape(ctx, turtleColor, shapeName);
    };

    ShapeDrawer.prototype.drawRawShape = function(ctx, turtleColor, shapeName) {
      var elem, shape, _i, _len, _ref;
      shape = this.shapes[shapeName] || defaultShape;
      _ref = shape.elements;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        elem = _ref[_i];
        draw[elem.type](ctx, turtleColor, elem);
      }
    };

    return ShapeDrawer;

  })();

  window.CachingShapeDrawer = (function(_super) {

    __extends(CachingShapeDrawer, _super);

    function CachingShapeDrawer(shapes) {
      CachingShapeDrawer.__super__.constructor.call(this, shapes);
      this.shapeCache = {};
    }

    CachingShapeDrawer.prototype.drawShape = function(ctx, turtleColor, shapeName) {
      var shapeCanvas, shapeCtx, shapeKey;
      shapeName = shapeName.toLowerCase();
      shapeKey = this.shapeKey(shapeName, turtleColor);
      shapeCanvas = this.shapeCache[shapeKey];
      if (!(shapeCanvas != null)) {
        shapeCanvas = document.createElement('canvas');
        shapeCanvas.width = shapeCanvas.height = 300;
        shapeCtx = shapeCanvas.getContext('2d');
        this.drawRawShape(shapeCtx, turtleColor, shapeName);
        this.shapeCache[shapeKey] = shapeCanvas;
      }
      ctx.translate(.5, -.5);
      ctx.scale(-1 / 300, 1 / 300);
      ctx.drawImage(shapeCanvas, 0, 0);
    };

    CachingShapeDrawer.prototype.shapeKey = function(shapeName, turtleColor) {
      return [shapeName, netlogoColorToCSS(turtleColor)];
    };

    return CachingShapeDrawer;

  })(ShapeDrawer);

  setColoring = function(ctx, turtleColor, element) {
    turtleColor = netlogoColorToCSS(turtleColor);
    if (element.filled) {
      if (element.marked) {
        ctx.fillStyle = turtleColor;
      } else {
        ctx.fillStyle = element.color;
      }
    } else {
      if (element.marked) {
        ctx.strokeStyle = turtleColor;
      } else {
        ctx.strokeStyle = element.color;
      }
    }
  };

  drawPath = function(ctx, turtleColor, element) {
    setColoring(ctx, turtleColor, element);
    if (element.filled) {
      ctx.fill();
    } else {
      ctx.stroke();
    }
  };

  window.draw = {
    circle: function(ctx, turtleColor, circle) {
      var r;
      r = circle.diam / 2;
      ctx.beginPath();
      ctx.arc(circle.x + r, circle.y + r, r, 0, 2 * Math.PI, false);
      ctx.closePath();
      drawPath(ctx, turtleColor, circle);
    },
    polygon: function(ctx, turtleColor, polygon) {
      var i, x, xcors, y, ycors, _i, _len, _ref;
      xcors = polygon.xcors;
      ycors = polygon.ycors;
      ctx.beginPath();
      ctx.moveTo(xcors[0], ycors[0]);
      _ref = xcors.slice(1);
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        x = _ref[i];
        y = ycors[i + 1];
        ctx.lineTo(x, y);
      }
      ctx.closePath();
      drawPath(ctx, turtleColor, polygon);
    },
    rectangle: function(ctx, turtleColor, rectangle) {
      var h, w, x, y;
      x = rectangle.xmin;
      y = rectangle.ymin;
      w = rectangle.xmax - x;
      h = rectangle.ymax - y;
      setColoring(ctx, turtleColor, rectangle);
      if (rectangle.filled) {
        ctx.fillRect(x, y, w, h);
      } else {
        ctx.strokeRect(x, y, w, h);
      }
    },
    line: function(ctx, turtleColor, line) {
      var h, w, x, y;
      x = line.x1;
      y = line.y1;
      w = line.x2 - line.x1;
      h = line.y2 - line.y1;
      setColoring(ctx, turtleColor, line);
      ctx.lineWidth = 15;
      ctx.beginPath();
      ctx.moveTo(line.x1, line.y1);
      ctx.lineTo(line.x2, line.y2);
      ctx.stroke();
      ctx.lineWidth = .1;
    }
  };

  window.defaultShape = {
    rotate: true,
    elements: [
      {
        type: 'polygon',
        color: 'grey',
        filled: 'true',
        marked: 'true',
        xcors: [150, 40, 150, 260],
        ycors: [5, 250, 205, 250]
      }
    ]
  };

}).call(this);
;
defaultShapes = {
  "default": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          40,
          150,
          260
        ],
        "ycors": [
          5,
          250,
          205,
          250
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "airplane": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          135,
          120,
          120,
          15,
          15,
          120,
          135,
          105,
          120,
          150,
          180,
          210,
          165,
          180,
          285,
          285,
          180,
          180,
          165
        ],
        "ycors": [
          0,
          15,
          60,
          105,
          165,
          195,
          180,
          240,
          270,
          285,
          270,
          285,
          270,
          240,
          180,
          195,
          165,
          105,
          60,
          15
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "arrow": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          0,
          105,
          105,
          195,
          195,
          300
        ],
        "ycors": [
          0,
          150,
          150,
          293,
          293,
          150,
          150
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "box": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          285,
          285,
          150
        ],
        "ycors": [
          285,
          225,
          75,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          15,
          150,
          285
        ],
        "ycors": [
          135,
          75,
          15,
          75
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          15,
          15,
          150,
          150
        ],
        "ycors": [
          75,
          225,
          285,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 285,
        "x2": 150,
        "y2": 135,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 15,
        "y2": 75,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 285,
        "y2": 75,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "bug": {
    "rotate": true,
    "elements": [
      {
        "x": 96,
        "y": 182,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 110,
        "y": 127,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 110,
        "y": 75,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 100,
        "x2": 80,
        "y2": 30,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 100,
        "x2": 220,
        "y2": 30,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "butterfly": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          209,
          225,
          225,
          195,
          165,
          150
        ],
        "ycors": [
          165,
          199,
          225,
          255,
          270,
          255,
          240
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          89,
          75,
          75,
          105,
          135,
          150
        ],
        "ycors": [
          165,
          198,
          225,
          255,
          270,
          255,
          240
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          139,
          100,
          55,
          25,
          10,
          10,
          25,
          40,
          85,
          139
        ],
        "ycors": [
          148,
          105,
          90,
          90,
          105,
          135,
          180,
          195,
          194,
          163
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          162,
          200,
          245,
          275,
          290,
          290,
          275,
          260,
          215,
          162
        ],
        "ycors": [
          150,
          105,
          90,
          90,
          105,
          135,
          180,
          195,
          195,
          165
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          135,
          120,
          135,
          150,
          165,
          180,
          165
        ],
        "ycors": [
          255,
          225,
          150,
          120,
          105,
          120,
          150,
          225
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 135,
        "y": 90,
        "diam": 30,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 105,
        "x2": 195,
        "y2": 60,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 105,
        "x2": 105,
        "y2": 60,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "car": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          300,
          279,
          261,
          240,
          226,
          213,
          203,
          185,
          159,
          135,
          75,
          0,
          0,
          0,
          300,
          300
        ],
        "ycors": [
          180,
          164,
          144,
          135,
          132,
          106,
          84,
          63,
          50,
          50,
          60,
          150,
          165,
          225,
          225,
          180
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 180,
        "y": 180,
        "diam": 90,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 30,
        "y": 180,
        "diam": 90,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          162,
          132,
          134,
          209,
          194,
          189,
          180
        ],
        "ycors": [
          80,
          78,
          135,
          135,
          105,
          96,
          89
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 47,
        "y": 195,
        "diam": 58,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 195,
        "y": 195,
        "diam": 58,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "circle": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "circle 2": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "cloud": {
    "rotate": false,
    "elements": [
      {
        "x": 13,
        "y": 118,
        "diam": 94,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 86,
        "y": 101,
        "diam": 127,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 51,
        "y": 51,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 118,
        "y": 43,
        "diam": 95,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 158,
        "y": 68,
        "diam": 134,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "co2-molecule": {
    "rotate": true,
    "elements": [
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "cow": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          200,
          197,
          179,
          177,
          166,
          140,
          93,
          78,
          72,
          49,
          48,
          37,
          25,
          25,
          45,
          103,
          179,
          198,
          252,
          272,
          293,
          285,
          255,
          242,
          224
        ],
        "ycors": [
          193,
          249,
          249,
          196,
          187,
          189,
          191,
          179,
          211,
          209,
          181,
          149,
          120,
          89,
          72,
          84,
          75,
          76,
          64,
          81,
          103,
          121,
          121,
          118,
          167
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          73,
          86,
          62,
          48
        ],
        "ycors": [
          210,
          251,
          249,
          208
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          25,
          16,
          9,
          23,
          25,
          39
        ],
        "ycors": [
          114,
          195,
          204,
          213,
          200,
          123
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "cylinder": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "dot": {
    "rotate": false,
    "elements": [
      {
        "x": 90,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "face happy": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 8,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          150,
          90,
          62,
          47,
          67,
          90,
          109,
          150,
          192,
          210,
          227,
          251,
          236,
          212
        ],
        "ycors": [
          255,
          239,
          213,
          191,
          179,
          203,
          218,
          225,
          218,
          203,
          181,
          194,
          217,
          240
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "face neutral": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 7,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 60,
        "ymin": 195,
        "xmax": 240,
        "ymax": 225,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "face sad": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 8,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          150,
          90,
          62,
          47,
          67,
          90,
          109,
          150,
          192,
          210,
          227,
          251,
          236,
          212
        ],
        "ycors": [
          168,
          184,
          210,
          232,
          244,
          220,
          205,
          198,
          205,
          220,
          242,
          229,
          206,
          183
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "fish": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          44,
          21,
          15,
          0,
          15,
          0,
          13,
          20,
          45
        ],
        "ycors": [
          131,
          87,
          86,
          120,
          150,
          180,
          214,
          212,
          166
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          135,
          119,
          95,
          76,
          46,
          60
        ],
        "ycors": [
          195,
          235,
          218,
          210,
          204,
          165
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          75,
          83,
          71,
          86,
          166,
          135
        ],
        "ycors": [
          45,
          77,
          103,
          114,
          78,
          60
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          30,
          151,
          226,
          280,
          292,
          292,
          287,
          270,
          195,
          151,
          30
        ],
        "ycors": [
          136,
          77,
          81,
          119,
          146,
          160,
          170,
          195,
          210,
          212,
          166
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 215,
        "y": 106,
        "diam": 30,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "flag": {
    "rotate": false,
    "elements": [
      {
        "xmin": 60,
        "ymin": 15,
        "xmax": 75,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          90,
          270,
          90
        ],
        "ycors": [
          150,
          90,
          30
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 75,
        "y1": 135,
        "x2": 90,
        "y2": 135,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 75,
        "y1": 45,
        "x2": 90,
        "y2": 45,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "flower": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          135,
          165,
          180,
          180,
          150,
          165,
          195,
          195,
          165
        ],
        "ycors": [
          120,
          165,
          210,
          240,
          300,
          300,
          240,
          195,
          135
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 85,
        "y": 132,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 130,
        "y": 147,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 192,
        "y": 85,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 85,
        "y": 40,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 177,
        "y": 40,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 177,
        "y": 132,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 70,
        "y": 85,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 130,
        "y": 25,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 96,
        "y": 51,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 113,
        "y": 68,
        "diam": 74,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          189,
          219,
          249,
          279,
          234
        ],
        "ycors": [
          233,
          188,
          173,
          188,
          218
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          180,
          150,
          105,
          75,
          135
        ],
        "ycors": [
          255,
          210,
          210,
          240,
          240
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "house": {
    "rotate": false,
    "elements": [
      {
        "xmin": 45,
        "ymin": 120,
        "xmax": 255,
        "ymax": 285,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 120,
        "ymin": 210,
        "xmax": 180,
        "ymax": 285,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          15,
          150,
          285
        ],
        "ycors": [
          120,
          15,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 30,
        "y1": 120,
        "x2": 270,
        "y2": 120,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "leaf": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          135,
          120,
          60,
          30,
          60,
          60,
          15,
          30,
          15,
          40,
          45,
          60,
          90,
          105,
          120,
          105,
          120,
          135,
          150,
          165,
          180,
          195,
          180,
          195,
          210,
          240,
          255,
          263,
          285,
          270,
          285,
          240,
          240,
          270,
          240,
          180,
          165
        ],
        "ycors": [
          210,
          195,
          210,
          210,
          195,
          180,
          165,
          135,
          120,
          105,
          104,
          90,
          90,
          105,
          120,
          120,
          60,
          60,
          30,
          15,
          30,
          60,
          60,
          120,
          120,
          105,
          90,
          90,
          104,
          105,
          120,
          135,
          165,
          180,
          195,
          210,
          210,
          195
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          135,
          120,
          105,
          105,
          135,
          165,
          165
        ],
        "ycors": [
          195,
          240,
          255,
          255,
          285,
          285,
          240,
          195
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "line": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 300,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "line half": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 150,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "molecule water": {
    "rotate": true,
    "elements": [
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "pentagon": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          60,
          240,
          285
        ],
        "ycors": [
          15,
          120,
          285,
          285,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "person": {
    "rotate": false,
    "elements": [
      {
        "x": 110,
        "y": 5,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          105,
          120,
          90,
          105,
          135,
          150,
          165,
          195,
          210,
          180,
          195
        ],
        "ycors": [
          90,
          195,
          285,
          300,
          300,
          225,
          300,
          300,
          285,
          195,
          90
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 127,
        "ymin": 79,
        "xmax": 172,
        "ymax": 94,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          195,
          240,
          225,
          165
        ],
        "ycors": [
          90,
          150,
          180,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          105,
          60,
          75,
          135
        ],
        "ycors": [
          90,
          150,
          180,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "plant": {
    "rotate": false,
    "elements": [
      {
        "xmin": 135,
        "ymin": 90,
        "xmax": 165,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          255,
          210,
          195,
          255,
          285
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          210,
          255,
          225,
          165
        ],
        "ycors": [
          255,
          210,
          195,
          255,
          285
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          180,
          135,
          120,
          180,
          210
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          165,
          225,
          255,
          210
        ],
        "ycors": [
          180,
          210,
          180,
          120,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          105,
          60,
          45,
          105,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          165,
          225,
          255,
          210
        ],
        "ycors": [
          105,
          135,
          105,
          45,
          60
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          120,
          150,
          180,
          165
        ],
        "ycors": [
          90,
          45,
          15,
          45,
          90
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "ray": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 315,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 255,
        "x2": 150,
        "y2": 225,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 225,
        "x2": 180,
        "y2": 255,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 165,
        "x2": 150,
        "y2": 135,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 75,
        "x2": 150,
        "y2": 45,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 180,
        "y2": 165,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 45,
        "x2": 180,
        "y2": 75,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "sheep": {
    "rotate": false,
    "elements": [
      {
        "x": 203,
        "y": 65,
        "diam": 88,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 70,
        "y": 65,
        "diam": 162,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 150,
        "y": 105,
        "diam": 120,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          218,
          240,
          255,
          278
        ],
        "ycors": [
          120,
          165,
          165,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 214,
        "y": 72,
        "diam": 67,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 164,
        "ymin": 223,
        "xmax": 179,
        "ymax": 298,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          45,
          30,
          30,
          15,
          45
        ],
        "ycors": [
          285,
          285,
          240,
          195,
          210
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 3,
        "y": 83,
        "diam": 150,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 65,
        "ymin": 221,
        "xmax": 80,
        "ymax": 296,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          195,
          210,
          210,
          240,
          195
        ],
        "ycors": [
          285,
          285,
          240,
          210,
          210
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          276,
          285,
          302,
          294
        ],
        "ycors": [
          85,
          105,
          99,
          83
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          219,
          210,
          193,
          201
        ],
        "ycors": [
          85,
          105,
          99,
          83
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "square": {
    "rotate": false,
    "elements": [
      {
        "xmin": 30,
        "ymin": 30,
        "xmax": 270,
        "ymax": 270,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "square 2": {
    "rotate": false,
    "elements": [
      {
        "xmin": 30,
        "ymin": 30,
        "xmax": 270,
        "ymax": 270,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 60,
        "ymin": 60,
        "xmax": 240,
        "ymax": 240,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "star": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          151,
          185,
          298,
          207,
          242,
          151,
          59,
          94,
          3,
          116
        ],
        "ycors": [
          1,
          108,
          108,
          175,
          282,
          216,
          282,
          175,
          108,
          108
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "target": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 60,
        "y": 60,
        "diam": 180,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 90,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 120,
        "y": 120,
        "diam": 60,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "tree": {
    "rotate": false,
    "elements": [
      {
        "x": 118,
        "y": 3,
        "diam": 94,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 120,
        "ymin": 195,
        "xmax": 180,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(157, 110, 72, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 65,
        "y": 21,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 116,
        "y": 41,
        "diam": 127,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 45,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 104,
        "y": 74,
        "diam": 152,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "triangle": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          285
        ],
        "ycors": [
          30,
          255,
          255
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "triangle 2": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          285
        ],
        "ycors": [
          30,
          255,
          255
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          151,
          225,
          75
        ],
        "ycors": [
          99,
          223,
          224
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "truck": {
    "rotate": false,
    "elements": [
      {
        "xmin": 4,
        "ymin": 45,
        "xmax": 195,
        "ymax": 187,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          296,
          296,
          259,
          244,
          208,
          207
        ],
        "ycors": [
          193,
          150,
          134,
          104,
          104,
          194
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 195,
        "ymin": 60,
        "xmax": 195,
        "ymax": 105,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          238,
          252,
          219,
          218
        ],
        "ycors": [
          112,
          141,
          141,
          112
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 234,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 181,
        "ymin": 185,
        "xmax": 214,
        "ymax": 194,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 144,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 24,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 24,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 144,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 234,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "turtle": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          215,
          240,
          246,
          228,
          215,
          193
        ],
        "ycors": [
          204,
          233,
          254,
          266,
          252,
          210
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          195,
          225,
          245,
          260,
          269,
          261,
          240,
          225,
          210
        ],
        "ycors": [
          90,
          75,
          75,
          89,
          108,
          124,
          105,
          105,
          105
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          105,
          75,
          55,
          40,
          31,
          39,
          60,
          75,
          90
        ],
        "ycors": [
          90,
          75,
          75,
          89,
          108,
          124,
          105,
          105,
          105
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          132,
          134,
          107,
          108,
          150,
          192,
          192,
          169,
          172
        ],
        "ycors": [
          85,
          64,
          51,
          17,
          2,
          18,
          52,
          65,
          87
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          85,
          60,
          54,
          72,
          85,
          107
        ],
        "ycors": [
          204,
          233,
          254,
          266,
          252,
          210
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          119,
          179,
          209,
          224,
          220,
          175,
          128,
          81,
          74,
          88
        ],
        "ycors": [
          75,
          75,
          101,
          135,
          225,
          261,
          261,
          224,
          135,
          99
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "wheel": {
    "rotate": false,
    "elements": [
      {
        "x": 3,
        "y": 3,
        "diam": 294,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 285,
        "x2": 150,
        "y2": 15,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 15,
        "y1": 150,
        "x2": 285,
        "y2": 150,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 120,
        "y": 120,
        "diam": 60,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 216,
        "y1": 40,
        "x2": 79,
        "y2": 269,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 40,
        "y1": 84,
        "x2": 269,
        "y2": 221,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 40,
        "y1": 216,
        "x2": 269,
        "y2": 79,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 84,
        "y1": 40,
        "x2": 221,
        "y2": 269,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "wolf": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          253,
          245,
          245
        ],
        "ycors": [
          133,
          131,
          133
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          2,
          13,
          30,
          38,
          38,
          20,
          20,
          27,
          38,
          40,
          31,
          31,
          60,
          68,
          75,
          66,
          65,
          82,
          84,
          100,
          103,
          77,
          79,
          100,
          98,
          119,
          143,
          160,
          166,
          172,
          173,
          167,
          160,
          154,
          169,
          178,
          186,
          198,
          200,
          217,
          219,
          207,
          195,
          192,
          210,
          227,
          242,
          259,
          284,
          277,
          293,
          299,
          297,
          273,
          270
        ],
        "ycors": [
          194,
          197,
          191,
          193,
          205,
          226,
          257,
          265,
          266,
          260,
          253,
          230,
          206,
          198,
          209,
          228,
          243,
          261,
          268,
          267,
          261,
          239,
          231,
          207,
          196,
          201,
          202,
          195,
          210,
          213,
          238,
          251,
          248,
          265,
          264,
          247,
          240,
          260,
          271,
          271,
          262,
          258,
          230,
          198,
          184,
          164,
          144,
          145,
          151,
          141,
          140,
          134,
          127,
          119,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          -1,
          14,
          36,
          40,
          53,
          82,
          134,
          159,
          188,
          227,
          236,
          238,
          268,
          269,
          281,
          269,
          269
        ],
        "ycors": [
          195,
          180,
          166,
          153,
          140,
          131,
          133,
          126,
          115,
          108,
          102,
          98,
          86,
          92,
          87,
          103,
          113
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "x": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          270,
          225,
          30,
          75
        ],
        "ycors": [
          75,
          30,
          225,
          270
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          30,
          75,
          270,
          225
        ],
        "ycors": [
          75,
          30,
          225,
          270
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  }
}
;
(function() {
  var PatchView, SpotlightView, TurtleView, View,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  if (!(window.AgentModel != null)) {
    console.error('view.js requires agentmodel.js!');
  }

  window.AgentStreamController = (function() {

    function AgentStreamController(container) {
      this.container = container;
      this.layers = document.createElement('div');
      this.layers.style.width = '100%';
      this.layers.style.position = 'relative';
      this.layers.classList.add('view-layers');
      this.container.appendChild(this.layers);
      this.spotlightView = new SpotlightView();
      this.turtleView = new TurtleView();
      this.patchView = new PatchView();
      this.spotlightView.canvas.style.position = 'absolute';
      this.spotlightView.canvas.style.top = '0px';
      this.spotlightView.canvas.style.left = '0px';
      this.spotlightView.canvas.style['z-index'] = 2;
      this.turtleView.canvas.style.position = 'absolute';
      this.turtleView.canvas.style.top = '0px';
      this.turtleView.canvas.style.left = '0px';
      this.turtleView.canvas.style['z-index'] = 1;
      this.patchView.canvas.style['z-index'] = 0;
      this.layers.appendChild(this.spotlightView.canvas);
      this.layers.appendChild(this.patchView.canvas);
      this.layers.appendChild(this.turtleView.canvas);
      this.mouseDown = false;
      this.mouseInside = false;
      this.mouseXcor = 0;
      this.mouseYcor = 0;
      this.initMouseTracking();
      this.model = new AgentModel();
      this.model.world.turtleshapelist = defaultShapes;
      this.repaint();
    }

    AgentStreamController.prototype.initMouseTracking = function() {
      var _this = this;
      this.turtleView.canvas.addEventListener('mousedown', function(e) {
        return _this.mouseDown = true;
      });
      document.addEventListener('mouseup', function(e) {
        return _this.mouseDown = false;
      });
      this.turtleView.canvas.addEventListener('mouseenter', function(e) {
        return _this.mouseInside = true;
      });
      this.turtleView.canvas.addEventListener('mouseleave', function(e) {
        return _this.mouseInside = false;
      });
      return this.turtleView.canvas.addEventListener('mousemove', function(e) {
        _this.mouseXcor = _this.turtleView.xPixToPcor(e.pageX - _this.layers.offsetLeft);
        return _this.mouseYcor = _this.turtleView.yPixToPcor(e.pageY - _this.layers.offsetTop);
      });
    };

    AgentStreamController.prototype.repaint = function() {
      this.spotlightView.repaint(this.model);
      this.turtleView.repaint(this.model);
      return this.patchView.repaint(this.model);
    };

    AgentStreamController.prototype.update = function(modelUpdate) {
      return this.model.update(modelUpdate);
    };

    return AgentStreamController;

  })();

  View = (function() {

    function View() {
      this.quality = 1;
      this.canvas = document.createElement('canvas');
      this.canvas["class"] = 'netlogo-canvas';
      this.canvas.width = 500;
      this.canvas.height = 500;
      this.canvas.style.width = "100%";
      this.ctx = this.canvas.getContext('2d');
    }

    View.prototype.matchesWorld = function(world) {
      return ((this.maxpxcor != null) && (this.minpxcor != null) && (this.maxpycor != null) && (this.minpycor != null) && (this.patchsize != null)) && (!(world.maxpxcor != null) || world.maxpxcor === this.maxpxcor) && (!(world.minpxcor != null) || world.minpxcor === this.minpxcor) && (!(world.maxpycor != null) || world.maxpycor === this.maxpycor) && (!(world.minpycor != null) || world.minpycor === this.minpycor) && (!(world.patchsize != null) || world.patchsize === this.patchsize);
    };

    View.prototype.transformToWorld = function(world) {
      this.maxpxcor = world.maxpxcor != null ? world.maxpxcor : 25;
      this.minpxcor = world.minpxcor != null ? world.minpxcor : -25;
      this.maxpycor = world.maxpycor != null ? world.maxpycor : 25;
      this.minpycor = world.minpycor != null ? world.minpycor : -25;
      this.patchsize = world.patchsize != null ? world.patchsize : 9;
      this.onePixel = 1 / this.patchsize;
      this.patchWidth = this.maxpxcor - this.minpxcor + 1;
      this.patchHeight = this.maxpycor - this.minpycor + 1;
      this.canvas.width = this.patchWidth * this.patchsize * this.quality;
      this.canvas.height = this.patchHeight * this.patchsize * this.quality;
      this.ctx.setTransform(this.canvas.width / this.patchWidth, 0, 0, -this.canvas.height / this.patchHeight, -(this.minpxcor - .5) * this.canvas.width / this.patchWidth, (this.maxpycor + .5) * this.canvas.height / this.patchHeight);
      return this.ctx.font = '10pt "Lucida Grande", sans-serif';
    };

    View.prototype.xPixToPcor = function(x) {
      return this.minpxcor - .5 + this.patchWidth * x / this.canvas.offsetWidth;
    };

    View.prototype.yPixToPcor = function(y) {
      return this.maxpycor + .5 - this.patchHeight * y / this.canvas.offsetHeight;
    };

    View.prototype.drawLabel = function(label, color, x, y) {
      label = label != null ? label.toString() : '';
      if (label.length > 0) {
        this.ctx.save();
        this.ctx.translate(x, y);
        this.ctx.scale(1 / this.patchsize, -1 / this.patchsize);
        this.ctx.textAlign = 'end';
        this.ctx.fillStyle = netlogoColorToCSS(color);
        this.ctx.fillText(label, 0, 0);
        return this.ctx.restore();
      }
    };

    View.prototype.turtleType = 1;

    View.prototype.patchType = 2;

    View.prototype.linkType = 3;

    View.prototype.watch = function(model) {
      var id, links, observer, patches, turtles, type, _ref;
      observer = model.observer, turtles = model.turtles, links = model.links, patches = model.patches;
      if (observer.perspective > 0 && observer.targetagent && observer.targetagent[1] >= 0) {
        _ref = observer.targetagent, type = _ref[0], id = _ref[1];
        switch (type) {
          case this.turtleType:
            return model.turtles[id];
          case this.patchType:
            return model.patches[id];
          case this.linkType:
            return model.links[id];
        }
      } else {
        return null;
      }
    };

    View.prototype.follow = function(model) {
      if (model.observer.perspective === 2) {
        return watch(model);
      } else {
        return null;
      }
    };

    return View;

  })();

  SpotlightView = (function(_super) {

    __extends(SpotlightView, _super);

    function SpotlightView() {
      return SpotlightView.__super__.constructor.apply(this, arguments);
    }

    SpotlightView.prototype.dimmed = "rgba(0, 0, 50, " + (100 / 255) + ")";

    SpotlightView.prototype.spotlightInnerBorder = "rgba(200, 255, 255, " + (100 / 255) + ")";

    SpotlightView.prototype.spotlightOuterBorder = "rgba(200, 255, 255, " + (50 / 255) + ")";

    SpotlightView.prototype.clear = 'white';

    SpotlightView.prototype.outer = function() {
      return 10 / this.patchsize;
    };

    SpotlightView.prototype.middle = function() {
      return 8 / this.patchsize;
    };

    SpotlightView.prototype.inner = function() {
      return 4 / this.patchsize;
    };

    SpotlightView.prototype.drawCircle = function(x, y, diam, color) {
      this.ctx.fillStyle = color;
      this.ctx.beginPath();
      this.ctx.arc(x, y, diam / 2, 0, 2 * Math.PI);
      return this.ctx.fill();
    };

    SpotlightView.prototype.drawSpotlight = function(x, y, size) {
      this.ctx.lineWidth = this.onePixel;
      this.ctx.globalCompositeOperation = 'source-over';
      this.ctx.fillStyle = this.dimmed;
      this.ctx.fillRect(this.minpxcor - 0.5, this.minpycor - 0.5, this.patchWidth, this.patchHeight);
      this.ctx.globalCompositeOperation = 'destination-out';
      this.drawCircle(x, y, size + this.outer(), this.clear);
      this.ctx.globalCompositeOperation = 'source-over';
      this.drawCircle(x, y, size + this.outer(), this.dimmed);
      this.drawCircle(x, y, size + this.middle(), this.spotlightOuterBorder);
      this.drawCircle(x, y, size + this.inner(), this.spotlightInnerBorder);
      this.ctx.globalCompositeOperation = 'destination-out';
      return this.drawCircle(x, y, size, this.clear);
    };

    SpotlightView.prototype.adjustSize = function(size) {
      return Math.max(size, this.patchWidth / 16, this.patchHeight / 16);
    };

    SpotlightView.prototype.dimensions = function(agent) {
      if (agent.xcor != null) {
        return [agent.xcor, agent.ycor, 2 * agent.size];
      } else if (agent.pxcor != null) {
        return [agent.pxcor, agent.pycor, 2];
      } else {
        return [agent.midpointx, agent.midpointy, agent.size];
      }
    };

    SpotlightView.prototype.repaint = function(model) {
      var size, watched, xcor, ycor, _ref;
      this.transformToWorld(model.world);
      watched = this.watch(model);
      if (watched != null) {
        _ref = this.dimensions(watched), xcor = _ref[0], ycor = _ref[1], size = _ref[2];
        return this.drawSpotlight(xcor, ycor, this.adjustSize(size));
      }
    };

    return SpotlightView;

  })(View);

  TurtleView = (function(_super) {

    __extends(TurtleView, _super);

    function TurtleView() {
      TurtleView.__super__.constructor.call(this);
      this.drawer = new CachingShapeDrawer({});
      this.quality = 3;
    }

    TurtleView.prototype.drawTurtle = function(turtle, canWrapX, canWrapY) {
      var size, xcor, ycor;
      xcor = turtle.xcor || 0;
      ycor = turtle.ycor || 0;
      size = turtle.size || 1;
      this.drawTurtleAt(turtle, xcor, ycor);
      if (canWrapX) {
        if (xcor - size < this.minpxcor) {
          this.drawTurtleAt(turtle, xcor + this.patchWidth, ycor);
        }
        if (xcor + size > this.maxpxcor) {
          this.drawTurtleAt(turtle, xcor - this.patchWidth, ycor);
        }
      }
      if (canWrapY) {
        if (ycor - size < this.minpycor) {
          this.drawTurtleAt(turtle, xcor, ycor + this.patchHeight);
        }
        if (ycor + size > this.maxpycor) {
          return this.drawTurtleAt(turtle, xcor, ycor - this.patchHeight);
        }
      }
    };

    TurtleView.prototype.drawTurtleAt = function(turtle, xcor, ycor) {
      var angle, heading, scale, shape, shapeName;
      heading = turtle.heading || 0;
      scale = turtle.size || 1;
      angle = (180 - heading) / 360 * 2 * Math.PI;
      shapeName = turtle.shape;
      shape = this.drawer.shapes[shapeName] || defaultShape;
      this.ctx.save();
      this.ctx.translate(xcor, ycor);
      if (shape.rotate) {
        this.ctx.rotate(angle);
      } else {
        this.ctx.rotate(Math.PI);
      }
      this.ctx.scale(scale, scale);
      this.drawer.drawShape(this.ctx, turtle.color, shapeName);
      this.ctx.restore();
      return this.drawLabel(turtle.label, turtle['label-color'], xcor + turtle.size / 2, ycor - turtle.size / 2);
    };

    TurtleView.prototype.drawLine = function(x1, y1, x2, y2) {
      this.ctx.moveTo(x1, y1);
      return this.ctx.lineTo(x2, y2);
    };

    TurtleView.prototype.drawLink = function(link, turtles, canWrapX, canWrapY) {
      var end1, end2, wrapX, wrapY, x1, x2, y1, y2;
      end1 = turtles[link.end1];
      end2 = turtles[link.end2];
      x1 = end1.xcor;
      y1 = end1.ycor;
      x2 = end2.xcor;
      y2 = end2.ycor;
      wrapX = canWrapX && (x1 - (x2 - this.patchWidth) < Math.abs(x1 - x2)) || (x2 - (x1 - this.patchWidth)) < Math.abs(x1 - x2);
      wrapY = canWrapY && (y1 - (y2 - this.patchHeight) < Math.abs(y1 - y2)) || (y2 - (y1 - this.patchHeight) < Math.abs(y1 - y2));
      this.ctx.strokeStyle = netlogoColorToCSS(link.color);
      this.ctx.lineWidth = link.thickness > this.onePixel ? link.thickness : this.onePixel;
      this.ctx.beginPath();
      if (wrapX && wrapY) {
        if (x1 < x2) {
          if (y1 < y2) {
            this.drawLine(x1, y1, x2 - this.patchWidth, y2 - this.patchHeight);
            this.drawLine(x1 + this.patchWidth, y1, x2, y2 - this.patchHeight);
            this.drawLine(x1 + this.patchWidth, y1 + this.patchHeight, x2, y2);
            this.drawLine(x1, y1 + this.patchHeight, x2 - this.patchWidth, y2);
          } else {
            this.drawLine(x1, y1, x2 - this.patchWidth, y2 + this.patchHeight);
            this.drawLine(x1 + this.patchWidth, y1, x2, y2 + this.patchHeight);
            this.drawLine(x1 + this.patchWidth, y1 - this.patchHeight, x2, y2);
            this.drawLine(x1, y1 - this.patchHeight, x2 - this.patchWidth, y2);
          }
        } else {
          if (y1 < y2) {
            this.drawLine(x1, y1, x2 + this.patchWidth, y2 - this.patchHeight);
            this.drawLine(x1 - this.patchWidth, y1, x2, y2 - this.patchHeight);
            this.drawLine(x1 - this.patchWidth, y1 + this.patchHeight, x2, y2);
            this.drawLine(x1, y1 + this.patchHeight, x2 + this.patchWidth, y2);
          } else {
            this.drawLine(x1, y1, x2 + this.patchWidth, y2 + this.patchHeight);
            this.drawLine(x1 - this.patchWidth, y1, x2, y2 + this.patchHeight);
            this.drawLine(x1 - this.patchWidth, y1 - this.patchHeight, x2, y2);
            this.drawLine(x1, y1 - this.patchHeight, x2 + this.patchWidth, y2);
          }
        }
      } else if (wrapX) {
        if (x1 < x2) {
          this.drawLine(x1, y1, x2 - this.patchWidth, y2);
          this.drawLine(x1 + this.patchWidth, y1, x2, y2);
        } else {
          this.drawLine(x1, y1, x2 + this.patchWidth, y2);
          this.drawLine(x1 - this.patchWidth, y1, x2, y2);
        }
      } else if (wrapY) {
        if (y1 < y2) {
          this.drawLine(x1, y1, x2, y2 - this.patchHeight);
          this.drawLine(x1, y1 + this.patchHeight, x2, y2);
        } else {
          this.drawLine(x1, y1 - this.patchHeight, x2, y2);
          this.drawLine(x1, y1, x2, y2 + this.patchHeight);
        }
      } else {
        this.drawLine(x1, y1, x2, y2);
      }
      return this.ctx.stroke();
    };

    TurtleView.prototype.repaint = function(model) {
      var id, link, links, turtle, turtles, world;
      world = model.world;
      turtles = model.turtles;
      links = model.links;
      this.transformToWorld(world);
      if (world.turtleshapelist !== this.drawer.shapes && typeof world.turtleshapelist === "object") {
        this.drawer = new CachingShapeDrawer(world.turtleshapelist);
      }
      for (id in links) {
        link = links[id];
        this.drawLink(link, turtles, world.wrappingallowedinx, world.wrappingallowediny);
      }
      this.ctx.lineWidth = this.onePixel;
      for (id in turtles) {
        turtle = turtles[id];
        this.drawTurtle(turtle, world.wrappingallowedinx, world.wrappingallowediny);
      }
    };

    return TurtleView;

  })(View);

  PatchView = (function(_super) {

    __extends(PatchView, _super);

    function PatchView() {
      PatchView.__super__.constructor.call(this);
      this.scratchCanvas = document.createElement('canvas');
      this.scratchCtx = this.scratchCanvas.getContext('2d');
      this.quality = 2;
    }

    PatchView.prototype.transformToWorld = function(world) {
      PatchView.__super__.transformToWorld.call(this, world);
      this.scratchCanvas.width = this.patchWidth;
      this.scratchCanvas.height = this.patchHeight;
      this.ctx.imageSmoothingEnabled = false;
      this.ctx.webkitImageSmoothingEnabled = false;
      this.ctx.mozImageSmoothingEnabled = false;
      this.ctx.oImageSmoothingEnabled = false;
      this.ctx.fillStyle = 'black';
      return this.ctx.fillRect(this.minpxcor - .5, this.minpycor - .5, this.patchWidth, this.patchHeight);
    };

    PatchView.prototype.colorPatches = function(patches) {
      var b, g, i, ignore, imageData, patch, r, trans, _ref, _results;
      imageData = this.ctx.createImageData(this.patchWidth, this.patchHeight);
      for (ignore in patches) {
        patch = patches[ignore];
        _ref = netlogoColorToRGB(patch.pcolor), r = _ref[0], g = _ref[1], b = _ref[2];
        i = ((this.maxpycor - patch.pycor) * this.patchWidth + (patch.pxcor - this.minpxcor)) * 4;
        imageData.data[i + 0] = r;
        imageData.data[i + 1] = g;
        imageData.data[i + 2] = b;
        imageData.data[i + 3] = 255;
      }
      this.scratchCtx.putImageData(imageData, 0, 0);
      trans = this.minpycor + this.maxpycor;
      this.ctx.translate(0, trans);
      this.ctx.scale(1, -1);
      this.ctx.drawImage(this.scratchCanvas, this.minpxcor - .5, this.minpycor - .5, this.patchWidth, this.patchHeight);
      this.ctx.scale(1, -1);
      this.ctx.translate(0, -trans);
      _results = [];
      for (ignore in patches) {
        patch = patches[ignore];
        _results.push(this.drawLabel(patch.plabel, patch['plabel-color'], patch.pxcor + .5, patch.pycor - .5));
      }
      return _results;
    };

    PatchView.prototype.repaint = function(model) {
      var patches, world;
      world = model.world;
      patches = model.patches;
      if (!this.matchesWorld(world)) {
        this.transformToWorld(world);
      }
      return this.colorPatches(patches);
    };

    return PatchView;

  })(View);

}).call(this);
;
(function() {
  var Connection;

  window.connect = function(socketURL) {
    return new Connection(new WebSocket(socketURL));
  };

  Connection = (function() {

    function Connection(socket) {
      var _this = this;
      this.socket = socket;
      this.listeners = {
        'all': []
      };
      this.outbox = [];
      this.socket.onmessage = function(event) {
        return _this.dispatch(JSON.parse(event.data));
      };
      this.socket.onopen = function() {
        var msg, _i, _len, _ref, _results;
        _ref = _this.outbox;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          msg = _ref[_i];
          _results.push(_this.send(msg));
        }
        return _results;
      };
    }

    Connection.prototype.send = function(message) {
      if (this.socket.readyState === this.socket.OPEN) {
        return this.socket.send(JSON.stringify(message));
      } else {
        return this.outbox.push(message);
      }
    };

    Connection.prototype.dispatch = function(msg) {
      var listener, _i, _j, _len, _len1, _ref, _ref1, _results;
      _ref = this.listeners['all'];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        listener = _ref[_i];
        listener(msg);
      }
      if (!(this.listeners[msg.kind] != null)) {
        this.listeners[msg.kind] = [];
      }
      _ref1 = this.listeners[msg.kind];
      _results = [];
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        listener = _ref1[_j];
        _results.push(listener(msg));
      }
      return _results;
    };

    Connection.prototype.on = function(kind, listener) {
      if (!(this.listeners[kind] != null)) {
        this.listeners[kind] = [];
      }
      return this.listeners[kind].push(listener);
    };

    return Connection;

  })();

}).call(this);
;
(function() {

  window.SessionLite = (function() {

    SessionLite.controller = void 0;

    function SessionLite(container) {
      container.innerHTML = "";
      this.controller = new AgentStreamController(container);
    }

    SessionLite.prototype.update = function(modelUpdate) {
      var update, _i, _len;
      if (modelUpdate instanceof Array) {
        for (_i = 0, _len = modelUpdate.length; _i < _len; _i++) {
          update = modelUpdate[_i];
          this.controller.update(update);
        }
      } else {
        this.controller.update(modelUpdate);
      }
      return this.controller.repaint();
    };

    return SessionLite;

  })();

}).call(this);
/////// Personalization start here!
/////// Set mParams.graphInput and modelType appropriately for different steps
/////// modelType can be "sunshine-temp", "wind-temp", "ghg-temp","ghguv-temp", "ozone-temp", "ozone-cancer", "ghg-cancer"
var mParams = {graphInput: true, modelType: "ozone-cancer"};
if (mParams.modelType == "sunshine-temp"){
  mParams.inputName = "Sunshine";
  mParams.inputId = "sunshine";
  mParams.inputColor = "#AAAA00";
  mParams.inputFun = null;
  mParams.outputYAxisMax = 40;
  mParams.runUv = false;
} else if (mParams.modelType == "wind-temp"){
  mParams.inputName = "Wind";
  mParams.inputId = "wind";
  mParams.inputColor = "#008888";
  mParams.inputFun = null;
  mParams.outputYAxisMax = 40;
  mParams.runUv = false;
} else if (mParams.modelType == "litter-temp"){
  mParams.inputName = "Litter";
  mParams.inputId = "litter"
  mParams.inputColor = "#888888";
  mParams.inputFun = "litter_slider";
  mParams.outputYAxisMax = 80;
  mParams.runUv = false;
} else if (mParams.modelType == "ghg-temp" || mParams.modelType == "ghg-cancer" || mParams.modelType == "ghguv-temp"){
  mParams.inputName = "Greenhouse Gases";
  mParams.inputId = "greenhouse-gases";
  mParams.inputColor = "#444488";
  mParams.inputFun = "ghg_slider";
  mParams.outputYAxisMax = 80;
  if (mParams.modelType == "ghg-temp"){
    mParams.runUv = false;  
  } else {
    mParams.runUv = true;
  }
} else if (mParams.modelType == "ozone-temp" || mParams.modelType == "ozone-cancer"){
  mParams.inputName = "Ozone Layer";
  mParams.inputId = "ozone-layer";
  mParams.inputColor = "#FF0000";
  mParams.inputFun = "ozone_slider";
  mParams.outputYAxisMax = 80;
  mParams.runUv = true;
}

if (!mParams.runUv){
  var element = document.getElementById("watch-uv-button");
  element.parentNode.removeChild(element);
}

if (mParams.modelType == "ghg-cancer" || mParams.modelType == "ozone-cancer"){
  mParams.outputName = "Skin Cancer";
  mParams.outputId = "skin-cancer";
  mParams.outputYAxisTitle = "Cases of Skin Cancer";
  mParams.outputUnits = "cases";
  mParams.outputColor = "#008800";
} else {
  mParams.outputName = "Temperature";
  mParams.outputId = "temperature";
  mParams.outputYAxisTitle = "Temperature (Celsius)";
  mParams.outputUnits = "degrees Celsisus";
  mParams.outputColor = "#880088";
}


if (mParams.graphInput){
   var element = document.getElementById("input-slider-div");
   element.parentNode.removeChild(element);
} else {  
  document.getElementById("input-slider-label").textContent = mParams.inputName + " ";
}

Globals.init(10);
world = new World(-24, 24, -15, 15, 11.041, false, true, {"default":{"rotate":true,"elements":[{"xcors":[150,40,150,260],"ycors":[5,250,205,250],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"airplane":{"rotate":true,"elements":[{"xcors":[150,135,120,120,15,15,120,135,105,120,150,180,210,165,180,285,285,180,180,165],"ycors":[0,15,60,105,165,195,180,240,270,285,270,285,270,240,180,195,165,105,60,15],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"arrow":{"rotate":true,"elements":[{"xcors":[150,0,105,105,195,195,300],"ycors":[0,150,150,293,293,150,150],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"black ball":{"rotate":true,"elements":[{"x":45,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":135,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"box":{"rotate":false,"elements":[{"xcors":[150,285,285,150],"ycors":[285,225,75,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,15,150,285],"ycors":[135,75,15,75],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[15,15,150,150],"ycors":[75,225,285,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":285,"x2":150,"y2":135,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":15,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":135,"x2":285,"y2":75,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"bug":{"rotate":true,"elements":[{"x":96,"y":182,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":127,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":110,"y":75,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":150,"y1":100,"x2":80,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":150,"y1":100,"x2":220,"y2":30,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"butterfly":{"rotate":true,"elements":[{"xcors":[150,209,225,225,195,165,150],"ycors":[165,199,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,89,75,75,105,135,150],"ycors":[165,198,225,255,270,255,240],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[139,100,55,25,10,10,25,40,85,139],"ycors":[148,105,90,90,105,135,180,195,194,163],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[162,200,245,275,290,290,275,260,215,162],"ycors":[150,105,90,90,105,135,180,195,195,165],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[150,135,120,135,150,165,180,165],"ycors":[255,225,150,120,105,120,150,225],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":135,"y":90,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":105,"x2":195,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x1":150,"y1":105,"x2":105,"y2":60,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"car":{"rotate":false,"elements":[{"xcors":[300,279,261,240,226,213,203,185,159,135,75,0,0,0,300,300],"ycors":[180,164,144,135,132,106,84,63,50,50,60,150,165,225,225,180],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":180,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":30,"y":180,"diam":90,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[162,132,134,209,194,189,180],"ycors":[80,78,135,135,105,96,89],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":47,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":195,"y":195,"diam":58,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"circle 3":{"rotate":false,"elements":[{"x":2,"y":2,"diam":297,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":12,"y":12,"diam":277,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":23,"y":23,"diam":255,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"cloud":{"rotate":false,"elements":[{"x":13,"y":118,"diam":94,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":86,"y":101,"diam":127,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":51,"y":51,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":118,"y":43,"diam":95,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":158,"y":68,"diam":134,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"co2":{"rotate":true,"elements":[{"x":0,"y":90,"diam":120,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":90,"diam":120,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":75,"y":75,"diam":150,"type":"circle","color":"rgba(52, 93, 169, 1.0)","filled":true,"marked":false}]},"cow":{"rotate":false,"elements":[{"xcors":[200,197,179,177,166,140,93,78,72,49,48,37,25,25,45,103,179,198,252,272,293,285,255,242,224],"ycors":[193,249,249,196,187,189,191,179,211,209,181,149,120,89,72,84,75,76,64,81,103,121,121,118,167],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[73,86,62,48],"ycors":[210,251,249,208],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[25,16,9,23,25,39],"ycors":[114,195,204,213,200,123],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"cylinder":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"dot":{"rotate":false,"elements":[{"x":90,"y":75,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"face happy":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[255,239,213,191,179,203,218,225,218,203,181,194,217,240],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face neutral":{"rotate":false,"elements":[{"x":8,"y":7,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":60,"ymin":195,"xmax":240,"ymax":225,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"face sad":{"rotate":false,"elements":[{"x":8,"y":8,"diam":285,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":60,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":180,"y":75,"diam":60,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[150,90,62,47,67,90,109,150,192,210,227,251,236,212],"ycors":[168,184,210,232,244,220,205,198,205,220,242,229,206,183],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"fish":{"rotate":false,"elements":[{"xcors":[44,21,15,0,15,0,13,20,45],"ycors":[131,87,86,120,150,180,214,212,166],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[135,119,95,76,46,60],"ycors":[195,235,218,210,204,165],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[75,83,71,86,166,135],"ycors":[45,77,103,114,78,60],"type":"polygon","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[30,151,226,280,292,292,287,270,195,151,30],"ycors":[136,77,81,119,146,160,170,195,210,212,166],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":215,"y":106,"diam":30,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"flag":{"rotate":false,"elements":[{"xmin":60,"ymin":15,"xmax":75,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[90,270,90],"ycors":[150,90,30],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":75,"y1":135,"x2":90,"y2":135,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":75,"y1":45,"x2":90,"y2":45,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"flower":{"rotate":false,"elements":[{"xcors":[135,165,180,180,150,165,195,195,165],"ycors":[120,165,210,240,300,300,240,195,135],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"x":85,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":147,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":192,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":85,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":40,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":177,"y":132,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":70,"y":85,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":130,"y":25,"diam":38,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":96,"y":51,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":113,"y":68,"diam":74,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[189,219,249,279,234],"ycors":[233,188,173,188,218],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[180,150,105,75,135],"ycors":[255,210,210,240,240],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false}]},"house":{"rotate":false,"elements":[{"xmin":45,"ymin":120,"xmax":255,"ymax":285,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":210,"xmax":180,"ymax":285,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xcors":[15,150,285],"ycors":[120,15,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":30,"y1":120,"x2":270,"y2":120,"type":"line","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"leaf":{"rotate":false,"elements":[{"xcors":[150,135,120,60,30,60,60,15,30,15,40,45,60,90,105,120,105,120,135,150,165,180,195,180,195,210,240,255,263,285,270,285,240,240,270,240,180,165],"ycors":[210,195,210,210,195,180,165,135,120,105,104,90,90,105,120,120,60,60,30,15,30,60,60,120,120,105,90,90,104,105,120,135,165,180,195,210,210,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,135,120,105,105,135,165,165],"ycors":[195,240,255,255,285,285,240,195],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"line":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":300,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"line half":{"rotate":true,"elements":[{"x1":150,"y1":0,"x2":150,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"molecule water":{"rotate":true,"elements":[{"x":183,"y":63,"diam":84,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"x":183,"y":63,"diam":84,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x":75,"y":75,"diam":150,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":75,"y":75,"diam":150,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false},{"x":33,"y":63,"diam":84,"type":"circle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"x":33,"y":63,"diam":84,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":false,"marked":false}]},"ozone":{"rotate":true,"elements":[{"x":51,"y":81,"diam":108,"type":"circle","color":"rgba(215, 50, 41, 1.0)","filled":true,"marked":false},{"x":156,"y":66,"diam":108,"type":"circle","color":"rgba(215, 50, 41, 1.0)","filled":true,"marked":false},{"x":126,"y":156,"diam":108,"type":"circle","color":"rgba(215, 50, 41, 1.0)","filled":true,"marked":false},{"x":51,"y":81,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":false},{"x":156,"y":66,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":false},{"x":126,"y":156,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":false}]},"pentagon":{"rotate":false,"elements":[{"xcors":[150,15,60,240,285],"ycors":[15,120,285,285,120],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"person":{"rotate":false,"elements":[{"x":110,"y":5,"diam":80,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,120,90,105,135,150,165,195,210,180,195],"ycors":[90,195,285,300,300,225,300,300,285,195,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":127,"ymin":79,"xmax":172,"ymax":94,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[195,240,225,165],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[105,60,75,135],"ycors":[90,150,180,105],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"plant":{"rotate":false,"elements":[{"xmin":135,"ymin":90,"xmax":165,"ymax":300,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,210,255,225,165],"ycors":[255,210,195,255,285],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[180,135,120,180,210],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[180,210,180,120,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,90,45,75,135],"ycors":[105,60,45,105,135],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[165,165,225,255,210],"ycors":[105,135,105,45,60],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[135,120,150,180,165],"ycors":[90,45,15,45,90],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"square":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"square 2":{"rotate":false,"elements":[{"xmin":30,"ymin":30,"xmax":270,"ymax":270,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":60,"ymin":60,"xmax":240,"ymax":240,"type":"rectangle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"star":{"rotate":false,"elements":[{"xcors":[151,185,298,207,242,151,59,94,3,116],"ycors":[1,108,108,175,282,216,282,175,108,108],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"target":{"rotate":false,"elements":[{"x":0,"y":0,"diam":300,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":60,"y":60,"diam":180,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":90,"y":90,"diam":120,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"tree":{"rotate":false,"elements":[{"x":118,"y":3,"diam":94,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":120,"ymin":195,"xmax":180,"ymax":300,"type":"rectangle","color":"rgba(157, 110, 72, 1.0)","filled":true,"marked":false},{"x":65,"y":21,"diam":108,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":116,"y":41,"diam":127,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":45,"y":90,"diam":120,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":104,"y":74,"diam":152,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"triangle 2":{"rotate":false,"elements":[{"xcors":[150,15,285],"ycors":[30,255,255],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[151,225,75],"ycors":[99,223,224],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false}]},"truck":{"rotate":false,"elements":[{"xmin":4,"ymin":45,"xmax":195,"ymax":187,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[296,296,259,244,208,207],"ycors":[193,150,134,104,104,194],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xmin":195,"ymin":60,"xmax":195,"ymax":105,"type":"rectangle","color":"rgba(255, 255, 255, 1.0)","filled":true,"marked":false},{"xcors":[238,252,219,218],"ycors":[112,141,141,112],"type":"polygon","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"xmin":181,"ymin":185,"xmax":214,"ymax":194,"type":"rectangle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x":24,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":144,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":234,"y":174,"diam":42,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"turtle":{"rotate":true,"elements":[{"xcors":[215,240,246,228,215,193],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[195,225,245,260,269,261,240,225,210],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[105,75,55,40,31,39,60,75,90],"ycors":[90,75,75,89,108,124,105,105,105],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[132,134,107,108,150,192,192,169,172],"ycors":[85,64,51,17,2,18,52,65,87],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[85,60,54,72,85,107],"ycors":[204,233,254,266,252,210],"type":"polygon","color":"rgba(89, 176, 60, 1.0)","filled":true,"marked":false},{"xcors":[119,179,209,224,220,175,128,81,74,88],"ycors":[75,75,101,135,225,261,261,224,135,99],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]},"wheel":{"rotate":false,"elements":[{"x":3,"y":3,"diam":294,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x":30,"y":30,"diam":240,"type":"circle","color":"rgba(0, 0, 0, 1.0)","filled":true,"marked":false},{"x1":150,"y1":285,"x2":150,"y2":15,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":15,"y1":150,"x2":285,"y2":150,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x":120,"y":120,"diam":60,"type":"circle","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"x1":216,"y1":40,"x2":79,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":84,"x2":269,"y2":221,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":40,"y1":216,"x2":269,"y2":79,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true},{"x1":84,"y1":40,"x2":221,"y2":269,"type":"line","color":"rgba(141, 141, 141, 1.0)","filled":false,"marked":true}]},"x":{"rotate":false,"elements":[{"xcors":[270,225,30,75],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true},{"xcors":[30,75,270,225],"ycors":[75,30,225,270],"type":"polygon","color":"rgba(141, 141, 141, 1.0)","filled":true,"marked":true}]}}, {"default":{}}, 1);
Breeds.add("CLOUDS", "cloud");
Breeds.get("CLOUDS").vars =["CLOUD-NUM"];
Breeds.add("SUNRAYS", "sunray");
Breeds.get("SUNRAYS").vars =[""];
Breeds.add("IRS", "ir");
Breeds.get("IRS").vars =[""];
Breeds.add("HEATS", "heat");
Breeds.get("HEATS").vars =[""];
Breeds.add("CO2S", "co2");
Breeds.get("CO2S").vars =[""];
Breeds.add("LITTER", "turtle");
Breeds.get("LITTER").vars =[""];
Breeds.add("OZONES", "ozone");
Breeds.get("OZONES").vars =["STEPS-SINCE-LAST-HIT"];
Breeds.add("UVS", "uv");
Breeds.get("UVS").vars =[""];
Breeds.add("STATIC-LABELS", "static-label");
Breeds.get("STATIC-LABELS").vars =[""];
Breeds.add("CIRCLES", "circle");
Breeds.get("CIRCLES").vars =[""];

var graph, graph2;
var sunshine_ticks = 0;
function setup() {
  // if we are using the graph as input, destroy the slider 
  world.clearAll();
  setupWorld();
  setupLabels();
  showLabels();
  world.resetTicks();
  if (graph) graph.destroy(); 
   var plotSpecs = {
    chart:{
      renderTo: 'chart',
      type: 'line',
      zoomType: 'x',
      height: 200,
      width: 350,
      marginRight: 0,
      events: {
        click: function(e) {
          if (mParams.graphInput){
            var x = e.xAxis[0].value;
            var y = e.yAxis[0].value;
            var series = this.series[0];
            tortoise_addPoint(series, x, y);
          }
        }
      }
    },
    plotOptions: {
      series: {
        point: {
          events: {
            'click': function(){
              if (mParams.graphInput && this.series.data.length > 1){
                tortoise_removePoint(this.series, this);
              }
            }
          }
        }
      }
    },
    credits:{enabled:false},
    title: {text: mParams.inputName, style:{fontSize:"11pt"}},
    legend: {enabled:false},
    xAxis: {
      title: {
        text: "Time (years)",
        style:{
          color:"#222222",
          fontWeight:"bold"
        }},
      min: 500,
      max: 5000,
      tickColor:"#222222",
      lineColor:"#222222",
      labels:{
        style:{
          color:"#222222",
          fontWeight:"bold"
        }
      },
      plotLines: [{
        color: '#222222',
        width: 1,
        value: 500
      }],
      plotBands: [{
        color: '#F8F8F8', 
        from: 500, 
        to: 5000 
      }]
    },
    yAxis: {
      title: {text: "% of Total",style:{
          color:"#222222",
          fontWeight:"bold"
        }},
      showLastLabel: true,
      min: 0,
      max: 100,
      tickColor:"#222222",
      lineColor:"#222222",
      tickInterval: 25,
      labels:{
        style:{
          color:"#222222",
          fontWeight:"bold"
        }
      }
    },
    tooltip:{enabled:false},
    series: [
      {id:mParams.inputId, name:mParams.inputName, color:mParams.inputColor,lineWidth:2, data:[]}
    ]
  };
  graph = new Highcharts.Chart(plotSpecs);
  
  if (graph2) graph2.destroy();
  var plotSpecs = {
    chart:{
      renderTo: 'chart2',
      type: 'line',
      zoomType: 'x',
      height: 200,
      width: 350,
      marginRight: 0,
      events: {
        click: function(e) {
          if (mParams.graphInput){
            var x = e.xAxis[0].value;
            var y = e.yAxis[0].value;
            var series = this.series[1];
            tortoise_addPoint(series, x, y);
          }
        }
      }
    },
    credits:{enabled:false},
    title: {text: mParams.outputName, style:{fontSize:"11pt"}},
    legend: {enabled:false},
    xAxis: {
      title: {
        text: "Time (years)",
        style:{
          color:"#222222",
          fontWeight:"bold"
        }},
      min: 500,
      max:5000,
      tickColor:"#222222",
      lineColor:"#222222",
      labels:{
        style:{
          color:"#222222",
          fontWeight:"bold"
        }
      },
      plotLines: [{
        color: '#222222',
        width: 1,
        value: 500
      }],
      plotBands: [{
        color: '#F8F8F8', 
        from: 500, 
        to: 5000 
      }]
    },
    yAxis: {
      title: {text: mParams.outputYAxisTitle,style:{
          color:"#222222",
          fontWeight:"bold"
        }},
      showLastLabel: true,
      min: 0,
      max: mParams.outputYAxisMax,
      tickColor:"#222222",
      lineColor:"#222222",
      tickInterval: 10,
      labels:{
        style:{
          color:"#222222",
          fontWeight:"bold"
        }
      }
    },
    tooltip: {
      formatter:function(){return '<b>'+ this.series.name +'</b><br/>' + 'Time: <b>'+this.x.toFixed(0)+' </b>years<br/>'+mParams.outputName+':   <b>'+this.y.toFixed(1)+' </b>'+mParams.outputUnits+'<br/>';}
    },
    series: [
      {id:"actual", name:"Actual", color:mParams.outputColor,lineWidth:2, data:[]},
      {id:"prediction", name:"Prediction", color:mParams.outputColor,lineWidth:1, dashStyle:"Dot", data:[], point: {
          events: {
            'click': function(){
              if (this.series.data.length > 1 && mParams.graphInput){
                tortoise_removePoint(this.series, this);
              }
            }
          }
        }    
      }
    ]
  };
  graph2 = new Highcharts.Chart(plotSpecs);
}
function setupLabels() {
  AgentSet.ask(world.createTurtles(1, "STATIC-LABELS"), true, function() {
    Prims.setXY(0, 0);
    AgentSet.setTurtleVariable(6, "Atmosphere");
    AgentSet.setTurtleVariable(10, 0);
  });
  AgentSet.ask(world.createTurtles(1, "STATIC-LABELS"), true, function() {
    Prims.setXY(0, (Globals.getGlobal(2) - 0.4));
    AgentSet.setTurtleVariable(6, "Surface of Earth");
  });
  AgentSet.ask(world.createTurtles(1, "STATIC-LABELS"), true, function() {
    Prims.setXY(0, (world.maxPycor - 1));
    AgentSet.setTurtleVariable(6, "Space");
  });
  AgentSet.ask(world.createTurtles(1, "STATIC-LABELS"), true, function() {
    Prims.setXY(0, (0.8 * world.minPycor));
    AgentSet.setTurtleVariable(6, "Beneath surface of Earth");
  });
  AgentSet.ask(world.turtlesOfBreed("STATIC-LABELS"), true, function() {
    AgentSet.self().hideTurtle(true);;
    AgentSet.setTurtleVariable(10, 0);
  });
  AgentSet.ask(world.createTurtles(1, "CIRCLES"), true, function() {
    AgentSet.setTurtleVariable(1, 125);
    AgentSet.setTurtleVariable(6, "Infrared");
    Prims.setXY(15, 10); //offscreen
  });
  AgentSet.ask(world.createTurtles(1, "CIRCLES"), true, function() {
    AgentSet.setTurtleVariable(1, 45);
    AgentSet.setTurtleVariable(6, "Solar ray");
    Prims.setXY(15, -10); //offscreen
  });
  AgentSet.ask(world.createTurtles(1, "CIRCLES"), true, function() {
    AgentSet.setTurtleVariable(1, 15);
    AgentSet.setTurtleVariable(6, "Heat");
    Prims.setXY(-15, -10); //offscreen
  });
  if (mParams.runUv){
    AgentSet.ask(world.createTurtles(1, "CIRCLES"), true, function() {
      AgentSet.setTurtleVariable(1, 117);
      AgentSet.setTurtleVariable(6, "Ultraviolet");
      Prims.setXY(-15, 15); //offscreen
    });
  }
  AgentSet.ask(world.turtlesOfBreed("CIRCLES"), true, function() {
    AgentSet.self().hideTurtle(true);
    AgentSet.setTurtleVariable(10, 3);
    AgentSet.setTurtleVariable(5, "circle 3");
  });
}
function hideLabels() {
  AgentSet.ask(world.turtlesOfBreed("STATIC-LABELS"), true, function() {
    AgentSet.self().die();
  });
  AgentSet.ask(world.turtlesOfBreed("CIRCLES"), true, function() {
    AgentSet.self().die();
  });
}
function showLabels() {
  AgentSet.ask(world.turtlesOfBreed("STATIC-LABELS"), true, function() {
    AgentSet.self().hideTurtle(false);

    AgentSet.self().setTurtleVariable(10, 0.1);
  });
  var x = 0;
  var y = 0;
  if (AgentSet.any(world.turtlesOfBreed("SUNRAYS"))) {
    AgentSet.ask(AgentSet.oneOf(world.turtlesOfBreed("SUNRAYS")), true, function() {
      x = AgentSet.getTurtleVariable(3);
      y = AgentSet.getTurtleVariable(4);
    });
    AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("CIRCLES"), function() {
      return Prims.equality(AgentSet.getTurtleVariable(1), 45)
    }), true, function() {
      Prims.setXY(x, y);
      AgentSet.self().hideTurtle(false);;
    });
  }
  var target = AgentSet.oneOf(world.turtlesOfBreed("IRS"));
  if (!(Prims.equality(target, Nobody))) {
    x = AgentSet.of(target, function() {
      return AgentSet.getTurtleVariable(3)
    });
    y = AgentSet.of(target, function() {
      return AgentSet.getTurtleVariable(4)
    });
    AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("CIRCLES"), function() {
      return Prims.equality(AgentSet.getTurtleVariable(1), 125)
    }), true, function() {
      Prims.setXY(x, y);
      AgentSet.self().hideTurtle(false);
    });
  }
  target = AgentSet.oneOf(world.turtlesOfBreed("HEATS"));
  if (!(Prims.equality(target, Nobody))) {
    x = AgentSet.of(target, function() {
      return AgentSet.getTurtleVariable(3)
    });
    y = AgentSet.of(target, function() {
      return AgentSet.getTurtleVariable(4)
    });
    AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("CIRCLES"), function() {
      return Prims.equality(AgentSet.getTurtleVariable(1), 15)
    }), true, function() {
      Prims.setXY(x, y);
      AgentSet.self().hideTurtle(false);
    });
  }
  if (mParams.runUv){
    target = AgentSet.oneOf(world.turtlesOfBreed("UVS"));
    if (!(Prims.equality(target, Nobody))) {
      x = AgentSet.of(target, function() {
        return AgentSet.getTurtleVariable(3)
      });
      y = AgentSet.of(target, function() {
        return AgentSet.getTurtleVariable(4)
      });
      AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("CIRCLES"), function() {
        return Prims.equality(AgentSet.getTurtleVariable(1), 117)
      }), true, function() {
        Prims.setXY(x, y);
        AgentSet.self().hideTurtle(false);
      });
    }
  }
}

// to smooth temperature we wil collect sum of last 50 ticks
var ir_seq = [];
var ir_seq_sum = 0;
var uv_seq = [];
var uv_seq_sum = 0;
var uvs_below = 0;

function setupWorld() {
  sunshine_ticks = 0;
  // to smooth temperature we wil collect sum of last 50 ticks
  ir_seq = [];
  ir_seq_sum = 0;
  uv_seq = [];
  uv_seq_sum = 0;

  // See "Reference" for names
  var sun_brightness = getInputValueAtTime("sunshine", 0);
  Globals.setGlobal(7, 0.4); // albedo
  Globals.setGlobal(8, sun_brightness);
  Globals.setGlobal(1, (world.maxPycor - 5));
  Globals.setGlobal(2, (8 + world.minPycor));

  // set sun-brightness according to the first point
  var ghg = getInputValueAtTime("greenhouse-gases",0);
  var litter = getInputValueAtTime("litter",0);
  addCo2(ghg);
  addLitter(litter);
  if (mParams.runUv){
    addAllOzones();
    var oz = getInputValueAtTime("ozone-layer",0);
    if (oz != null && oz < 100){
     removeOzone(Math.round((100 - oz) / 100 * world.width()));
    }
  }
 
  AgentSet.ask(world.patches(), true, function() {
    if (Prims.equality(AgentSet.getPatchVariable(1), world.maxPycor)) {
      AgentSet.setPatchVariable(2, 0);
    }
    if (((AgentSet.getPatchVariable(1) < world.maxPycor) && (AgentSet.getPatchVariable(1) > Globals.getGlobal(1)))) {
      AgentSet.setPatchVariable(2, (9 - Prims.scaleColor(9.9, AgentSet.getPatchVariable(1), Globals.getGlobal(1), world.maxPycor)));
    }
    if (((AgentSet.getPatchVariable(1) <= Globals.getGlobal(1)) && (AgentSet.getPatchVariable(1) > Globals.getGlobal(2)))) {
      AgentSet.setPatchVariable(2, (105 + ((2 * (AgentSet.getPatchVariable(1) + world.maxPycor)) / world.maxPycor)));
    }
    if ((AgentSet.getPatchVariable(1) < Globals.getGlobal(2))) {
      AgentSet.setPatchVariable(2, (15 + 3));
    }
    updateAlbedo();
  });
  //JV UPDATED FOR COLD WORLD START
  var sunshine_per_tick = Globals.getGlobal(8) / 100; // number of sunrays expected per tick
  var sunshine_in_sky = Math.round((world.maxPycor - Globals.getGlobal(2)) * 10 / 3 * sunshine_per_tick);
  var uv_in_sky
  if (mParams.runUv){
    uv_in_sky = Math.round(sunshine_in_sky / 2);
  } else {
    uv_in_sky = 0;
  }
  //onsole.log("sunshine_in_sky",sunshine_in_sky);

  AgentSet.ask(world.createTurtles(Math.round(3 * sunshine_in_sky + 3 * uv_in_sky + ghg / 2), "HEATS"), true, function() {
    AgentSet.setTurtleVariable(2, 115 + Prims.random(40));
    Prims.setXY((world.minPxcor + Prims.random((world.maxPxcor - world.minPxcor))), (world.minPycor + Prims.random((Globals.getGlobal(2) - world.minPycor))));
    AgentSet.setTurtleVariable(1, (13 + Prims.random(2)));
    AgentSet.setTurtleVariable(5, "dot");
  });
  AgentSet.ask(world.createTurtles(sunshine_in_sky, "SUNRAYS"), true, function() {
    AgentSet.setTurtleVariable(2, 160);
    AgentSet.setTurtleVariable(1, 45);
    Prims.setXY((world.minPxcor + Prims.random((world.maxPxcor - world.minPxcor))), ((Globals.getGlobal(2) + Prims.random(world.maxPycor)) - Globals.getGlobal(2)));
  });
  AgentSet.ask(world.createTurtles(Math.round(sunshine_in_sky + ghg / 2 + uv_in_sky * 2), "IRS"), true, function() {
    AgentSet.setTurtleVariable(2, -20 + Prims.random(40));
    AgentSet.setTurtleVariable(1, 125);
    Prims.setXY((world.minPxcor + Prims.random((world.maxPxcor - world.minPxcor))), ((Globals.getGlobal(2) + Prims.random(world.maxPycor)) - Globals.getGlobal(2)));
    AgentSet.setTurtleVariable(5, "default");
  });
  AgentSet.ask(world.createTurtles(uv_in_sky, "UVS"), true, function() {
      AgentSet.setTurtleVariable(2, 160);
      AgentSet.setTurtleVariable(1, 117);
      Prims.setXY((world.minPxcor + Prims.random((world.maxPxcor - world.minPxcor))), ((Globals.getGlobal(2) + Prims.random(world.maxPycor)) - Globals.getGlobal(2)));
    });
  Globals.setGlobal(3, 1 + (0.5 * AgentSet.count(world.turtlesOfBreed("IRS"))));
  Globals.setGlobal(9, 1 + (3 * AgentSet.count(world.turtlesOfBreed("UVS"))));
  if (mParams.inputId=="sunshine" || mParams.inputId=="wind"){
    addCloud();
  }
}


function go() {
  hideLabels();
  if (Prims.equality(Globals.getGlobal(6), 0)) {
    Globals.setGlobal(6, 1);
    setupWorld();
  }
  // for graph condition update based on current graph values
  if (mParams.graphInput){
    litter_slider({"value":getInputValueAtTime("litter",world.ticks())});
    ghg_slider({"value":getInputValueAtTime("greenhouse-gases",world.ticks())});
    ozone_slider({"value":getInputValueAtTime("ozone-layer",world.ticks())});
  }
  
  runClouds();
  runSunshine();
  AgentSet.ask(world.patches(), true, function() {
    updateAlbedo();
  });
  runHeat();
  runIr();
  runCo2();
  if (mParams.runUv) runUv();
  runOzone();
  showLabels();

  if (ir_seq.length >= 200){
    var first = ir_seq.splice(0, 1)[0]; // remove first of sequence
    ir_seq_sum -= first;
  }
  var irs = AgentSet.count(world.turtlesOfBreed("IRS"));
  ir_seq.push(irs);
  ir_seq_sum += irs;
  var ir_avg = ir_seq_sum / ir_seq.length;
  // average with amount of sunshine - this is cheating but makes it more responsive to input
  if (mParams.inputId == "sunshine"){
    ir_avg = (ir_avg + AgentSet.count(world.turtlesOfBreed("SUNRAYS")))/2;
  }

  if (uv_seq.length >= 200){
    var first = uv_seq.splice(0, 1)[0]; // remove first of sequence
    uv_seq_sum -= first;
  }
  // here we must count UVS that are below space
  uv_seq.push(uvs_below);
  uv_seq_sum += uvs_below;
  var uv_avg = uv_seq_sum / uv_seq.length;

  // set outpus: first temperature, then skin cancer
  //Globals.setGlobal(3, (0.99 * Globals.getGlobal(3)) + (0.01 * (0.6 * ir_avg)));
  Globals.setGlobal(3, 0.5 * ir_avg);
  Globals.setGlobal(9, 3 * uv_avg);

  if (world.ticks() % 10 == 0){

    // only want to plot if within range
    if (world.ticks() >= graph2.xAxis[0].min && world.ticks() <= graph2.xAxis[0].max){
      if (!mParams.graphInput){
        graph.series[0].addPoint([world.ticks(), parseInt(document.getElementById('input-slider').value)], false);
        graph.redraw();
      } 

      // are we plotting temperature or ozone?
      if (mParams.outputId == "temperature"){
        graph2.series[0].addPoint([world.ticks(), Globals.getGlobal(3)], false);
      } else if (mParams.outputId == "skin-cancer"){
        graph2.series[0].addPoint([world.ticks(), Globals.getGlobal(9)], false);
      }
      graph2.redraw();
    }
  }
  world.tick();
}
//////////////////////////////////////// QUERRY MODEL
/** This function tells us what the value of a given parameter should be at any given time:
*** Params should match possible inputId or outputId in mParams
*** If the parameter is not controlled by user will give a constant value
*** If the parameter is controlled by graph, interpolates the graph.
*** If the parameter is controlled by the slider, finds current value of slider (ignores time) */

function getInputValueAtTime(param, time){
  var yval;
  // if we have exceeded bounds of graph stop the simulation.
  if (graph == null && mParams.graphInput) return null;
  if (time == 0 || time <= graph.xAxis[0].max){
    if (param == mParams.inputId){
      // this is the parameter under control by the user
      if (mParams.graphInput){
        yval = Math.round(interpolateGraphByTime(time));
      } else {
        yval = parseInt(document.getElementById('input-slider').value);
      }
      return yval;
    } else {
      // some constant value
      if (param == "sunshine"){
        return 50;
      } else if (param == "wind"){
        return 50;
      } else if (param == "greenhouse-gases"){
        return 0;
      } else if (param == "ozone-layer"){
        return 0;
      } else if (param == "litter"){
        return 0;
      } else {
        return 0;
      }
    }
  } else {
    stop();
    document.getElementById('go-button').value = "Go";
    return null;
  }
}


/** Interpolate a point on the graph by finding the endpoints of current segment */
function interpolateGraphByTime(time){
  if (graph == null || graph.series == null || graph.series.length == 0 || graph.series[0].data == null || graph.series[0].data.length == 0){
    return null;
  }
  var leftEnd = null;
  var rightEnd = null;
  for (var i = 0; i < graph.series[0].data.length; i++){
    var temp = graph.series[0].data[i];
    if (temp.x == time){
      return temp.y;
    } else if (temp.x < time){
     leftEnd = temp;
    } else {
      rightEnd = temp;
      break;
    }
  }
  if (leftEnd != null && rightEnd != null){
    var pct = (time - leftEnd.x) / (rightEnd.x - leftEnd.x);
    return pct * (rightEnd.y - leftEnd.y) + leftEnd.y;
  } else if (rightEnd == null){
    //console.log("reached end", runner);
    stop();
    document.getElementById('go-button').value = "Go";
    return null;
  } else if (leftEnd == null){
    // in this case we have empty space to left: use first value
    return rightEnd.y;
  } else {
    return null;
  }
}

/////////////////////////////////////////  AGENT SPECIFIC

function addCloud() {
  Globals.setGlobal(5, (Globals.getGlobal(5) + 1));
  setupClouds(Globals.getGlobal(5));
}
function removeCloud() {
  if ((Globals.getGlobal(5) > 0)) {
    Globals.setGlobal(5, (Globals.getGlobal(5) - 1));
    setupClouds(Globals.getGlobal(5));
  }
}
function setupClouds(n) {
  AgentSet.ask(world.turtlesOfBreed("CLOUDS"), true, function() {
    AgentSet.die();
  });
  var i = 0;
  Prims.repeat(n, function () {
    makeCloud(i, n);
    i = (i + 1);
  });
}
function makeCloud(k, n) {
  var width = (Globals.getGlobal(1) - Globals.getGlobal(2));
  var mid = ((Globals.getGlobal(1) + Globals.getGlobal(2)) / 2);
  var y = ((mid + (width * ((k / n) - 0.3))) - 2);
  if (Prims.equality(k, 0)) {
    y = 6;
  }
  var x = ((2 * Prims.random(world.maxPxcor)) + world.minPxcor);
  Prims.repeat((3 + Prims.random(20)), function () {
    AgentSet.ask(world.createTurtles(1, "CLOUDS"), true, function() {
      AgentSet.setBreedVariable("CLOUD-NUM", k);
      Prims.setXY(((x + Prims.random(9)) - 4), (y + Prims.random(Prims.random(5))));
      AgentSet.setTurtleVariable(1, 9.9);
      AgentSet.setTurtleVariable(10, (2 + Prims.random(2)));
      AgentSet.setTurtleVariable(2, 90);
      AgentSet.setTurtleVariable(5, "cloud");
    });
  });
}
function runClouds(){
  AgentSet.ask(world.turtlesOfBreed("CLOUDS"), true, function() {
    Prims.fd(0.3 * getInputValueAtTime("wind", world.ticks()) / 100);
  });
}


var brightness_array = [];

function shuffleArray( array ){
 var count = array.length,
     randomnumber,
     temp;
 while( count ){
  randomnumber = Math.random() * count-- | 0;
  temp = array[count];
  array[count] = array[randomnumber];
  array[randomnumber] = temp
 }
}

function updateAlbedo() {
  if (Prims.equality(AgentSet.getPatchVariable(1), Globals.getGlobal(2))) {
    AgentSet.setPatchVariable(2, (50 + (9 * Globals.getGlobal(7))));
  }
}

function runSunshine() {
  // NEW SET SUN-BRIGHTNESS (GLOBAL 8) BY INTERPOLATING GRAPH1
  var brightness_graph = getInputValueAtTime("sunshine", world.ticks());
  
  if (Globals.getGlobal(8) != brightness_graph){
    resetSunshineTicks(brightness_graph);
  }
  
  AgentSet.ask(world.turtlesOfBreed("SUNRAYS"), true, function() {
    Prims.fd(0.3);
    if ((AgentSet.getTurtleVariable(2) < 90 || AgentSet.getTurtleVariable(2) > 270) && AgentSet.getTurtleVariable(4) >= world.maxPycor){
      AgentSet.die();
    }
  });
  createSunshine();
  reflectSunraysFromClouds();
  encounterEarth();
}
/** Assigns values to an array of length 50 with number of sunshines to release on next 50 ticks */
function resetSunshineTicks(brightness_graph) {
    // NEW: The sun-brightness is now the number of sunrays distributed across 50 ticks;
    var brightness_left = Math.round(brightness_graph / 2);
    var brightness_div = Math.floor(brightness_left / 50);
    var brightness_to_assign = brightness_left - 50 * brightness_div;
    var arr0 = Array.apply(null, Array(50 - brightness_to_assign)).map(Number.prototype.valueOf,brightness_div);
    var arr1 = Array.apply(null, Array(brightness_to_assign)).map(Number.prototype.valueOf,brightness_div+1);
    //console.log("on tick", sunshine_ticks, ":", arr0.length, brightness_div,"'s and",arr1.length, brightness_div+1,"'s");
    brightness_array = arr0.concat(arr1);
    shuffleArray(brightness_array);
    Globals.setGlobal(8, brightness_graph);
    sunshine_ticks = 0;
}
function createSunshine() {
 //console.log("sunshine ticks", sunshine_ticks, "sunshines", brightness_array[sunshine_ticks]);
 if (sunshine_ticks < brightness_array.length){
    AgentSet.ask(world.createTurtles(brightness_array[sunshine_ticks], "SUNRAYS"), true, function() {
      AgentSet.setTurtleVariable(2, 160);
      AgentSet.setTurtleVariable(1, 45);
      Prims.setXY((world.minPxcor + Prims.random((world.maxPxcor - world.minPxcor))), world.maxPycor);
    });
    sunshine_ticks++;
  } else {
    resetSunshineTicks(getInputValueAtTime("sunshine", world.ticks()));
  }
}
function reflectSunraysFromClouds() {
  AgentSet.ask(world.turtlesOfBreed("SUNRAYS"), true, function() {
    if ((AgentSet.count(AgentSet.self().breedHere("CLOUDS")) > 0)) {
      AgentSet.setTurtleVariable(2, (180 - AgentSet.getTurtleVariable(2)));
    }
  });
}
function reflectIRSFromClouds() {
  AgentSet.ask(world.turtlesOfBreed("IRS"), true, function() {
    if ((AgentSet.count(AgentSet.self().breedHere("CLOUDS")) > 0)) {
      AgentSet.setTurtleVariable(2, (180 - AgentSet.getTurtleVariable(2)));
    }
  });
}
function reflectIRSFromOzone() {
  AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("IRS"), function() {
    return AgentSet.any(AgentSet.self().breedHere("OZONES"))
  }), true, function() {
    if(Prims.random(100) > 15) { /// PLAY WITH THIS NUMBER TO ADJUST HOW MUCH THE OZONE LAYER KEEPS THE EARTH WARM
      Prims.fd(0.5);
    } else {
      AgentSet.setTurtleVariable(2, (180 - AgentSet.getTurtleVariable(2)));
    }
  });
}


function encounterEarth() {
  AgentSet.ask(world.turtlesOfBreed("SUNRAYS"), true, function() {
    if ((AgentSet.getTurtleVariable(4) <= Globals.getGlobal(2))) {
      if (((100 * Globals.getGlobal(7)) > Prims.random(100))) {
        AgentSet.setTurtleVariable(2, 20);
      }
      else {
        AgentSet.setTurtleVariable(2, 115 + Prims.random(40));
        //repeat (random 1) [rt 90]
        
        AgentSet.setTurtleVariable(1, (13 + Prims.random(2)));
        AgentSet.setBreed(world.turtlesOfBreed("HEATS"));
        AgentSet.setTurtleVariable(5, "dot");
      }
    }
  });
}
function runHeat() {
  AgentSet.ask(world.turtlesOfBreed("HEATS"), true, function() {
    Prims.fd(0.3);
    // are we at bottom of Earth?
    if ((AgentSet.getTurtleVariable(4) <= world.minPycor)) {
      AgentSet.setTurtleVariable(2, 180 - AgentSet.getTurtleVariable(2));
      Prims.fd(0.6);
    } else {

      if ((AgentSet.getTurtleVariable(4) >= Globals.getGlobal(2))) {
        if ((Globals.getGlobal(3) > (-20 + Prims.random(200)))) {
          AgentSet.setBreed(world.turtlesOfBreed("IRS"));
          AgentSet.setTurtleVariable(2, -20 + Prims.random(40));
          AgentSet.setTurtleVariable(1, 125);
          AgentSet.setTurtleVariable(5, "default");
        }
        else {
          AgentSet.setTurtleVariable(2, 180 - AgentSet.getTurtleVariable(2));
        }
      }
    }
  });
}
function runIr() {
  AgentSet.ask(world.turtlesOfBreed("IRS"), true, function() {
    Prims.fd(0.3);
    if ((AgentSet.getTurtleVariable(4) >= world.maxPycor)) {
      AgentSet.die();
    }
    if ((AgentSet.getTurtleVariable(4) <= Globals.getGlobal(2))) {
      AgentSet.setBreed(world.turtlesOfBreed("HEATS"));
      AgentSet.setTurtleVariable(2, (95 + Prims.random(170)));
      AgentSet.setTurtleVariable(1, (13 + Prims.random(4)));
      AgentSet.setTurtleVariable(5, "dot");
    }
    if ((AgentSet.count(AgentSet.self().breedHere("CO2S")) > 0)) {
      AgentSet.setTurtleVariable(2, Prims.random(360));
    }
  });
  reflectIRSFromClouds();
  reflectIRSFromOzone();
}
function ghg_slider(e){
  var origco2 = Globals.getGlobal(4);
  var newco2 = 2*parseInt(e.value);
  if (newco2 > origco2){
    addCo2(newco2 - origco2);
  } else if (origco2 > newco2){
    removeCo2(origco2-newco2);
  }
}

function addCo2(value) {
  Prims.repeat(value, function () {
    if ((Globals.getGlobal(4) < 150)) {
      AgentSet.ask(world.createTurtles(1, "CO2S"), true, function() {
        var i = Prims.random(3);
        if (Prims.equality(i, 0)) {
          AgentSet.setTurtleVariable(5, "co2");
        }
        if (Prims.equality(i, 1)) {
          AgentSet.setTurtleVariable(5, "molecule water");
        }
        if (Prims.equality(i, 2)) {
          AgentSet.setTurtleVariable(5, "black ball");
        }
        AgentSet.setTurtleVariable(1, 0);
        Prims.setXY(Prims.random((2 * world.maxPxcor)) + world.minPxcor, Globals.getGlobal(2) + Prims.random(world.maxPycor-Globals.getGlobal(2)-2));
        AgentSet.setTurtleVariable(2, Prims.random(360));
      });
    }
    Globals.setGlobal(4, AgentSet.count(world.turtlesOfBreed("CO2S")));
  });
}
function removeCo2(value) {
  Prims.repeat(value, function () {
    if ((AgentSet.count(world.turtlesOfBreed("CO2S")) > 0)) {
      AgentSet.ask(AgentSet.oneOf(world.turtlesOfBreed("CO2S")), true, function() {
        AgentSet.die();
      });
    }
  });
  Globals.setGlobal(4, AgentSet.count(world.turtlesOfBreed("CO2S")));
}
function runCo2() {
  var d = 0;
  AgentSet.ask(world.turtlesOfBreed("CO2S"), true, function() {
    AgentSet.setTurtleVariable(2, ((AgentSet.getTurtleVariable(2) + Prims.random(51)) - 25));
    Prims.fd((0.01 * (5 + Prims.random(10))));
    if ((AgentSet.getTurtleVariable(4) <= (Globals.getGlobal(2) + 1))) {
      AgentSet.setTurtleVariable(2, (45 - Prims.random(90)));
    }
    if ((AgentSet.getTurtleVariable(4) >= Globals.getGlobal(1))) {
      AgentSet.setTurtleVariable(2, (135 + Prims.random(90)));
    }
  });
}

function litter_slider(e){
  var origlitter = AgentSet.count(world.turtlesOfBreed("LITTER"));
  var newlitter = parseInt(e.value);
  if (newlitter > origlitter){
    addLitter(newlitter - origlitter);
  } else if (origlitter > newlitter){
    removeLitter(origlitter-newlitter);
  }
}
function addLitter(value) {
  var width = world.maxPxcor - world.minPxcor;
  Prims.repeat(value, function () {
    if (AgentSet.count(world.turtlesOfBreed("LITTER")) < 150) {
      AgentSet.ask(world.createTurtles(1, "LITTER"), true, function() {
        AgentSet.setTurtleVariable(5, "square");
        //AgentSet.setTurtleVariable(1, 0);
        Prims.setXY(world.minPxcor + Prims.random(width),Globals.getGlobal(2));
        AgentSet.setTurtleVariable(2, Prims.random(360));
      });
    }
  });
}
function removeLitter(value) {
  Prims.repeat(value, function () {
    if ((AgentSet.count(world.turtlesOfBreed("LITTER")) > 0)) {
      AgentSet.ask(AgentSet.oneOf(world.turtlesOfBreed("LITTER")), true, function() {
        AgentSet.die();
      });
    }
  });
}

function ozone_slider(e){
  var origozone = AgentSet.count(world.turtlesOfBreed("OZONES"));
  var newozone = parseInt(e.value);
  var origozone_int = Math.round(origozone / 100 * world.width());
  var newozone_int = Math.round(newozone / 100 * world.width());
  if (newozone_int > origozone_int){
    addOzone(newozone_int - origozone_int);
  } else if (origozone_int > newozone_int){
    removeOzone(origozone_int - newozone_int);
  }
}

var regrow_time = 400000;
var ozoneArray = [];
var regrowArray = [];
function runOzone() {
  AgentSet.ask(world.turtlesOfBreed("OZONES"), true, function() {
    Prims.right(Prims.randomFloat(1));
    if ((AgentSet.count(AgentSet.self().breedHere("CFCS")) > 0)) {
      var r = Prims.random(100);
      if (r < 2) {
        //AgentSet.setTurtleVariable(1, [0, 0, 0, 0]);
        var x = AgentSet.self().getTurtleVariable(3);
        ozoneArray[x] = 0;
        regrowArray[x] = regrow_time * Math.random();
        AgentSet.self().die();
      }
      AgentSet.setBreedVariable("STEPS-SINCE-LAST-HIT", 0);
    }
    else {
      AgentSet.setBreedVariable("STEPS-SINCE-LAST-HIT", (AgentSet.getBreedVariable("STEPS-SINCE-LAST-HIT") + 1));
      if ((AgentSet.getBreedVariable("STEPS-SINCE-LAST-HIT") > regrow_time)) {
          AgentSet.setTurtleVariable(1, [255, 0, 0, 255]);
        }
    }
    
  });
  
  for (x in ozoneArray) {
    if(ozoneArray[x] >= 0) {
      ozoneArray[x]++;
    }
    
    if(ozoneArray[x] > regrowArray[x]) {
      AgentSet.ask(world.createTurtles(1, "OZONES"), true, function() {
        AgentSet.setTurtleVariable(5, "ozone");
        Prims.setXY(x, Globals.getGlobal(1));
      });
      ozoneArray[x] = -1;
    }
  }
}

function addAllOzones() {
  var numOzones = world.width();
  var i = world.minPxcor;
  Prims.repeat(numOzones, function () {
    AgentSet.ask(world.createTurtles(1, "OZONES"), true, function() {
      AgentSet.setTurtleVariable(5, "ozone");
      Prims.setXY(i, Globals.getGlobal(1));
    });
    ozoneArray[i] = -1;
    i = (i + 1);
  });
}



function addOzone(value) {
  var emptyIndices = [];
  for (var x in ozoneArray) {
    if (ozoneArray[x] >= 0){
      //empty spot
      emptyIndices.push(parseInt(x));
    }
  }
  
  emptyIndices = shuffle_array(emptyIndices).slice(0, value);

  for (var i = 0; i < emptyIndices.length; i++){
    x = emptyIndices[i];
    ozoneArray[x] = regrowArray[x];
  }
}
function removeOzone(value) {
  var fullIndices = [];
  for (var x in ozoneArray) {
    if (ozoneArray[x] == -1){
      //full spot
      fullIndices.push(parseInt(x));
    }
  }
  
  fullIndices = shuffle_array(fullIndices).slice(0, value);

  AgentSet.ask(world.turtlesOfBreed("OZONES"), true, function() {
    var x = parseInt(AgentSet.self().getTurtleVariable(3));
    if (fullIndices.indexOf(x) > -1){
      ozoneArray[x] = 0;
      regrowArray[x] = regrow_time * Math.random();
      AgentSet.self().die();
    }
  });
}

function addOneOzone() {
  var emptyIndices = [];
  for (var x in ozoneArray) {
    if (ozoneArray[x] >= 0){
      //empty spot
      emptyIndices.push(parseInt(x));
    }
  }
  
  emptyIndices = shuffle_array(emptyIndices).slice(0, 4);

  for (var i = 0; i < emptyIndices.length; i++){
    x = emptyIndices[i];
    ozoneArray[x] = regrowArray[x];
  }
}

function shuffle_array(o){ //v1.0
    for(var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
    return o;
  };

function runUv() {
  uvs_below = 0; // reset global variable
  AgentSet.ask(world.turtlesOfBreed("UVS"), true, function() {
    if (!(AgentSet.self().canMove(0.3))) {
      AgentSet.die();
    }
    Prims.fd(0.3);
    if (AgentSet.self()._ycor < Globals.getGlobal(1)){
      uvs_below++;
    }
  });
  createUv();
  reflectUvFromOzone();
  encounterEarthUv();
}
// use sunshine array to determine when a UV will fly off, but to ensure that only about half as much light do only on even ticks
function createUv() {
  var uv = world.ticks()%2==0 ? brightness_array[sunshine_ticks] : 0;
  AgentSet.ask(world.createTurtles(uv, "UVS"), true, function() {
      AgentSet.setTurtleVariable(2, 160);
      AgentSet.setTurtleVariable(1, 117);
      AgentSet.setTurtleVariable(10, 1);
      var x = (Prims.random(world.width()) + world.minPxcor);
      Prims.setXY(x, world.maxPycor);
    });
}
function reflectUvFromOzone() {
  AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("UVS"), function() {
    return AgentSet.any(AgentSet.self().breedHere("OZONES"))
  }), true, function() {
    if(Prims.random(100) > 90) {
      Prims.fd(0.7);
    } else {
      AgentSet.setTurtleVariable(2, (180 - AgentSet.getTurtleVariable(2)));
    }
  });
}
function encounterEarthUv() {
  AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("UVS"), function() {
    return (AgentSet.getTurtleVariable(4) <= Globals.getGlobal(2))
  }), true, function() {
    if (((100 * Globals.getGlobal(7)) > Prims.random(100))) {
      AgentSet.setTurtleVariable(2, (180 - AgentSet.getTurtleVariable(2)));
    }
    else {
      AgentSet.setTurtleVariable(2, 115 + Prims.random(40));
        AgentSet.setTurtleVariable(1, (13 + Prims.random(2)));
        AgentSet.setBreed(world.turtlesOfBreed("HEATS"));
        AgentSet.setTurtleVariable(5, "dot");
    }
  });
};

function watchRay() {
	world.watch(AgentSet.oneOf(world.turtlesOfBreed("SUNRAYS")));
}

function watchUv() {
  world.watch(AgentSet.oneOf(world.turtlesOfBreed("UVS")));
}
Globals.setGlobal(0, 13);
 
      var session     = new SessionLite(document.getElementsByClassName('view-container')[0])
      var runner      = -1;
      var tickCounter = document.getElementById('tick-counter');
      var lastUpdate  = 0;

      // If the HTML was saved in the non-default state, correct it.
      window.addEventListener('load', initPage);

      function updateTickCounter() {
        tickCounter.textContent = typeof world.ticks() === 'number' ? world.ticks() : '';
      }

      function goForever() {
        var speed      = Math.exp(document.getElementById('speed-slider').value);
        var delta      = Math.min(new Date().getTime() - lastUpdate, 30);
        var numUpdates = speed * delta / 1000 + 1;

        var callingRunner = runner;
        for (var i=0; i < numUpdates; i++) {
          go();
          if (callingRunner > -1 && runner == -1){
            return;
          }
          //console.log("in loop",runner, "i", i, "numUpdates",numUpdates);
        }

        updateTickCounter();
        session.update(collectUpdates());

        lastUpdate = new Date().getTime();
        runner     = setTimeout(goForever, 1000 / speed);
        //console.log("end of goForever",runner);
      }

      function doSetup() {
        document.getElementById('messageBox').innerHTML = mParams.graphInput ? "Draw graphs to control the "+mParams.inputName+" and predict the " + mParams.outputName : "Move the slider to control the " + mParams.inputName;
        setup();
        session.update(collectUpdates());
        updateTickCounter();
      }

      function stop() {
        //console.log("stop", runner);
        clearTimeout(runner);
        runner = -1;
        setupLabels();
        showLabels();
        session.update(collectUpdates());
      }

      function toggleGo() {
        var goButton = document.getElementById('go-button');
        if (runner < 0) {
          // check to make sure graphs have been drawn (at least two points in each)
          if (mParams.graphInput && graph.series[0].data.length < 2){
            // warn student
            document.getElementById('messageBox').innerHTML = "Draw a graph to control the " + mParams.inputName;
          } else if (mParams.graphInput && graph2.series[1].data.length < 2){
            // warn student
            document.getElementById('messageBox').innerHTML = "Draw a graph to predict the " + mParams.outputName;
          } else {
            document.getElementById('messageBox').innerHTML = mParams.graphInput ? "" : "Move the slider to control the " + mParams.inputName;
            goForever();
            goButton.value = "Stop";
          }
        } else {
          stop();
          goButton.value = "Go";
        }
      }

      function initPage() {
        tickCounter.textContent = '0';
        document.getElementById('go-button').value = 'Go';
      }

</script>
<script type="text/javascript">
(function() {
  // just for testing
  //debugger;
  //var parent = {node:{}};
  // just for testing

  var recordGraphs = true;
  var studentGraphs = {};
  var history = [
        {"fun": "load", "val":null, timestamp: Date.parse(new Date()), data:{}}
      ];
  var thisNode = parent.node;
  
  if (typeof thisNode !== "undefined" && thisNode != null){
    thisNode.history = history;
    if (recordGraphs) thisNode.studentGraphs = studentGraphs;
    
    /** Called when leaving the table Node step */
    thisNode.finalize = function(callback) {
      var h = {"fun": "exit", "val":null, timestamp:Date.parse(new Date())};
      h.data = getWorldData();
      history.push(h);
      if (parent.al != null && parent.al.stateChanged != null){
        parent.al.stateChanged = true;
      } else if (parent.table != null && parent.table.tableChanged != null){
        parent.table.tableChanged = true;
      } 
      callback();
    };
  }

  /** When new graph data is given use this function to ensure that it is saved to the correct place */
  addToTortoiseGraphLog = function(id, data){
    if (recordGraphs){
      // have we initiated this graph yet
      if (studentGraphs == null){
        studentGraphs = {};
      }
      studentGraphs[id] = cloneDataArray(data);

      // update state
      if (parent.al != null && parent.al.stateChanged != null){
        parent.al.stateChanged = true;
      } else if (parent.table != null && parent.table.tableChanged != null){
         parent.table.tableChanged = true;
      } 
    }
  }

  /** Logs button press and calls appropriate function */
  tortoise_onclick = function (fun, e){
    console.log(e);
    var h = {"fun": fun, "val":e.value, timestamp:Date.parse(new Date())};
    h.data = getWorldData();
    history.push(h);
    // call the function
    if (parent.al != null && parent.al.stateChanged != null){
        parent.al.stateChanged = true;
    } else if (parent.table != null && parent.table.tableChanged != null){
       parent.table.tableChanged = true;
    } 
    if (typeof window[fun] !== "undefined") window[fun](e);
  }

  /** When the student clicks on the graph to make a new point the data is recorded here, point should already be added */
  tortoise_addPoint = function (series, x, y){
     // add an event to history
    var h = {"fun": "new-point", "val":[series.name, x, y], timestamp:Date.parse(new Date())};
    h.data = getWorldData();
    history.push(h);

    series.addPoint([x, y]); // highcharts function
    addToTortoiseGraphLog(series.name, series.data);    
  }
  /** When the student clicks on a point on the graph to delete a point the data is recorded here, point should already be deleted! */
  tortoise_removePoint = function (series, point){
    // add an event to history
    var h = {"fun": "delete-point", "val":[series.name, point.x, point.y], timestamp:Date.parse(new Date())};
    h.data = getWorldData();
    history.push(h);

    point.remove(); // highcharts function
    addToTortoiseGraphLog(series.name, series.data);
  }

  function getWorldData(){
    // must use try-catch to ensure that values have been set
    var t = null
    try {t = world.ticks()} catch (e) {};
    var data = {ticks: t};
    for (var i = 0; i < Globals.vars.length; i++){
      data['Global-'+i] = Globals.vars[i];
    }
    return data;
  }

  function cloneDataArray(obj){
    var copy = [];
    for (var i = 0; i < obj.length; i++){
      copy[i] = [obj[i].x, obj[i].y];
    }
    return copy;
  }

  function cloneHistory(obj) {
    if (obj == null || typeof obj !== "object") return obj;
    var copy = obj.constructor();

    for (var i = 0; i < obj.length; i++){
      var cell = {};
      for (var attr in obj[i]){
        cell[attr] = obj[i][attr];
      }
      copy.push(cell);
    }
    return copy;
  }

})();
</script>
</body></html>